namespace = steppe
namespace = Horde_Collapse
namespace = flavor_chu
namespace = horde_events
namespace = flavor_ggk
namespace = horde_mechanic_events
namespace = timur
namespace = moghul
#Start event
country_event = {
	id = steppe.1
	title = no_localisation
	desc = no_localisation
	picture = ASSASSINATION_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	option = {
		name = EVT_AI
		steppes_group = {
			add_province_triggered_modifier = steppe_trigger1
			add_province_triggered_modifier = steppe_trigger2
			add_province_triggered_modifier = steppe_trigger3
		}
		arabian_steppes_group = {
			add_province_triggered_modifier = steppe_trigger1
			add_province_triggered_modifier = steppe_trigger2
			add_province_triggered_modifier = steppe_trigger3
		}
		saharan_steppes_group = {
			add_province_triggered_modifier = steppe_trigger1
			add_province_triggered_modifier = steppe_trigger2
			add_province_triggered_modifier = steppe_trigger3
		}
	}
}
country_event = {
	id = Horde_Collapse.1 #Tribal Disunity!
	title = "Horde_Collapse.1.t"
	desc = "Horde_Collapse.1.d"
	picture = ASSASSINATION_eventPicture
	
	major = yes
	is_triggered_only = yes
	
	option = {
		name = "Horde_Collapse.1.a"
		if = {
			limit = {
				NOT = { tag = CHG }
			}
			kill_ruler = yes
		}
		if = {
			limit = {
				tag = WHI
				exists = KHI
			}
			KHI = { country_event = { id = timur.36 days = 5 } }
		}
		if = {
			limit = {
				exists = CHU
				CHU = { junior_union_with = ROOT }
			}
			break_union = CHU
			log = "FE-Steppe:[GetYear]:[CHU.GetName]:broke union with [Root.GetName] during tribal disunity:Horde_Collapse.1"
			CHU = {
				free_vassal = ARM
				log = "FE-Steppe:[GetYear]:[This.GetName]:released [ARM.GetName] during tribal disunity:Horde_Collapse.1"
				free_vassal = SYU
				log = "FE-Steppe:[GetYear]:[This.GetName]:released [SYU.GetName] during tribal disunity:Horde_Collapse.1"
				define_ruler = {
					culture = mongolic_turk
					ADM = 1
					DIP = 1
					MIL = 1
					claim = 30
				}
				kill_heir = {}
			}
			ARM = {
				dependency_lost_color_effect = yes
			}
			SYU = {
				dependency_lost_color_effect = yes
			}
		}
		every_subject_country = {
			limit = {
				is_free_or_tributary_trigger = no
			}
			grant_independence = yes
			set_country_flag = country_color_to_be_processed
			if = { 
				limit = { tag = OSS }
				PREV = {
					create_subject = {
						subject_type = close_tributary_state
						who = PREV
					}
				}
			}
			log = "FE-Steppe:[GetYear]:[This.GetName]:broke vassalage with [Root.GetName] during tribal disunity:Horde_Collapse.1"
		}
		every_subject_country = {
			limit = {
				is_subject_of_type = muscovite_tributary_state
				capital_scope = { region = north_caucasus_region}
			}
			grant_independence = yes
			set_country_flag = country_color_to_be_processed
			PREV = {
				create_subject = {
					subject_type = close_tributary_state
					who = PREV
				}
			}
			log = "FE-Steppe:[GetYear]:[This.GetName]:broke vassalage with [Root.GetName] during tribal disunity:Horde_Collapse.1"
		}
		hidden_effect = {
			add_country_modifier = { name = Horde_DisasterCD duration = 8000 }
			add_country_modifier = { name = Horde_PuppetCD duration = 3650 }
			clr_country_flag = Horde_Ruler_Murdered
			set_country_flag = Horde_Collapse_Ongoing
			add_horde_unity = -35
			add_prestige = -20
			define_heir = {
				dynasty = ROOT
				culture = turco_mongol
				age = 20
				ADM = 1
				DIP = 1
				MIL = 1
			}
			# Tank the White Horde's Clan Host
			every_owned_province = {
				add_local_autonomy = 5
				if = {
					limit = {
						NOT = { culture = owner }
					}
					add_nationalism = 15
				}
			}
			if = {
				limit = {
					ai = yes
				}
				Stab_Add1 = yes
			}
		}
		custom_tooltip = Rights_LB
		hidden_effect = {
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-10 }
			every_owned_province = {
				limit = {
					culture = owner
				}
				Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=TR Amount=-10 }
			}
		}
		Stab_Subtract50Percent = yes
		random_list = {
			30 = {}
			50 = {
				Stab_Subtract50Percent = yes
			}
			20 = {
				Stab_Subtract1 = yes
			}
		}
		hidden_effect = {
			every_country = {
				limit = {
					has_country_flag = country_color_to_be_processed
				}
				dependency_lost_color_effect = yes
				clr_country_flag = country_color_to_be_processed
			}
		}
	}
}

country_event = {
	id = Horde_Collapse.2 #Khan Assassinated!
	title = "Horde_Collapse.2.t"
	desc = "Horde_Collapse.2.d"
	picture = ASSASSINATION_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_heir = yes
		heir_age = 15
		OR = {
			AND = {
				NOT = { horde_unity = 30 }
				heir_claim = 75
			}
			AND = {
				NOT = { horde_unity = 50 }
				heir_claim = 50
			}
			AND = {
				NOT = { horde_unity = 75 }
				heir_claim = 25
			}
		}
		NOT = { has_country_modifier = puppet_khanate }
		has_regency = no
		NOT = { Timur_Has = yes }
		is_at_war = no
	}
	
	option = {
		name = "Horde_Collapse.2.a"
		kill_heir = {}
		hidden_effect = {
			add_horde_unity = -25
			log = "FE-Steppe:[GetYear]:[Root.GetName]:had Khan assasinated:Horde_Collapse.2"
		}
		add_prestige = -10
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-5 }
		if = {
			limit = {
				any_owned_province = {
					isValidProv = yes
					development = 7
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					development = 7
				}
				spawn_rebels = {
					type = pretender_rebels
					culture = turco_mongol
					size = 3
					should_take_capital = yes
				}
			}
		}
		else = {
			random_owned_province = {
				limit = {
					isValidProv = yes
				}
				spawn_rebels = {
					type = pretender_rebels
					culture = turco_mongol
					size = 3
					should_take_capital = yes
				}
			}
		}
		random_list = {
			30 = {}
			50 = {
				Stab_Subtract50Percent = yes
			}
			20 = {
				Stab_Subtract1 = yes
			}
		}
	}
}

country_event = {
	id = Horde_Collapse.3 #Puppet Khan
	title = "Horde_Collapse.3.t"
	desc = "Horde_Collapse.3.d"
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_modifier = genghis_khanate
		NOT = { has_country_flag = Horde_Puppet_Rule }
		NOT = { has_country_flag = Horde_Great_Rule }
		NOT = { has_country_modifier = Horde_PuppetCD }
		is_year = 1365
		NOT = { Timur_Has = yes }
	}
	
	option = {
		name = "Horde_Collapse.3.a"
		log = "FE-Steppe:[GetYear]:[Root.GetName]:had Puppet Khan installed:Horde_Collapse.3"
		if = {
			limit = {
				tag = WHI
				NOT = { is_year = 1385 }
			}
			define_ruler = {
				name = "Mamai"
				dynasty = "Kiyat"
				culture = turco_mongol
				ADM = 3
				DIP = 2
				MIL = 5
			}
		}
		else = {
			define_ruler = {
				culture = turco_mongol
				ADM = 3
				DIP = 2
				MIL = 5
			}
		}
		define_ruler_to_general = {
			fire = 4
			shock = 3
			manuever = 3
			siege = 1
		}
		hidden_effect = {
			remove_country_modifier = genghis_khanate
			add_country_modifier = {
				name = puppet_khanate
				duration = -1
			}
			kill_heir = {}
			add_horde_unity = 50
		}
		add_prestige = 10
		Stab_Add1 = yes
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=20 }
		
		hidden_effect = {
			set_country_flag = Horde_Puppet_Rule
		}
	}
}

country_event = {
	id = Horde_Collapse.4 #Dynastic Infighting
	title = "Horde_Collapse.4.t"
	desc = "Horde_Collapse.4.d"
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_regency = yes
			NOT = { horde_unity = 60 }
		}
		has_country_modifier = genghis_khanate
		OR = {
			NOT = { has_country_flag = Horde_Great_Rule }
			NOT = { horde_unity = 30 }
		}
		OR = {
			NOT = { has_country_flag = Horde_Puppet_Rule }
			NOT = { horde_unity = 40 }
		}
		NOT = { Timur_Has = yes }
	}
	
	option = {
		name = "Horde_Collapse.4.a"
		log = "FE-Steppe:[GetYear]:[Root.GetName]:one of cousins had Khan ousted and now is a ruler:Horde_Collapse.4"
		define_ruler = {
			dynasty = ROOT
			culture = turco_mongol
			ADM = 1
			DIP = 2
			MIL = 2
		}
		hidden_effect = {
			add_horde_unity = -50
			kill_heir = {}
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-10 }
		random_list = {
			30 = {}
			50 = {
				Stab_Subtract50Percent = yes
			}
			20 = {
				Stab_Subtract1 = yes
			}
		}
		Public_ChangeConcernTooltipProv = { Concern=Welfare Amount=-5 }
		if = {
			limit = {
				any_owned_province = {
					isValidProv = yes
					development = 7
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					development = 7
				}
				spawn_rebels = {
					type = pretender_rebels
					culture = turco_mongol
					size = 3
					should_take_capital = yes
				}
			}
		}
		else = {
			random_owned_province = {
				limit = {
					isValidProv = yes
				}
				spawn_rebels = {
					type = pretender_rebels
					culture = turco_mongol
					size = 3
					should_take_capital = yes
				}
			}
		}
	}
}

country_event = {
	id = Horde_Collapse.5 #Tribes Pacified
	title = "Horde_Collapse.5.t"
	desc = "Horde_Collapse.5.d"
	picture = GOOD_WITH_MONARCH_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			NOT = { has_country_modifier = Horde_DisasterCD }
			has_country_flag = Horde_Puppet_Rule
			has_country_flag = Horde_Great_Rule
			is_subject_of = TIM
		}
		has_country_flag = Horde_Collapse_Ongoing
		NOT = { Timur_Has = yes }
	}
	
	option = {
		name = "Horde_Collapse.5.a"
		log = "FE-Steppe:[GetYear]:[Root.GetName]:pacified its tribes:Horde_Collapse.5"
		hidden_effect = {
			clr_country_flag = Horde_Collapse_Ongoing
		}
		capital_scope = {
			add_local_autonomy = -50
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=10 }
		Stab_Add1 = yes
	}
}

country_event = {
	id = Horde_Collapse.6 #Tribal Unification
	title = "Horde_Collapse.6.t"
	desc = "Horde_Collapse.6.d"
	picture = GOOD_WITH_MONARCH_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "Horde_Collapse.6.a"
		log = "FE-Steppe:[GetYear]:[Root.GetName]:unified its tribes:Horde_Collapse.6"
		add_horde_unity = 10
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=20 }
		Stab_Add3 = yes
		if = {
			limit = {
				has_country_flag = Horde_Collapse_Ongoing
			}
			hidden_effect = {
				clr_country_flag = Horde_Collapse_Ongoing
			}
			capital_scope = {
				add_local_autonomy = -50
			}
		}
		hidden_effect = {
			clr_country_flag = Horde_Puppet_Rule
			clr_country_flag = Horde_Great_Rule
			set_country_flag = Horde_Unifier
		}
	}
}

country_event = {
	id = Horde_Collapse.7
	title = "EVT_AI"
	desc = "EVT_AI"
	picture = GOOD_WITH_MONARCH_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	option = {
		name = "EVT_AI"
		if = {
			limit = {
				NOT = { has_country_flag = Horde_Collapse_Ongoing }
			}
			if = {
				limit = {
					NOT = { has_country_flag = Horde_Timur }
				}
				country_event = { id = Horde_Collapse.6 }
			}
		}
		else = {
			add_disaster_progress = {
				disaster = Horde_Collapse
				value = 100
			}
		}
	}
}


country_event = { # debug event
	id = Horde_Collapse.8
	title = "EVT_DEBUG"
	desc = "EVT_DEBUG"
	picture = GOOD_WITH_MONARCH_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	option = {
		name = "EVT_DEBUG"
		if = { limit = { NOT = { has_country_flag = Horde_Collapse_Ongoing } }
			country_event = { id = Horde_Collapse.1 }
		}
	}
}

country_event = {
	id = Horde_Collapse.9 #Pretender Rises
	title = "Horde_Collapse.9.t"
	desc = "Horde_Collapse.9.d"
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_country_flag = Horde_Great_Rule }
		NOT = { has_country_flag = Horde_Puppet_Rule }
		NOT = { Timur_Has = yes }
		is_at_war = no
	}
	
	option = {
		name = "Horde_Collapse.9.a"
		log = "FE-Steppe:[GetYear]:[Root.GetName]:pretender rose to take over:Horde_Collapse.9"
		Public_ChangeConcernTooltipProv = { Concern=Welfare Amount=-2 }
		if = {
			limit = {
				any_owned_province = {
					isValidProv = yes
					development = 7
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					development = 7
				}
				spawn_rebels = {
					type = pretender_rebels
					culture = turco_mongol
					size = 2
					should_take_capital = yes
				}
				Public_ChangeConcernTooltip = { Concern=Welfare Amount=-5 }
				Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=TR Amount=-5 }
			}
		}
		else = {
			random_owned_province = {
				limit = {
					isValidProv = yes
				}
				spawn_rebels = {
					type = pretender_rebels
					culture = turco_mongol
					size = 2
					should_take_capital = yes
				}
				Public_ChangeConcernTooltip = { Concern=Welfare Amount=-5 }
				Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=TR Amount=-5 }
			}
		}
		add_horde_unity = -4
		add_prestige = -8
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-2.5 }
	}
}

country_event = {
	id = Horde_Collapse.10 #Legacy of the Warlord
	title = "Horde_Collapse.10.t"
	desc = "Horde_Collapse.10.d"
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = Horde_Puppet_Rule
		has_disaster = Horde_Collapse
		NOT = { Timur_Has = yes }
	}

	option = {
		name = "Horde_Collapse.10.a"
		log = "FE-Steppe:[GetYear]:[Root.GetName]:end of puppet Khanate, pretender rose:Horde_Collapse.10"
		hidden_effect = {
			remove_country_modifier = puppet_khanate
			add_country_modifier = {
				name = genghis_khanate
				duration = -1
			}
		}
		add_horde_unity = -30
		Public_ChangeConcernTooltipProv = { Concern=Welfare Amount=-2 }
		if = {
			limit = {
				any_owned_province = {
					isValidProv = yes
					development = 7
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					development = 7
				}
				spawn_rebels = {
					type = pretender_rebels
					culture = turco_mongol
					size = 3
					should_take_capital = yes
				}
				Public_ChangeConcernTooltip = { Concern=Welfare Amount=-5 }
			}
		}
		else = {
			random_owned_province = {
				limit = {
					isValidProv = yes
				}
				spawn_rebels = {
					type = pretender_rebels
					culture = turco_mongol
					size = 3
					should_take_capital = yes
				}
				Public_ChangeConcernTooltip = { Concern=Welfare Amount=-5 }
			}
		}
		hidden_effect = {
			clr_country_flag = Horde_Puppet_Rule
			if = {
				limit = {
					NOT = { has_country_flag = Horde_Unifier }
				}
				set_country_flag = Horde_Collapse_Ongoing
			}
		}
	}
}

country_event = {
	id = Horde_Collapse.11 #United Horde
	title = "Horde_Collapse.11.t"
	desc = "Horde_Collapse.11.d"
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = Horde_Unifier
		horde_unity = 75
		NOT = { Timur_Has = yes }
		is_lesser_in_union = no
	}
	
	option = {
		name = "Horde_Collapse.11.a"
		add_horde_unity = 50
		Stab_Add1 = yes
		log = "FE-Steppe:[GetYear]:[Root.GetName]:death of the Khan who unified the Horde, horde unity was strong enough to prevent the shattering:Horde_Collapse.11"

		hidden_effect = {
			#clr_country_flag = Horde_Unifier
			#clr_country_flag = Horde_Puppet_Rule
		}
	}
}

country_event = {
	id = Horde_Collapse.12 #Shattered Horde
	title = "Horde_Collapse.12.t"
	desc = "Horde_Collapse.12.d"
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = Horde_Unifier
		NOT = { horde_unity = 75 }
		NOT = { Timur_Has = yes }
		is_lesser_in_union = no
	}
	
	option = {
		name = "Horde_Collapse.12.a"
		log = "FE-Steppe:[GetYear]:[Root.GetName]:Horde shattered on death of the unifier:Horde_Collapse.12"
		add_horde_unity = -50
		if = {
			limit = {
				ai = yes
			}
			add_country_modifier = {
				name = horde_collapse
				duration = 18250
			}
		}
		Stab_Subtract1 = yes
		Public_ChangeConcernTooltipProv = { Concern=Welfare Amount=-5 }
		if = {
			limit = {
				any_owned_province = {
					isValidProv = yes
					development = 7
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					development = 7
				}
				spawn_rebels = {
					type = pretender_rebels
					culture = turco_mongol
					size = 3
					should_take_capital = yes
				}
				Public_ChangeConcernTooltip = { Concern=Welfare Amount=-5 }
			}
		}
		else = {
			random_owned_province = {
				limit = {
					isValidProv = yes
				}
				spawn_rebels = {
					type = pretender_rebels
					culture = turco_mongol
					size = 3
					should_take_capital = yes
				}
				Public_ChangeConcernTooltip = { Concern=Welfare Amount=-5 }
			}
		}
		if = {
			limit = {
				ai = yes
			}
			if = {
				limit = {
					any_owned_province = {
						isValidProv = yes
						development = 7
					}
				}
				random_owned_province = {
					limit = {
						isValidProv = yes
						development = 7
					}
					spawn_rebels = {
						type = pretender_rebels
						culture = turco_mongol
						size = 2
						should_take_capital = yes
					}
					Public_ChangeConcernTooltip = { Concern=Welfare Amount=-5 }
				}
			}
			else = {
				random_owned_province = {
					limit = {
						isValidProv = yes
					}
					spawn_rebels = {
						type = pretender_rebels
						culture = turco_mongol
						size = 2
						should_take_capital = yes
					}
					Public_ChangeConcernTooltip = { Concern=Welfare Amount=-5 }
				}
			}
		}
		
		hidden_effect = {
			clr_country_flag = Horde_Unifier
			clr_country_flag = Horde_Puppet_Rule
		}
	}
}

country_event = {
	id = Horde_Collapse.13 #Great Khan
	title = "Horde_Collapse.13.t"
	desc = "Horde_Collapse.13.d"
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		check_key = { lhs = Ruler_SkillScaled value = 16 }
		has_country_flag = Horde_Collapse_Ongoing
		NOT = { has_country_flag = Horde_Great_Rule }
		NOT = { Timur_Has = yes }
	}
	
	option = {
		name = "Horde_Collapse.13.a"
		log = "FE-Steppe:[GetYear]:[Root.GetName]:Great Khan rule ended the collapse:Horde_Collapse.13"
		add_horde_unity = 65
		hidden_effect = {
			kill_heir = {}
		}
		add_prestige = 10
		Stab_Add1 = yes
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=25 }
		
		hidden_effect = {
			clr_country_flag = Horde_Collapse_Ongoing
			set_country_flag = Horde_Great_Rule
		}
	}
}

country_event = {
	id = Horde_Collapse.14 #Legacy of the Khan
	title = "Horde_Collapse.14.t"
	desc = "Horde_Collapse.14.d"
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = Horde_Great_Rule
		has_disaster = Horde_Collapse
		NOT = { Timur_Has = yes }
	}
	
	option = {
		name = "Horde_Collapse.14.a"
		log = "FE-Steppe:[GetYear]:[Root.GetName]:Great Khan died, pretender rose:Horde_Collapse.14"
		add_horde_unity = -30
		ChangeTagEffect = { scope=GHO }
		log = "FE-Steppe:[GetYear]:[Root.GetName]:changed into [GHO.GetTag]:Horde_Collapse.14"
		Public_ChangeConcernTooltipProv = { Concern=Welfare Amount=-2 }
		random_owned_province = {
			limit = {
				isValidProv = yes
				development = 7
			}
			spawn_rebels = {
				type = pretender_rebels
				culture = turco_mongol
				size = 3
				should_take_capital = yes
			}
			Public_ChangeConcernTooltip = { Concern=Welfare Amount=-5 }
		}
		
		hidden_effect = {
			clr_country_flag = Horde_Great_Rule
			set_country_flag = Horde_Collapse_Ongoing
		}
	}
}

country_event = {
	id = horde_events.20 #Untimely Death of Jani Beg Jochid
	title = horde_events.20.t
	desc = horde_events.20.d
	picture = KING_SICK_IN_BED_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = WHI
		has_ruler = "Jani Beg"
		NOT = { is_year = 1360 }
		has_any_disaster = no
		#NOT = { war_with = CHU } # Makes the event description make sense
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	option = {
		name = "OPT.OHNO"
		kill_ruler = yes
		log = "FE-Steppe:[GetYear]:[Root.GetName]:Jani Beg died:horde_events.20"
		add_horde_unity = -50
		hidden_effect = {
			set_country_flag = Horde_Ruler_Murdered
			define_heir = {
				name = "Qulpa"
				dynasty = ROOT
				culture = turco_mongol
				age = 18
				ADM = 1
				DIP = 1
				MIL = 1
			}
			add_horde_unity = -5
			add_prestige = -10
		}
		random_list = {
			30 = {}
			50 = {
				Stab_Subtract50Percent = yes
			}
			20 = {
				Stab_Subtract1 = yes
			}
		}
		hidden_effect = {
			CHU = { #Chupanids
				# Stablisation of the state
				Stab_Add2 = yes
				log = "FE-Steppe:[GetYear]:[This.GetName]:country stabilised when Jani Beg of [Root.GetName] died:horde_events.20"
				Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=30 }
				Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=30 }
				Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=BG Amount=20 }
				Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=CL Amount=20 }
			}
		}
	}
}

########################
# General Horde Events #
########################

country_event = { #We have countries under PU for less than 5 years before our monarch died, and we have to fight for those claims or give up
	id = horde_events.100
	title = horde_events.100.t
	desc = horde_events.100.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { Timur_Has = yes }
		steppe_trigger = yes
		OR = {
			personal_union = 1
			personal_union_limited = 1
		}
		any_subject_country = {
			isValidCountry = yes
			junior_union_with = ROOT
			steppe_trigger = yes
			NOT = { has_country_flag = Horde_Collapse_Ongoing }
			NOT = {
				years_in_union_under = {
					who = ROOT
					years = 5
				}
			}
		}
	}
	
	option = { #Let them be free
		name = horde_events.100.a
		every_subject_country = {
			limit = {
				isValidCountry = yes
				junior_union_with = ROOT
				steppe_trigger = yes
				NOT = {
					years_in_union_under = {
						who = ROOT
						years = 5
					}
				}
			}
			log = "FE-Steppe:[GetYear]:[This.GetName]:broke union with [Root.GetName] on their ruler death:horde_events.100"
			break_union = ROOT
		}
		hidden_effect = {
			CHU = {
				if = {
					limit = {
						isValidCountry = yes
						has_country_flag = under_WHI_PU
						NOT = { is_lesser_in_union = yes }
					}
					country_event = {
						id = flavor_chu.4
					}
					clr_country_flag = under_WHI_PU
				}
			}
		}
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0
				OR = {
					tag = JAI #Jalayrids
					tag = MUZ #Fars
				}
			}
		}
	}
	
	option = { #Fight for what's ours
		name = horde_events.100.b
		custom_tooltip = horde_PU_war
		hidden_effect = {
			every_subject_country = {
				limit = {
					isValidCountry = yes
					junior_union_with = ROOT
					steppe_trigger = yes
					NOT = {
						years_in_union_under = {
							who = ROOT
							years = 5
						}
					}
				}
				break_union = ROOT
				log = "FE-Steppe:[GetYear]:[This.GetName]:broke union with [Root.GetName] on their ruler death:horde_events.100"
				log = "FE-Steppe:[GetYear]:[Root.GetName]:declared war to restore control over [This.GetName]:horde_events.100"
				ROOT = {
					declare_war_with_cb = {
						who = PREV
						casus_belli = cb_nomadic_submission
					}
				}
			}
		}
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				OR = {
					tag = WHI
					has_disaster = Horde_Collapse
				}
			}
			modifier = {
				factor = 0
				tag = MGH
				is_year = 1365
			}
		}
	}
}

country_event = {
	id = horde_events.22
	title = horde_events.22.t
	desc = horde_events.22.d
	picture = BORDER_TENSION_eventPicture
	
	trigger = {
		is_at_war = yes
		is_nomad = yes
		NOT = { has_country_flag = steppe_declined_tributary }
		is_in_war = {
			war_score = 25
			attacker_leader = ROOT
			casus_belli = cb_tribal_raid
		}
		any_known_country = {
			is_in_war = {
				defender_leader = THIS
				casus_belli = cb_tribal_raid
			}
			NOT = {  is_nomad = yes }
			NOT = { tag = ROOT }
		}
	}
	
	mean_time_to_happen = {
		years = 2
		modifier = {
			factor = 0.8
			is_in_war = {
				war_score = 30
				attacker_leader = ROOT
				casus_belli = cb_tribal_raid
			}
		}
		modifier = {
			factor = 0.8
			is_in_war = {
				war_score = 40
				attacker_leader = ROOT
				casus_belli = cb_tribal_raid
			}
		}
		modifier = {
			factor = 0.8
			is_in_war = {
				war_score = 50
				attacker_leader = ROOT
				casus_belli = cb_tribal_raid
			}
		}
	}
	
	option = { ## propose them to become a tributary
		name = "horde_events.22.a"
		ai_chance = {
			factor = 5
		}
		every_country = {
			limit = {
				is_in_war = {
					attacker_leader = ROOT
					defender_leader = THIS
					casus_belli = cb_tribal_raid
				}
				NOT = { tag = ROOT }
			}
			country_event = { id = horde_events.23 days = 5 }
		}
	}
	option = { ## continue the war
		name = "horde_events.22.b"
		ai_chance = {
			factor = 1
		}
		add_war_exhaustion = 1
		add_prestige = 10
	}
}

country_event = {
	id = horde_events.23
	title = horde_events.23.t
	desc = horde_events.23.d
	picture = BORDER_TENSION_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	option = { ## accept to become a tributary
		name = "horde_events.23.a"
		ai_chance = {
			factor = 5
			modifier = {
				factor = 5
				military_strength = {
					who = FROM
					value = 0.5
				}
			}
		}
		add_treasury = -25
		white_peace = FROM
		add_truce_with = FROM
		FROM = {
			create_subject = {
				subject_type = tributary_state
				who = ROOT
			}
			log = "FE-Steppe:[GetYear]:[This.GetName]:accepted the demand of [Root.GetName] to become tributary:horde_events.23"
			country_event = { id = horde_events.24 days = 1 }
		}
	}
	option = { ## decline and continue the war
		name = "horde_events.23.b"
		ai_chance = {
			factor = 1
		}
		log = "FE-Steppe:[GetYear]:[This.GetName]:rejected the demand of [Root.GetName] to become tributary:horde_events.23"
		add_war_exhaustion = 2.5
		add_prestige = 10
		country_event = { id = horde_events.25 days = 1 }
	}
}

## accepted notification to become a tributary
country_event = {
	id = horde_events.24
	title = horde_events.24.t
	desc = horde_events.24.d
	picture = BORDER_TENSION_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = horde_events.24.a
		add_prestige = 2.5
		add_treasury = 25
		add_truce_with = FROM
	}
}

## declined notification to become a tributary
country_event = {
	id = horde_events.25
	title = horde_events.25.t
	desc = horde_events.25.d
	picture = BORDER_TENSION_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = horde_events.25.a
		add_prestige = -1
		set_country_flag = steppe_declined_tributary
	}
}


country_event = {
	id = flavor_chu.1
	title = flavor_chu.1.t
	desc = flavor_chu.1.d
	picture = PALAIS_MAZARIN_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	trigger = {
		senior_union_with = CHU
	}
	
	option = {
		name = EVT_AI
		if = {
			limit = {
				CHU = {
					is_at_war = yes
				}
			}
			every_country = {
				limit = {
					isValidCountry = yes
					offensive_war_with = CHU
				}
				country_event = {
					id = flavor_chu.2
					days = 1
				}
			}
		}
		if = {
			limit = {
				CHU = {
					is_at_war = no
				}
			}
			country_event = {
				id = flavor_chu.3
			}
		}
	}
}

country_event = {
	id = flavor_chu.2
	title = flavor_chu.2.t
	desc = flavor_chu.2.d
	picture = BATTLE_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_country_flag = peace_with_CHU }
		offensive_war_with = CHU
		CHU = {
			is_subject_other_than_tributary_trigger = yes
		}
		OR = {
			tag = JAI
			tag = MUZ
			tag = WHI
			tag = ISF
		}
	}
	
	option = {
		name = flavor_chu.2.a
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				OR = { # These tags desire a restoration of union
					tag = ERE
					tag = JAI
					tag = WHI
				}
			}
		}
		if = {
			limit = {
				OR = {
					tag = MUZ
					tag = ISF
				}
			}
			2225 = {
				if = {
					limit = {
						owned_by = CHU
					}
					cede_province = ROOT
					add_core = ROOT
					add_claim = FROM
				}
			}
			1313 = {
				if = {
					limit = {
						owned_by = CHU
					}
					if = {
						limit = {
							controlled_by = ROOT
						}
						cede_province = ROOT
						add_core = ROOT
						add_core = FROM
						3079 = {
							if = {
								limit = {
									owned_by = CHU
								}
								cede_province = ROOT
								add_core = ROOT
								add_core = FROM
							}
						}
					}
					else = {
						cede_province = SDB
						add_claim = SDB
						add_core = FROM
					}
				}
			}
		}
		white_peace = CHU
		CHU = {
			overlord = {
				country_event = {
					id = flavor_chu.3
				}
			}
		}
		white_peace = FROM
	}
	
	option = {
		name = flavor_chu.2.b
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0
				OR = {
					tag = MUZ
					tag = ISF
				}
			}
		}
	}
	
	after = {
		set_country_flag = peace_with_CHU
	}
}

country_event = {
	id = flavor_chu.3
	title = flavor_chu.3.t
	desc = flavor_chu.3.d
	picture = CONQUEST_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		senior_union_with = CHU
		NOT = { tag = WHI }
		CHU = {
			is_at_war = no
		}
	}
	
	option = {
		name = flavor_chu.3.a
		if = {
			limit = {
				tag = JAI
			}
			every_province = {
				limit = {
					isValidProv = yes
					owned_by = CHU
				}
				add_claim = MUZ
				if = {
					limit = {
						exists = ISF
					}
					add_claim = ISF
				}
			}
		}
		if = {
			limit = {
				tag = MUZ
			}
			every_province = {
				limit = {
					isValidProv = yes
					owned_by = CHU
				}
				add_claim = JAI
				if = {
					limit = {
						exists = ISF
					}
					add_claim = ISF
				}
			}
		}
		if = {
			limit = {
				tag = ISF
			}
			every_province = {
				limit = {
					isValidProv = yes
					owned_by = CHU
				}
				add_claim = JAI
				add_claim = MUZ
			}
		}
		inherit = CHU
		hidden_effect = { chupanid_disolve_effect = yes }
		hidden_effect = {
			every_province = {
				limit = {
					isValidProv = yes
					is_core = CHU
				}
				remove_core = CHU
			}
		}
	}
}

country_event = {
	id = flavor_chu.4
	title = flavor_chu.4.t
	desc = flavor_chu.4.d
	picture = CONQUEST_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = {
		name = OPT.BASTARD
		define_ruler = {
			name = "Akhi"
			dynasty = "Juq"
			ADM = 1
			DIP = 1
			MIL = 3
		}
		hidden_effect = {
			if = {
				limit = {
					overlord_of = ARM
				}
				ARM = {
					log = "FE-Steppe:[GetYear]:[Root.GetName]:released [This.GetName]:flavor_chu.4"
					add_liberty_desire = 200
					grant_independence_effect = yes
				}
			}
			if = {
				limit = {
					overlord_of = SYU
				}
				SYU = {
					log = "FE-Steppe:[GetYear]:[Root.GetName]:released [This.GetName]:flavor_chu.4"
					add_liberty_desire = 200
					grant_independence_effect = yes
				}
			}
			JAI = {
				country_event = {
					id = flavor_chu.5
					days = 10
				}
			}
			MUZ = {
				country_event = {
					id = flavor_chu.5
					days = 10
				}
			}
			if = {
				limit = {
					exists = ISF
					ISF = {
						is_at_war = no
					}
				}
				ISF = {
					country_event = {
						id = flavor_chu.5
						days = 10
					}
				}
			}
			kill_heir = {}
			define_ruler_to_general = {
				fire = 2
				shock = 2
				manuever = 2
				siege = 1
			}
		}
	}
}

country_event = {
	id = flavor_chu.5
	title = flavor_chu.5.t
	desc = flavor_chu.5.d
	picture = CONQUEST_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = flavor_chu.5.a
		log = "FE-Steppe:[GetYear]:[Root.GetName]:declared war on [CHU.GetName] (Restore PU CB):flavor_chu.5"
		hidden_effect = { #to be safe that CB exists
			add_casus_belli = {
				target = CHU
				type = cb_restore_personal_union
				months = 24
			}
		}
		declare_war_with_cb = {
			who = CHU
			casus_belli = cb_restore_personal_union
		}
		416 = {
			add_claim = ROOT
		}
		add_prestige = 30
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				is_at_war = yes
			}
		}
	}
	option = {
		name = flavor_chu.5.b
		log = "FE-Steppe:[GetYear]:[Root.GetName]:backed out from declaring war on [CHU.GetName] (Restore PU CB):flavor_chu.5"
		ai_chance = {
			factor = 1
			modifier = {
				factor = 100
				is_at_war = yes
			}
		}
	}
}

country_event = {
	id = flavor_chu.6
	title = flavor_chu.6.t
	desc = flavour.chu.6.d
	picture = CONQUEST_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	hidden = yes
	
	trigger = {
		tag = WHI
		CHU = {
			has_country_flag = under_WHI_PU
			NOT = { is_lesser_in_union = yes }
		}
	}
	
	option = {
		name = EVT_AI
		CHU = {
			clr_country_flag = under_WHI_PU
			country_event = {
				id = flavor_chu.4
			}
		}
	}
}

country_event = {
	id = flavor_chu.7
	title = flavor_chu.7.t
	desc = flavour.chu.7.d
	picture = CONQUEST_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	hidden = yes
	
	trigger = {
		tag = CHU
		NOT = { has_country_flag = under_WHI_PU }
		junior_union_with = WHI
	}
	
	option = {
		name = EVT_AI
		set_country_flag = under_WHI_PU
	}
}
########################################
# Events for the Revolts against the Mongols
#
# written by Gilles Gaudray
########################################

# Goal : model the massive revolts and breakouts the Mongol nations suffered in Central Asia

# 931021 - Crimea events
country_event = {
	id = flavor_ggk.21
	title = "flavor_ggk.21.t"				# Rise of the Crimea
	desc = "flavor_ggk.21.d"				# In the midst or our dire situation, our traitrous Crimean subjects have risen against us in a bid to gain their independence.
	picture = GENGIS_KHAN_eventPicture
	
	trigger = {
		#NOT = { has_global_flag = 1530_start_date }
		OR = {
			culture_group = altaic
			culture_group = tartar_group
			culture_group = old_turkic
		}
		NOT = { tag = CRI }
		OR = {
			is_bankrupt = yes
			AND = {
				is_at_war = yes
				NOT = { war_score = -20 }
			}
			NOT = { legitimacy_equivalent = 30 }
			NOT = { stability = 0 }
		}
		num_of_owned_provinces_with = {
			value = 2
			region = crimea_region
			check_key = { lhs = NM_Ratio value = 10 }
		}
		NOT = { has_country_flag = Horde_Collapse_Ongoing }
		NOT = { has_country_flag = Horde_Ruler_Murdered }
		NOT = { war_with = TIM }
		NOT = { war_with = GGK }
		Not_Have_Timur = yes
		is_year = 1390
	}
	
	mean_time_to_happen = {
		years = 20
		
		modifier = {
			factor = 0.5
			OR = {
				tag = GOL
				tag = WHI
				tag = BLU
				tag = TIM
				tag = YUA
				tag = GGK
				tag = CHU
				is_nomad = no
			}
		}
		modifier = {
			factor = 0.1
			has_any_disaster = yes
		}
		modifier = {
			factor = 0.5
			exists = RUS
			NOT = { tag = RUS }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -30 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -40 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -50 }
		}
		modifier = {
			factor = 0.1
			NOT = { legitimacy_equivalent = 10 }
		}
		modifier = {
			factor = 3
			is_lesser_in_union = yes
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { exists = CRI }
			}
			CRI = { clr_country_flag = POP_Init }
		}
		crimea_region = {
			limit = {
				isValidProv = yes
			}
			add_core = CRI
			if = {
				limit = {
					culture = tartar
				}
				change_culture = crimean
			}
		}
		moldavia_area = {
			if = {
				limit = {
					isValidProv = yes
					culture = vlach
				}
				add_core = MOL
			}
		}
		north_moldavia_area = {
			if = {
				limit = {
					isValidProv = yes
					culture = vlach
				}
				add_core = MOL
			}
		}
		basarabia_area = {
			if = {
				limit = {
					isValidProv = yes
				}
				add_claim = MOL
			}
		}
	}
	
	option = {
		name = "OPT.BASTARD"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				is_at_war = yes
			}
			modifier = {
				factor = 2
				NOT = { is_nomad = yes }
			}
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[CRI.GetName] broke free, war started:flavor_ggk.21"
		crimea_region = {
			limit = {
				owned_by = PREV
				isValidProv = yes
				is_capital = no
			}
			cede_province = CRI
		}
		every_owned_province = {
			limit = {
				OR = {
					area = moldavia_area
					#area = north_moldavia_area
					area = basarabia_area
				}
				is_capital = no
			}
			cede_province = MOL
		}
		if = {
			limit = {
				CRI = { is_subject = no }
				is_free_or_tributary_trigger = yes
			}
			create_subject = {
				who = CRI
				subject_type = custom_vassal
			}
		}
		CRI = {
			add_casus_belli = {
				target = ROOT
				type = cb_independence_war
				months = 12
			}
			declare_war_with_cb = { 
				who = ROOT 
				casus_belli = cb_independence_war 
			}
		}
		MOL = {
			country_event = {
            	id = fe_MOL.1
            }
		}
	}
	
	option = {
		name = "OPT.VERYWELL"
		ai_chance = {
			factor = 50
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[CRI.GetName] broke free, no war:flavor_ggk.21"
		crimea_region = {
			limit = {
				owned_by = PREV
				isValidProv = yes
				is_capital = no
			}
			cede_province = CRI
		}
		every_owned_province = {
			limit = {
				OR = {
					area = moldavia_area
					#area = north_moldavia_area
					area = basarabia_area
				}
				is_capital = no
			}
			cede_province = MOL
		}
		MOL = {
			country_event = {
            	id = fe_MOL.1
            }
		}
		if = {
			limit = {
				is_nomad = yes
			}
			add_horde_unity = -10
		}
	}
	after = {
		CRI = {
			hidden_effect = {
				if = {
					limit = {
						owns = 282
					}
					Effect_set_capital = { target=282 }
				}
				if = {
					limit = {
						ai = no
					}
					add_country_modifier = { name = blessing_of_god duration = 1825 }
				}
				if = {
					limit = {
						NOT = { has_country_flag = POP_Init }
					}
					steppe_effect = yes
					country_event = { id = Init.1 }
				}
			}
		}
	}
}


# 931031 - Astrakhan events
country_event = {
	id = flavor_ggk.31
	title = "flavor_ggk.31.t"				# Rise of the Astrakhan
	desc = "flavor_ggk.31.d"				# In the midst or our dire situation, our traitrous Astrakhanian subjects have risen against us in a bid to gain their independence.
	picture = GENGIS_KHAN_eventPicture
	
	trigger = {
		#NOT = { has_global_flag = 1530_start_date }
		OR = {
			culture_group = altaic
			culture_group = tartar_group
			culture_group = old_turkic
		}
		NOT = { tag = AST }
		OR = {
			is_bankrupt = yes
			AND = {
				is_at_war = yes
				NOT = { war_score = -20 }
			}
			NOT = { legitimacy_equivalent = 30 }
			NOT = { stability = 0 }
		}
		num_of_owned_provinces_with = {
			value = 2
			OR = {
				province_id = 1309
				province_id = 1310
				province_id = 1293
			}
			check_key = { lhs = NM_Ratio value = 10 }
		}
		NOT = { has_country_flag = Horde_Collapse_Ongoing }
		NOT = { has_country_flag = Horde_Ruler_Murdered }
		NOT = { war_with = TIM }
		NOT = { war_with = GGK }
		Not_Have_Timur = yes
		is_year = 1390
	}
	
	mean_time_to_happen = {
		years = 20
		
		modifier = {
			factor = 0.5
			OR = {
				tag = GOL
				tag = WHI
				tag = BLU
				tag = TIM
				tag = YUA
				tag = GGK
				tag = CHU
				is_nomad = no
			}
		}	
		modifier = {
			factor = 0.1
			has_any_disaster = yes
		}
		modifier = {
			factor = 0.5
			exists = RUS
			NOT = { tag = RUS }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -30 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -40 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -50 }
		}
		modifier = {
			factor = 0.1
			NOT = { legitimacy_equivalent = 10 }
		}
		modifier = {
			factor = 3
			is_lesser_in_union = yes
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { exists = AST }
			}
			AST = { clr_country_flag = POP_Init }
		}
		1309 = {
			add_core = AST
			if = {
				limit = {
					OR = {
						culture = tartar
						culture = nogai
					}
				}
				change_culture = astrakhani
			}
		}
		1293 = {
			add_core = AST
			if = {
				limit = {
					OR = {
						culture = tartar
						culture = nogai
					}
				}
				change_culture = astrakhani
			}
		}
		1310 = {
			add_core = AST
			if = {
				limit = {
					OR = {
						culture = tartar
						culture = nogai
					}
				}
				change_culture = astrakhani
			}
		}
	}
	
	option = {
		name = "OPT.BASTARD"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				is_at_war = yes
			}
			modifier = {
				factor = 2
				NOT = { is_nomad = yes }
			}
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[AST.GetName] broke free, war started:flavor_ggk.31"
		every_owned_province = {
			limit = {
				OR = {
					province_id = 1309
					province_id = 1310
					province_id = 1293
				}
				owned_by = PREV
				is_capital = no
			}
			cede_province = AST
		}
		if = {
			limit = {
				AST = { is_subject = no }
				is_free_or_tributary_trigger = yes
			}
			create_subject = {
				who = AST
				subject_type = custom_vassal
			}
		}
		AST = {
			add_casus_belli = {
				target = ROOT
				type = cb_independence_war
				months = 12
			}
			declare_war_with_cb = { who = ROOT casus_belli = cb_independence_war }
		}
	}
	
	option = {
		name = "OPT.VERYWELL"
		ai_chance = {
			factor = 50
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[AST.GetName] broke free, no war:flavor_ggk.31"
		1309 = {
			if = {
				limit = {
					owned_by = PREV
					isValidProv = yes
					is_capital = no
				}
				cede_province = AST
			}
		}
		every_owned_province = {
			limit = {
				OR = {
					province_id = 1309
					province_id = 1310
					province_id = 1293
				}
				owned_by = PREV
				isValidProv = yes
				is_capital = no
			}
			cede_province = AST
		}
		if = {
			limit = {
				is_nomad = yes
			}
			add_horde_unity = -10
		}
	}
	after = {
		AST = {
			hidden_effect = {
				if = {
					limit = {
						owns = 1293
					}
					Effect_set_capital = { target=1293 }
				}
				else_if = {
					limit = {
						owns = 1310
					}
					Effect_set_capital = { target=1310 }
				}
				if = {
					limit = {
						ai = no
					}
					add_country_modifier = { name = blessing_of_god duration = 1825 }
				}
				if = {
					limit = {
						NOT = { has_country_flag = POP_Init }
					}
					steppe_effect = yes
					country_event = { id = Init.1 }
				}
			}
		}
	}
}


# 931041 - Nogai events
country_event = {
	id = flavor_ggk.41
	title = "flavor_ggk.41.t"				# Rise of the Nogai
	desc = "flavor_ggk.41.d"				# In the midst or our dire situation, our traitrous Nogai subjects have risen against us in a bid to gain their independence.
	picture = GENGIS_KHAN_eventPicture
	
	trigger = {
		#NOT = { has_global_flag = 1530_start_date }
		OR = {
			culture_group = altaic
			culture_group = tartar_group
			culture_group = old_turkic
		}
		NOT = { tag = NOG }
		OR = {
			is_bankrupt = yes
			AND = {
				is_at_war = yes
				NOT = { war_score = -20 }
			}
			NOT = { legitimacy_equivalent = 30 }
			NOT = { stability = 0 }
		}
		num_of_owned_provinces_with = {
			value = 2
			area = nogai_area
			check_key = { lhs = NM_Ratio value = 10 }
		}
		NOT = { has_country_flag = Horde_Collapse_Ongoing }
		NOT = { has_country_flag = Horde_Ruler_Murdered }
		NOT = { war_with = TIM }
		NOT = { war_with = GGK }
		Not_Have_Timur = yes
		is_year = 1390
	}
	
	mean_time_to_happen = {
		years = 20
		
		modifier = {
			factor = 0.5
			OR = {
				tag = GOL
				tag = WHI
				tag = BLU
				tag = TIM
				tag = YUA
				tag = GGK
				tag = CHU
				is_nomad = no
			}
		}
		modifier = {
			factor = 0.1
			has_any_disaster = yes
		}
		modifier = {
			factor = 0.5
			exists = RUS
			NOT = { tag = RUS }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -30 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -40 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -50 }
		}
		modifier = {
			factor = 0.1
			NOT = { legitimacy_equivalent = 10 }
		}
		modifier = {
			factor = 3
			is_lesser_in_union = yes
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { exists = NOG }
			}
			NOG = { clr_country_flag = POP_Init }
		}
		nogai_area = {
			if = {
				limit = {
					isValidProv = yes
				}
				add_core = NOG
				if = {
					limit = {
						culture = tartar
					}
					change_culture = nogai
				}
			}
		}
	}
	
	option = {
		name = "OPT.BASTARD"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				is_at_war = yes
			}
			modifier = {
				factor = 2
				NOT = { is_nomad = yes }
			}
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[NOG.GetName] broke free, war started:flavor_ggk.41"

		nogai_area = {
			if = {
				limit = {
					owned_by = PREV
					isValidProv = yes
					is_capital = no
				}
				cede_province = NOG
			}
		}
		if = {
			limit = {
				NOG = { is_subject = no }
				is_free_or_tributary_trigger = yes
			}
			create_subject = {
				who = NOG
				subject_type = custom_vassal
			}
		}
		NOG = {
			add_casus_belli = {
				target = ROOT
				type = cb_independence_war
				months = 12
			}
			declare_war_with_cb = { who = ROOT casus_belli = cb_independence_war }
		}
	}
	
	option = {
		name = "OPT.VERYWELL"
		ai_chance = {
			factor = 50
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[NOG.GetName] broke free, no war:flavor_ggk.41"
		nogai_area = {
			if = {
				limit = {
					owned_by = PREV
					isValidProv = yes
					is_capital = no
				}
				cede_province = NOG
			}
		}
		if = {
			limit = {
				is_nomad = yes
			}
			add_horde_unity = -10
		}
	}
	after = {
		NOG = {
			hidden_effect = {
				if = {
					limit = {
						owns = 3287
					}
					Effect_set_capital = { target=3287 }
				}
				if = {
					limit = {
						ai = no
					}
					add_country_modifier = { name = blessing_of_god duration = 1825 }
				}
				if = {
					limit = {
						NOT = { has_country_flag = POP_Init }
					}
					steppe_effect = yes
					country_event = { id = Init.1 }
				}
			}
		}
	}
}

# 931051 - Kazakh events
country_event = {
	id = flavor_ggk.51
	title = "flavor_ggk.51.t"				# Rise of the Kazakh
	desc = "flavor_ggk.51.d"				# In the midst or our dire situation, our traitrous Kazakh subjects have risen against us in a bid to gain their independence.
	picture = GENGIS_KHAN_eventPicture
	
	trigger = {
		is_year = 1400
		#NOT = { has_global_flag = 1530_start_date }
		OR = {
			culture_group = altaic
			culture_group = tartar_group
			culture_group = old_turkic
		}
		NOT = { tag = KZH }
		OR = {
			is_bankrupt = yes
			AND = {
				is_at_war = yes
				NOT = { war_score = -20 }
			}
			NOT = { legitimacy_equivalent = 30 }
			NOT = { stability = 0 }
		}
		num_of_owned_provinces_with = {
			value = 2
			region = kazakh_region
			check_key = { lhs = NM_Ratio value = 10 }
		}
		NOT = { has_country_flag = Horde_Collapse_Ongoing }
		NOT = { has_country_flag = Horde_Ruler_Murdered }
		NOT = { war_with = TIM }
		NOT = { war_with = GGK }
		Not_Have_Timur = yes
	}
	
	mean_time_to_happen = {
		years = 20
		
		modifier = {
			factor = 0.5
			OR = {
				tag = GOL
				tag = WHI
				tag = BLU
				tag = TIM
				tag = YUA
				tag = GGK
				tag = CHU
				is_nomad = no
			}
		}
		modifier = {
			factor = 0.1
			has_any_disaster = yes
		}
		modifier = {
			factor = 0.5
			exists = RUS
			NOT = { tag = RUS }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -30 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -40 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -50 }
		}
		modifier = {
			factor = 0.1
			NOT = { legitimacy_equivalent = 10 }
		}
		modifier = {
			factor = 3
			is_lesser_in_union = yes
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { exists = KZH }
			}
			KZH = { clr_country_flag = POP_Init }
		}
		every_province = {
			limit = {
				OR = {
					region = kazakh_region
					area = syrdarya_area
					area = arys_area
					province_id = 477
				}
			}
			add_core = KZH
			if = {
				limit = {
					culture = tartar
				}
				change_culture = khazak
			}
		}
		5072 = {
			change_culture = khazak
		}
		2223 = {
			change_culture = khazak
		}
		3295 = {
			change_culture = khazak
		}
	}
	
	option = {
		name = "OPT.BASTARD"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				is_at_war = yes
			}
			modifier = {
				factor = 2
				NOT = { is_nomad = yes }
			}
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[KZH.GetName] broke free, war started:flavor_ggk.51"

		kazakh_region = {
			limit = {
				owned_by = PREV
				isValidProv = yes
				is_capital = no
			}
			cede_province = KZH
		}
		if = {
			limit = {
				KZH = { is_subject = no }
				is_free_or_tributary_trigger = yes
			}
			create_subject = {
				who = KZH
				subject_type = custom_vassal
			}
		}
		KZH = {
			if = {
				limit = {
					NOT = { war_with = ROOT }
				}
				add_casus_belli = {
					target = ROOT
					type = cb_independence_war
					months = 12
				}
				declare_war_with_cb = { who = ROOT casus_belli = cb_independence_war }
			}
		}
	}
	
	option = {
		name = "OPT.VERYWELL"
		ai_chance = {
			factor = 50
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[KZH.GetName] broke free, no war:flavor_ggk.51"
		kazakh_region = {
			limit = {
				owned_by = PREV
				isValidProv = yes
				is_capital = no
			}
			cede_province = KZH
		}
		if = {
			limit = {
				is_nomad = yes
			}
			add_horde_unity = -10
		}
	}
	after = {
		KZH = {
			hidden_effect = {
				if = {
					limit = {
						owns = 3298
					}
					Effect_set_capital = { target=3298 }
				}
				else_if = {
					limit = {
						owns = 3296
					}
					Effect_set_capital = { target=3296 }
				}
				else_if = {
					limit = {
						owns = 3312
					}
					Effect_set_capital = { target=3312 }
				}
				else_if = {
					limit = {
						owns = 3287
					}
					Effect_set_capital = { target=3287 }
				}
				if = {
					limit = {
						ai = no
					}
					add_country_modifier = { name = blessing_of_god duration = 1825 }
				}
				if = {
					limit = {
						NOT = { has_country_flag = POP_Init }
					}
					steppe_effect = yes
					country_event = { id = Init.1 }
				}
			}
		}
	}
}


# 931061 - Shaybanid events
country_event = {
	id = flavor_ggk.61
	title = "flavor_ggk.61.t"				# Rise of the Shaybanid
	desc = "flavor_ggk.61.d"				# In the midst or our dire situation, our traitrous Uzbehk subjects have risen against us in a bid to gain their independence.
	picture = GENGIS_KHAN_eventPicture
	
	trigger = {
		#NOT = { has_global_flag = 1530_start_date }
		OR = {
			culture_group = altaic
			culture_group = tartar_group
			culture_group = old_turkic
		}
		NOT = { tag = SHY }
		OR = {
			is_bankrupt = yes
			AND = {
				is_at_war = yes
				NOT = { war_score = -20 }
			}
			NOT = { legitimacy_equivalent = 30 }
			NOT = { stability = 0 }
		}
		num_of_owned_provinces_with = {
			value = 2
			region = amodarya_region
			NOT = { area = khiva_area }
			check_key = { lhs = NM_Ratio value = 10 }
		}
		NOT = { has_country_flag = Horde_Collapse_Ongoing }
		NOT = { has_country_flag = Horde_Ruler_Murdered }
		NOT = { war_with = TIM }
		NOT = { war_with = GGK }
		Not_Have_Timur = yes
		NOT = {
			any_known_country = {
				Timur_Has = yes
				isValidCountry = yes
			}
		}
		is_year = 1410
	}
	
	mean_time_to_happen = {
		years = 20
		
		modifier = {
			factor = 0.5
			OR = {
				tag = GOL
				tag = WHI
				tag = BLU
				tag = TIM
				tag = YUA
				tag = GGK
				tag = CHU
				is_nomad = no
			}
		}
		modifier = {
			factor = 0.1
			has_any_disaster = yes
		}
		modifier = {
			factor = 0.5
			exists = RUS
			NOT = { tag = RUS }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -30 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -40 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -50 }
		}
		modifier = {
			factor = 0.1
			NOT = { legitimacy_equivalent = 10 }
		}
		modifier = {
			factor = 3
			is_lesser_in_union = yes
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { exists = SHY }
			}
			SHY = { clr_country_flag = POP_Init }
		}
		amodarya_region = {
			limit = {
				NOT = { area = khiva_area }
				NOT = { area = balkh_area }
				NOT = { area = vaxsh_area }
			}
			add_core = SHY
			if = {
				limit = {
					OR = {
						culture = tartar
						culture = chaghatai
					}
				}
				change_culture = uzbehk
			}
		}
		syrdarya_region = {
			limit = {
				culture = chaghatai
			}
			if = {
				limit = {
					OR = {
						culture = tartar
						culture = chaghatai
					}
				}
				change_culture = uzbehk
			}
		}
		tashkent_area = {
			add_core = SHY
			if = {
				limit = {
					OR = {
						culture = tartar
						culture = chaghatai
					}
				}
				change_culture = uzbehk
			}
		}
		5071 = {
			change_culture = uzbehk
		}
		khiva_area = {
			if = {
				limit = {
					OR = {
						culture = tartar
						culture = chaghatai
					}
				}
				change_culture = uzbehk
			}
		}
	}
	
	option = {
		name = "OPT.BASTARD"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				is_at_war = yes
			}
			modifier = {
				factor = 2
				NOT = { is_nomad = yes }
			}
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[SHY.GetName] broke free, war started:flavor_ggk.61"

		amodarya_region = {
			limit = {
				owned_by = PREV
				isValidProv = yes
				NOT = { area = khiva_area }
				is_capital = no
			}
			cede_province = SHY
		}
		tashkent_area = {
			limit = {
				owned_by = PREV
				isValidProv = yes
				is_capital = no
			}
			cede_province = SHY
		}
		if = {
			limit = {
				SHY = { is_subject = no }
				is_free_or_tributary_trigger = yes
			}
			create_subject = {
				who = SHY
				subject_type = custom_vassal
			}
		}
		SHY = {
			if = {
				limit = {
					NOT = { war_with = ROOT }
				}
				add_casus_belli = {
					target = ROOT
					type = cb_independence_war
					months = 12
				}
				declare_war_with_cb = { who = ROOT casus_belli = cb_independence_war }
			}
		}
	}
	
	option = {
		name = "OPT.VERYWELL"
		ai_chance = {
			factor = 50
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[SHY.GetName] broke free, no war:flavor_ggk.61"
		amodarya_region = {
			limit = {
				owned_by = PREV
				isValidProv = yes
				NOT = { area = khiva_area }
				is_capital = no
			}
			cede_province = SHY
		}
		tashkent_area = {
			limit = {
				owned_by = PREV
				isValidProv = yes
				is_capital = no
			}
			cede_province = SHY
		}
		if = {
			limit = {
				is_nomad = yes
			}
			add_horde_unity = -10
		}
	}
	after = {
		SHY = {
			hidden_effect = {
				if = {
					limit = {
						owns = 457
					}
					Effect_set_capital = { target=457 }
				}
				else_if = {
					limit = {
						owns = 436
					}
					Effect_set_capital = { target=436 }
				}
				else_if = {
					limit = {
						owns = 454
					}
					Effect_set_capital = { target=454 }
				}
				else_if = {
					limit = {
						owns = 3296
					}
					Effect_set_capital = { target=3296 }
				}
				else_if = {
					limit = {
						owns = 3298
					}
					Effect_set_capital = { target=3298 }
				}
				if = {
					limit = {
						ai = no
					}
					add_country_modifier = { name = blessing_of_god duration = 1825 }
				}
				if = {
					limit = {
						NOT = { has_country_flag = POP_Init }
					}
					steppe_effect = yes
					country_event = { id = Init.1 }
				}
			}
		}
	}
}


# 931071 - Khiva events
country_event = {
	id = flavor_ggk.71
	title = "flavor_ggk.71.t"				# Rise of the Khiva Khanate
	desc = "flavor_ggk.71.d"				# In the midst or our dire situation, our traitrous Turkmeni subjects have risen against us in a bid to gain their independence.
	picture = GENGIS_KHAN_eventPicture
	
	trigger = {
		#NOT = { has_global_flag = 1530_start_date }
		OR = {
			culture_group = altaic
			culture_group = tartar_group
			culture_group = old_turkic
		}
		NOT = { tag = KHI }
		OR = {
			is_bankrupt = yes
			AND = {
				is_at_war = yes
				NOT = { war_score = -20 }
			}
			NOT = { legitimacy_equivalent = 40 }
			NOT = { stability = 0 }
		}
		num_of_owned_provinces_with = {
			value = 2
			area = khiva_area
			check_key = { lhs = NM_Ratio value = 10 }
		}
		NOT = { has_country_flag = Horde_Collapse_Ongoing }
		NOT = { has_country_flag = Horde_Ruler_Murdered }
		NOT = { war_with = TIM }
		NOT = { war_with = GGK }
		Not_Have_Timur = yes
		NOT = {
			any_known_country = {
				Timur_Has = yes
				isValidCountry = yes
			}
		}
		is_year = 1405
	}
	
	mean_time_to_happen = {
		years = 20
		
		modifier = {
			factor = 0.5
			OR = {
				tag = GOL
				tag = WHI
				tag = BLU
				tag = TIM
				tag = YUA
				tag = GGK
				tag = CHU
				is_nomad = no
			}
		}
		modifier = {
			factor = 0.1
			has_any_disaster = yes
		}
		modifier = {
			factor = 0.5
			exists = RUS
			NOT = { tag = RUS }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -30 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -40 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -50 }
		}
		modifier = {
			factor = 0.1
			NOT = { legitimacy_equivalent = 10 }
		}
		modifier = {
			factor = 3
			is_lesser_in_union = yes
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { exists = KHI }
			}
			KHI = { clr_country_flag = POP_Init }
		}
		khiva_area = {
			add_core = KHI
			if = {
				limit = {
					OR = {
						culture = tartar
						culture = chaghatai
					}
				}
				change_culture = uzbehk
			}
		}
	}
	
	option = {
		name = "OPT.BASTARD"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				is_at_war = yes
			}
			modifier = {
				factor = 2
				NOT = { is_nomad = yes }
			}
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[KHI.GetName] broke free, war started:flavor_ggk.71"
		khiva_area = {
			if = {
				limit = {
					owned_by = PREV
					isValidProv = yes
					is_capital = no
				}
				cede_province = KHI
			}
		}
		if = {
			limit = {
				KHI = { is_subject = no }
				is_free_or_tributary_trigger = yes
			}
			create_subject = {
				who = KHI
				subject_type = custom_vassal
			}
		}
		KHI = {
			if = {
				limit = {
					NOT = { war_with = ROOT }
				}
				add_casus_belli = {
					target = ROOT
					type = cb_independence_war
					months = 12
				}
				declare_war_with_cb = { who = ROOT casus_belli = cb_independence_war }
			}
		}
	}
	
	option = {
		name = "OPT.VERYWELL"
		ai_chance = {
			factor = 50
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[KHI.GetName] broke free, no war:flavor_ggk.71"
		khiva_area = {
			if = {
				limit = {
					owned_by = PREV
					isValidProv = yes
					is_capital = no
				}
				cede_province = KHI
			}
		}
		if = {
			limit = {
				is_nomad = yes
			}
			add_horde_unity = -10
		}
	}
	after = {
		KHI = {
			hidden_effect = {
				if = {
					limit = {
						owns = 442
					}
					Effect_set_capital = { target=442 }
				}
				else_if = {
					limit = {
						owns = 3279
					}
					Effect_set_capital = { target=3279 }
				}
				if = {
					limit = {
						ai = no
					}
					add_country_modifier = { name = blessing_of_god duration = 1825 }
				}
				if = {
					limit = {
						NOT = { has_country_flag = POP_Init }
					}
					steppe_effect = yes
					country_event = { id = Init.1 }
				}
			}
		}
	}
}

# 931081 - Kazan events
country_event = {
	id = flavor_ggk.81
	title = "flavor_ggk.81.t"				# Rise of the Kazan Khanate
	desc = "flavor_ggk.81.d"				# In the midst or our dire situation, our traitrous Kazani subjects have risen against us in a bid to gain their independence.
	picture = GENGIS_KHAN_eventPicture
	
	trigger = {
		#NOT = { has_global_flag = 1530_start_date }
		OR = {
			culture_group = altaic
			culture_group = tartar_group
			culture_group = old_turkic
		}
		NOT = { tag = KAZ }
		OR = {
			is_bankrupt = yes
			AND = {
				is_at_war = yes
				NOT = { war_score = -20 }
			}
			NOT = { legitimacy_equivalent = 30 }
			NOT = { stability = 0 }
		}
		num_of_owned_provinces_with = {
			value = 2
			culture = kazani
			check_key = { lhs = NM_Ratio value = 10 }
		}
		OR = {
			is_year = 1400
			AND = { 
				NOT = { has_country_flag = Horde_Collapse_Ongoing }
				NOT = { has_country_flag = Horde_Ruler_Murdered }
			}
		}
		NOT = { war_with = TIM }
		NOT = { war_with = GGK }
		Not_Have_Timur = yes
	}
	
	mean_time_to_happen = {
		years = 20
		
		modifier = {
			factor = 0.5
			OR = {
				tag = GOL
				tag = WHI
				tag = BLU
				tag = TIM
				tag = YUA
				tag = GGK
				tag = CHU
				is_nomad = no
			}
		}
		modifier = {
			factor = 0.1
			has_any_disaster = yes
		}
		modifier = {
			factor = 0.5
			exists = RUS
			NOT = { tag = RUS }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -30 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -40 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -50 }
		}
		modifier = {
			factor = 0.1
			NOT = { legitimacy_equivalent = 10 }
		}
		modifier = {
			factor = 3
			is_lesser_in_union = yes
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { exists = KAZ }
			}
			KAZ = { clr_country_flag = POP_Init }
		}
		4016 = {
			add_core = KAZ
			if = {
				limit = {
					culture = tartar
				}
				change_culture = kazani
			}
		}
		1308 = {
			add_core = KAZ
			if = {
				limit = {
					culture = tartar
				}
				change_culture = kazani
			}
		}
		1296 = {
			add_core = KAZ
			if = {
				limit = {
					culture = tartar
				}
				change_culture = kazani
			}
		}
	}
	
	option = {
		name = "OPT.BASTARD"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				is_at_war = yes
			}
			modifier = {
				factor = 2
				NOT = { is_nomad = yes }
			}
			modifier = {
				factor = 0
				tag = WHI
			}
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[KAZ.GetName] broke free, war started:flavor_ggk.81"
		every_owned_province = {
			limit = {
				isValidProv = yes
				culture = kazani
				is_capital = no
			}
			cede_province = KAZ
		}
		if = {
			limit = {
				KAZ = { is_subject = no }
				is_free_or_tributary_trigger = yes
			}
			create_subject = {
				who = KAZ
				subject_type = custom_vassal
			}
		}
		KAZ = {
			if = {
				limit = {
					NOT = { war_with = ROOT }
				}
				add_casus_belli = {
					target = ROOT
					type = cb_independence_war
					months = 12
				}
				declare_war_with_cb = { who = ROOT casus_belli = cb_independence_war }
			}
		}
	}
	
	option = {
		name = "OPT.VERYWELL"
		ai_chance = {
			factor = 50
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[KAZ.GetName] broke free, no war:flavor_ggk.81"
		every_owned_province = {
			limit = {
				isValidProv = yes
				culture = kazani
				is_capital = no
			}
			cede_province = KAZ
		}
		if = {
			limit = {
				is_nomad = yes
			}
			add_horde_unity = -10
		}
	}
	after = {
		KAZ = {
			hidden_effect = {
				if = {
					limit = {
						owns = 1307
					}
					Effect_set_capital = { target=1307 }
				}
				else_if = {
					limit = {
						owns = 1311
					}
					Effect_set_capital = { target=1311 }
				}
				if = {
					limit = {
						ai = no
					}
					add_country_modifier = { name = blessing_of_god duration = 1825 }
				}
				if = {
					limit = {
						NOT = { has_country_flag = POP_Init }
					}
					steppe_effect = yes
					country_event = { id = Init.1 }
				}
			}
		}
	}
}

# 931091 - Sibir events
country_event = {
	id = flavor_ggk.91
	title = "flavor_ggk.91.t"				# Rise of the Sibir Khanate
	desc = "flavor_ggk.91.d"				# In the midst or our dire situation, our traitrous Siberian subjects have risen against us in a bid to gain their independence.
	picture = GENGIS_KHAN_eventPicture
	
	trigger = {
		#NOT = { has_global_flag = 1530_start_date }
		OR = {
			culture_group = altaic
			culture_group = tartar_group
			culture_group = old_turkic
		}
		NOT = { tag = SIB }
		OR = {
			is_bankrupt = yes
			AND = {
				is_at_war = yes
				NOT = { war_score = -20 }
			}
			NOT = { legitimacy_equivalent = 50 }
			NOT = { stability = 0 }
		}
		num_of_owned_provinces_with = {
			value = 2
			OR = {
				area = iskier_area
				area = yrtesh_area
			}
			check_key = { lhs = NM_Ratio value = 10 }
		}
		NOT = { has_country_flag = Horde_Collapse_Ongoing }
		NOT = { has_country_flag = Horde_Ruler_Murdered }
		NOT = { war_with = TIM }
		NOT = { war_with = GGK }
		Not_Have_Timur = yes
	}
	
	mean_time_to_happen = {
		years = 20
		
		modifier = {
			factor = 0.5
			OR = {
				tag = GOL
				tag = WHI
				tag = BLU
				tag = TIM
				tag = YUA
				tag = GGK
				tag = CHU
				is_nomad = no
			}
		}
		modifier = {
			factor = 0.1
			has_any_disaster = yes
		}
		modifier = {
			factor = 0.5
			exists = RUS
			NOT = { tag = RUS }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -30 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -40 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -50 }
		}
		modifier = {
			factor = 0.1
			NOT = { legitimacy_equivalent = 10 }
		}
		modifier = {
			factor = 3
			is_lesser_in_union = yes
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { exists = SIB }
			}
			SIB = { clr_country_flag = POP_Init }
		}
		west_siberia_region = {
			limit = {
				isValidProv = yes
				NOT = { area = upper_ob_area }
			}
			add_core = SIB
			if = {
				limit = {
					OR = {
						culture = tartar
						culture = chaghatai
					}
				}
				change_culture = siberian
			}
		}
		kazakh_region = {
			if = {
				limit = {
					isValidProv = yes
					culture = siberian
				}
				add_core = SIB
			}
		}
	}
	
	option = {
		name = "OPT.BASTARD"
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.5
				is_at_war = yes
			}
			modifier = {
				factor = 2
				NOT = { is_nomad = yes }
			}
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[SIB.GetName] broke free, war started:flavor_ggk.91"
		west_siberia_region = {
			limit = {
				isValidProv = yes
				NOT = { area = upper_ob_area }
				owned_by = PREV
				is_capital = no
			}
			cede_province = SIB
		}
		4204 = {
			if = {
				limit = {
					is_capital = no
				}
				cede_province = SIB
			}
		}
		kazakh_region = {
			limit = {
				isValidProv = yes
				culture = siberian
				owned_by = PREV
				is_capital = no
			}
			cede_province = SIB
		}
		if = {
			limit = {
				SIB = { is_subject = no }
				is_free_or_tributary_trigger = yes
			}
			create_subject = {
				who = SIB
				subject_type = custom_vassal
			}
		}
		SIB = {
			if = {
				limit = {
					NOT = { war_with = ROOT }
				}
				add_casus_belli = {
					target = ROOT
					type = cb_independence_war
					months = 12
				}
				declare_war_with_cb = { who = ROOT casus_belli = cb_independence_war }
			}
		}
	}
	
	option = {
		name = "OPT.VERYWELL"
		ai_chance = {
			factor = 70
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[SIB.GetName] broke free, no war:flavor_ggk.91"
		west_siberia_region = {
			limit = {
				isValidProv = yes
				NOT = { area = upper_ob_area }
				owned_by = PREV
				is_capital = no
			}
			cede_province = SIB
		}
		4204 = {
			if = {
				limit = {
					is_capital = no
				}
				cede_province = SIB
			}
		}
		kazakh_region = {
			limit = {
				isValidProv = yes
				culture = siberian
				owned_by = PREV
				is_capital = no
			}
			cede_province = SIB
		}
		if = {
			limit = {
				is_nomad = yes
			}
			add_horde_unity = -10
		}
	}
	after = {
		SIB = {
			hidden_effect = {
				define_ruler = {
					name = "Abu'l Khayr"
					dynasty = "Shaybanid"
					culture = siberian
					ADM = 3
					DIP = 4
					MIL = 5
					claim = 90
				}
				if = {
					limit = {
						owns = 1079
					}
					Effect_set_capital = { target=1079 }
				}
				else_if = {
					limit = {
						owns = 2446
					}
					Effect_set_capital = { target=2446 }
				}
				if = {
					limit = {
						ai = no
					}
					add_country_modifier = { name = blessing_of_god duration = 1825 }
				}
				if = {
					limit = {
						NOT = { has_country_flag = POP_Init }
					}
					steppe_effect = yes
					country_event = { id = Init.1 }
				}
			}
		}
	}
}


# 931.92 - Bashkir events
country_event = {
	id = flavor_ggk.101
	title = "flavor_ggk.101.t"				# Rise of the Bashkir Khanate
	desc = "flavor_ggk.101.d"				# In the midst or our dire situation, our traitrous Bashkir subjects have risen against us in a bid to gain their independence.
	picture = GENGIS_KHAN_eventPicture
	
	trigger = {
		#NOT = { has_global_flag = 1530_start_date }
		OR = {
			culture_group = altaic
			culture_group = tartar_group
			culture_group = old_turkic
		}
		NOT = { tag = BSH }
		OR = {
			is_bankrupt = yes
			AND = {
				is_at_war = yes
				NOT = { war_score = -20 }
			}
			NOT = { legitimacy_equivalent = 40 }
			NOT = { stability = 0 }
		}
		num_of_owned_provinces_with = {
			value = 1
			culture = bashkir
			check_key = { lhs = NM_Ratio value = 10 }
		}
		NOT = { war_with = TIM }
		NOT = { war_with = GGK }
		Not_Have_Timur = yes
	}
	
	mean_time_to_happen = {
		years = 20
		
		modifier = {
			factor = 0.5
			OR = {
				tag = GOL
				tag = WHI
				tag = BLU
				tag = TIM
				tag = YUA
				tag = GGK
				tag = CHU
				is_nomad = no
			}
		}
		modifier = {
			factor = 0.1
			has_any_disaster = yes
		}
		modifier = {
			factor = 0.5
			exists = RUS
			NOT = { tag = RUS }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -30 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -40 }
		}
		modifier = {
			factor = 0.9
			is_at_war = yes
			NOT = { war_score = -50 }
		}
		modifier = {
			factor = 0.1
			NOT = { legitimacy_equivalent = 10 }
		}
		modifier = {
			factor = 3
			is_lesser_in_union = yes
		}
	}
	
	immediate = {
		if = {
			limit = {
				NOT = { exists = BSH }
			}
			BSH = { clr_country_flag = POP_Init }
		}
		2438 = {
			if = {
				limit = {
					culture = bashkir
				}
				add_core = BSH
			}
		}
		1082 = {
			if = {
				limit = {
					culture = bashkir
				}
				add_core = BSH
			}
		}
		1080 = {
			if = {
				limit = {
					culture = bashkir
				}
				add_core = BSH
			}
		}
	}
	
	option = {
		name = "OPT.BASTARD"
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.5
				is_at_war = yes
			}
			modifier = {
				factor = 2
				NOT = { is_nomad = yes }
			}
			modifier = {
				factor = 0
				tag = WHI
			}
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[BSH.GetName] broke free, war started:flavor_ggk.101"
		every_owned_province = {
			limit = {
				isValidProv = yes
				culture = bashkir
				is_capital = no
			}
			cede_province = BSH
		}
		if = {
			limit = {
				BSH = { is_subject = no }
				is_free_or_tributary_trigger = yes
			}
			create_subject = {
				who = BSH
				subject_type = custom_vassal
			}
		}
		BSH = {
			if = {
				limit = {
					NOT = { war_with = ROOT }
				}
				add_casus_belli = {
					target = ROOT
					type = cb_independence_war
					months = 12
				}
				declare_war_with_cb = { who = ROOT casus_belli = cb_independence_war }
			}
		}
	}
	
	option = {
		name = "OPT.VERYWELL"
		ai_chance = {
			factor = 70
		}
		log = "FE-Steppe:[GetYear]:[Root.GetName]:[BSH.GetName] broke free, no war:flavor_ggk.101"
		every_owned_province = {
			limit = {
				isValidProv = yes
				culture = bashkir
				is_capital = no
			}
			cede_province = BSH
		}
		if = {
			limit = {
				is_nomad = yes
			}
			add_horde_unity = -10
		}
	}
	after = {
		BSH = {
			hidden_effect = {
				if = {
					limit = {
						owns = 2438
					}
					Effect_set_capital = { target=2438 }
				}
				else_if = {
					limit = {
						owns = 1082
					}
					Effect_set_capital = { target=1082 }
				}
				if = {
					limit = {
						ai = no
					}
					add_country_modifier = { name = blessing_of_god duration = 1825 }
				}
				if = {
					limit = {
						NOT = { has_country_flag = POP_Init }
					}
					steppe_effect = yes
					country_event = { id = Init.1 }
				}
			}
		}
	}
}



# Set up the Khanate and Puppet Khanate modifiers
country_event = {
	id = horde_mechanic_events.1
	title = horde_mechanic_events.1.t
	desc = horde_mechanic_events.1.d
	picture = PALAIS_MAZARIN_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_country_modifier = genghis_khanate
			has_country_modifier = puppet_khanate
		}
		NOT = { has_disaster = Horde_Collapse }
		NOT = { has_country_flag = Horde_Collapse_Ongoing }
		NOT = { has_country_flag = Horde_Ruler_Murdered }
		NOT = { has_country_flag = Horde_Timur }
	}
	
	hidden = yes
	
	option = {
		name = horde_mechanic_events.1.a
		if = {
			limit = {
				NOT = { has_country_modifier = genghis_khanate }
				NOT = { has_country_modifier = puppet_khanate }
				borjigin_trigger = yes
			}
			add_country_modifier = {
				name = genghis_khanate
				duration = -1
			}
		}
		if = {
			limit = {
				has_country_modifier = genghis_khanate
				borjigin_trigger = no
			}
			remove_country_modifier = genghis_khanate
			add_country_modifier = {
				name = puppet_khanate
				duration = -1
			}
		}
		if = {
			limit = {
				has_country_modifier = puppet_khanate
				borjigin_trigger = yes
			}
			remove_country_modifier = puppet_khanate
			add_country_modifier = {
				name = genghis_khanate
				duration = -1
			}
		}
	}
}
# Asssination by Moghulistan, we assume it was already in-play
country_event = {
	id = timur.1
	title = timur.1.t
	desc = timur.1.d
	picture = KING_SICK_IN_BED_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = CHG
		dynasty = "Qara'unas"
		has_any_disaster = no
		is_year = 1358
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	option = {
		name = "timur.1.a"
		kill_ruler = yes
		add_horde_unity = -50
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-15 }
		hidden_effect = {
			set_country_flag = Horde_Ruler_Murdered
			add_prestige = -10
		}
		random_list = {
			30 = {
				Stab_Subtract25Percent = yes
			}
			50 = {
				Stab_Subtract50Percent = yes
			}
			20 = {
				Stab_Subtract1 = yes
			}
		}
		hidden_effect = {
			random_list = {
				30 = {
					country_event = {
						id = timur.2
						days = 180
					}
				}
				50 = {
					country_event = {
						id = timur.2
						days = 365
					}
				}
				20 = {
					country_event = {
						id = timur.2
						days = 250
					}
				}
			}
		}
	}
}
# Option to move capital north, historically was a bad move
country_event = {
	id = timur.2
	title = timur.2.t
	desc = timur.2.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = {
		tag = CHG
		dynasty = "Qara'unas"
		has_country_flag = Horde_Ruler_Murdered
	}
	
	option = {
		name = "timur.2.a"
		ai_chance = {
			factor = 90
		}
		Effect_set_capital = { target=457 }
		hidden_effect = {
			every_owned_province = {
				limit = {
					Chagatai_North = yes
					isValidProv = yes
				}
				Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=TR Amount=-10 }
			}
			every_owned_province = {
				limit = {
					Chagatai_South = yes
					isValidProv = yes
				}
				Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=TR Amount=5 }
			}
			country_event = {
				id = timur.3
				days = 50
			}
		}
		add_prestige = 40
	}
	option = {
		name = "timur.2.b"
		ai_chance = {
			factor = 10
		}
		hidden_effect = {
			every_owned_province = {
				limit = {
					Chagatai_South = yes
					isValidProv = yes
				}
				Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=TR Amount=-15 }
			}
		}
		Stab_Add25Percent = yes
	}
}
country_event = {
	id = timur.3
	title = timur.3.t
	desc = timur.3.d
	picture = CIVIL_WAR_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		tag = CHG
		dynasty = "Qara'unas"
	}
	
	option = {
		name = "timur.3.a"
		kill_ruler = yes
		define_ruler = {
			name = "Bayan"
			dynasty = "Suldus"
			culture = turco_mongol
			ADM = 1
			DIP = 1
			MIL = 1
			claim = 80
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-15 }
		hidden_effect = {
			every_owned_province = {
				limit = {
					Chagatai_North = yes
					isValidProv = yes
				}
				Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=TR Amount=15 }
			}
			every_owned_province = {
				limit = {
					Chagatai_South = yes
					isValidProv = yes
				}
				Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=TR Amount=-20 }
			}
		}
		add_prestige = -25
		random_list = {
			30 = {
				Stab_Subtract50Percent = yes
			}
			50 = {
				Stab_Subtract1 = yes
			}
			20 = {
				Stab_Subtract2 = yes
			}
		}
	}
}
country_event = {
	id = timur.4
	title = timur.4.t
	desc = timur.4.d
	picture = MONGOL_BANNERS_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = MGH
		is_year = 1360
		is_at_war = no
		dynasty = "Chagatayid"
		CHG = { has_disaster = Horde_Collapse }
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	option = {
		name = "timur.4.a"
		ai_chance = {
			factor = 80
		}
		add_prestige = 25
		declare_war_with_cb = {
			who = CHG
			casus_belli = cb_nomadic_submission
		}
		CHG = { country_event = { id = timur.5 days = 10 } }
		hidden_effect = {
			CHG = {
				if = {
					limit = {
						NOT = { has_country_flag = Horde_TimurDead }
					}
					country_event = { id = timur.6 days = 30 }
				}
			}
		}
	}
	
	option = {
		name = "timur.4.b"
		ai_chance = {
			factor = 20
		}
		add_prestige = -25
		add_horde_unity = 25
		hidden_effect = {
			white_peace = CHG
		}
	}
}

country_event = {
	id = timur.5
	title = timur.5.t
	desc = timur.5.d
	picture = OVEREXTENSION_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
	
	option = {
		name = "timur.5.a"
		add_horde_unity = -25
		random_owned_province = {
			limit = {
				isValidProv = yes
				development = 7
				culture_group = tartar_group
			}
			spawn_rebels = {
				type = pretender_rebels
				culture = turco_mongol
				size = 2
				should_take_capital = yes
			}
		}
		random_owned_province = {
			limit = {
				isValidProv = yes
				development = 7
				culture_group = persian_group
			}
			spawn_rebels = {
				type = pretender_rebels
				culture = turco_mongol
				size = 2
				should_take_capital = yes
			}
		}
	}
}
country_event = {
	id = timur.6
	title = timur.6.t
	desc = timur.6.d
	picture = ACCUSATION_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
	
	option = {
		name = "timur.6.a"
		add_prestige = -10
		MGH = {
			define_general = {
				name = "Timur Barlas"
				shock = 6
				fire = 6
				manuever = 6
				siege = 5
			}
		}
	}
}
country_event = {
	id = timur.7
	title = timur.7.t
	desc = timur.7.d
	picture = OVEREXTENSION_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = CHG
		NOT = { war_score = -25 }
		war_with = MGH
		has_disaster = Horde_Collapse
	}
	
	mean_time_to_happen = {
		months = 2
	}
	
	option = {
		name = "timur.7.a"
		ai_chance = {
			factor = 90
		}
		add_prestige = 25
		MGH = {
			white_peace = CHG
			hidden_effect = {
				CHG = { 
					set_key = { lhs = Vassal_Type value = 10 }	
				}
			}
			create_subject = {
				who = CHG
				subject_type = daimyo_vassal
			}
		}
		every_owned_province = {
			limit = {
				is_core = MGH
			}
			cede_province = MGH
			remove_core = CHG
		}
		every_owned_province = {
			limit = {
				Chagatai_South = yes
				isValidProv = yes
			}
			Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=TR Amount=-15 }
		}
		# random_owned_province = {
		# 	limit = {
		# 		isValidProv = yes
		# 		Chagatai_South = yes
		# 		development = 7
		# 		owner = { NOT = { has_country_flag = Horde_TimurDead } }
		# 	}
			
		# 	#spawn_rebels = {
		# 	#	type = timur_rebels
		# 	#	culture = chaghatai
		# 	#	size = 2
		# 	#}
		# }
		hidden_effect = {
			add_country_modifier = { name = Horde_PuppetCD duration = 365 }
		} 
	}
	option = {
		name = "timur.7.b"
		ai_chance = {
			factor = 10
		}
		add_horde_unity = -25
		every_owned_province = {
			limit = {
				Chagatai_North = yes
				isValidProv = yes
			}
			Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=TR Amount=-15 }
		}
	}
	after = {
		MGH = { kill_leader = { type = "Timur Barlas" } }
	}
}
country_event = {
	id = timur.8
	title = timur.8.t
	desc = timur.8.d
	picture = KING_SICK_IN_BED_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = MGH
		is_year = 1365
		ai = yes
		OR = {
			overlord_of = CHG
			overlord_of = TIM
		}
	}
	
	mean_time_to_happen = {
		months = 24
		modifier = {
			factor = 0.9
			NOT = { stability = 1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 70 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 60 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 50 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 40 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 30 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 20 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 10 }
		}
	}
	
	option = {
		name = "timur.6.a"
		CHG = {
			if = {
				limit = {
					exists = yes
					is_subject_of = PREV
				}
				grant_independence = yes
				add_mutual_truce_effect = { scope=CHG }
				country_event = { id = timur.43 days = 1 }
			}
		}
		TIM = {
			if = {
				limit = {
					exists = yes
					is_subject_of = PREV
				}
				grant_independence = yes
				add_mutual_truce_effect = { scope=TIM }
				country_event = { id = timur.43 days = 1 }
			}
		}
		kill_ruler = yes # AI natural causes
	}
}
country_event = {
	id = timur.9
	title = timur.9.t
	desc = timur.9.d
	picture = CIVIL_WAR_eventPicture
	
	trigger = {
		tag = CHG
		is_free_or_tributary_trigger = yes
		is_year = 1365
		has_disaster = Horde_Collapse
		NOT = { has_country_flag = Horde_TimurDead }
		Timur_Has = no
		NOT = { has_country_modifier = Horde_PuppetCD }
	}
	
	mean_time_to_happen = {
		months = 12
		modifier = {
			factor = 0.9
			NOT = { stability = 1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.9
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 50 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 40 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 30 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 20 }
		}
		modifier = {
			factor = 0.9
			NOT = { legitimacy_equivalent = 10 }
		}
		modifier = {
			factor = 3
			has_country_flag = Horde_Great_Rule
		}
	}
	
	option = {
		name = "timur.9.a"
		random_owned_province = {
			limit = {
				isValidProv = yes
				development = 7
			}
			if = {
				limit = {
					is_year = 1368
				}
				spawn_rebels = {
					type = timur_rebels
					culture = turco_mongol
					religion = sunni
					size = 7
				}
			}
			else_if = {
				limit = {
					is_year = 1367
				}
				spawn_rebels = {
					type = timur_rebels
					culture = turco_mongol
					religion = sunni
					size = 6
				}
			}
			else_if = {
				limit = {
					is_year = 1366
				}
				spawn_rebels = {
					type = timur_rebels
					culture = turco_mongol
					religion = sunni
					size = 5
				}
			}
			else = {
				spawn_rebels = {
					type = timur_rebels
					culture = turco_mongol
					religion = sunni
					size = 4
				}
			}
		}
		add_country_modifier = { name = Horde_PuppetCD duration = 365 }
	}
}
country_event = {
	id = timur.10
	title = timur.10.t
	desc = timur.10.d
	picture = RELIGION_eventPicture
	
	major = yes
	fire_only_once = yes
	is_triggered_only = yes
	
	option = {
		name = "timur.10.a"
		ai_chance = {
			factor = 80
		}
		restore_country_name = yes
		ChangeTagEffect = { scope=TIM }
		change_title_6 = yes
		hidden_effect = {
			grant_independence = yes
			central_asia = {
				limit = {
					isValidProv = yes
					OR = {
						culture = chaghatai
						culture = turco_mongol
						culture = sart
						culture = kirgiz
						culture = tajihk
						culture = aimak
						culture = hazara
					}
					NOT = { province_id = 3094 }
				}
				if = {
					limit = {
						OR = {
							region = amodarya_region
							region = syrdarya_region
						}
						NOT = { area = syrdarya_area }
					}
					add_core = TIM
				}
				else = {
					add_permanent_claim = TIM
				}
			}
			central_asia = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = persian_group
						culture_group = oghuz
					}
				}
				add_permanent_claim = TIM
			}
			lower_mesopotamia_region = {
				add_permanent_claim = TIM
			}
			upper_mesopotamia_region = {
				add_claim = TIM
			}
			south_caucasus_region = {
				add_claim = TIM
			}
			west_anatolia_region = {
				add_claim = TIM
			}
			north_anatolia_region = {
				add_claim = TIM
			}
			south_anatolia_region = {
				add_claim = TIM
			}
			west_india_superregion = {
				add_permanent_claim = TIM
			}
		}
		hidden_effect = {
			set_country_flag = Timur_West
			Rights_NOGov3Apply = yes
			Rights_NOObl1Apply = yes
			Rights_NOTen3Apply = yes
			Rights_NOSer2Apply = yes
			Rights_BGCom6Apply = yes
			Rights_CLHie2Apply = yes
			Rights_CLTax3Apply = yes
			Rights_CLObl1Apply = yes
			Rights_BUTax1Apply = yes
			Rights_BUInd1Apply = yes
			Rights_BUSer1Apply = yes
			add_corruption = -30
			every_owned_province = {
				limit = {
					isValidProv = yes
				}
				add_local_autonomy = -30
			}
		}
		add_government_reform = Horde_MonarchyS
		add_accepted_culture = tajihk
		custom_tooltip = Timur_ClaimsW
		custom_tooltip = Timur_Opinion_Effect
		# Those who remember
		hidden_effect = {
			every_neighbor_country = {
				limit = {
					isValidCountry = yes
					OR = {
						# Persianates
						has_country_flag = Ilkhanate_Successor
						tag = SHI
						tag = KRS
						tag = HAZ
						# Tribes
						tag = QAR
						tag = AKK
						tag = KHO
					}
				}
				every_owned_province = {
					limit = {
						isValidProv = yes
					}
					add_core = event_target:Timur
				}
			}
			every_country = {
				limit = {
					OR = {
						culture_group = chinese_group
						culture_group = tibetic
						culture_group = korean_group
						culture_group = vietic
						culture_group = persian_group
						culture_group = maghreb
						culture_group = georgian_group
						culture_group = alanian_group
						culture_group = armenian
						culture_group = east_slavic
						culture_group = indus_group
						culture_group = hindi
						culture_group = aramaic_group
						AND = {
							culture_group = oghuz
							OR = {
								has_country_modifier = title_5
								has_country_modifier = title_6
							}
						}
						tag = JAI
					}
					OR = {
						has_discovered = 3843
						has_discovered = 436
						has_discovered = 457
					}
				}
				add_mutual_opinion_modifier_effect = {
					scope_country = TIM
					opinion_modifier = Timur_Opinion
				}
				
			}
		}
		Effect_set_capital = { target=457 }
		add_ruler_modifier = { name = Timur_Rise duration = -1 }
		add_horde_unity = 80
		add_prestige = 30
		Stab_Add3 = yes
		add_manpower = 20
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=35 }
		hidden_effect = {
			add_country_modifier = { name = Timur_Mustering duration = 3650 hidden = yes }
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=BU Amount=-30 }
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=15 }
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=BG Amount=10 }
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=CL Amount=10 }
			if = {
				limit = {
					ai = yes
				}
				add_treasury = 1000
				set_key = { lhs = Tax_CostAdmInp value = 0.35 }
				set_key = { lhs = Tax_CostDipInp value = 0.35 }
				set_key = { lhs = Tax_CostMilInp value = 0.35 }
				add_mil_tech = 1
				country_event = {
					id = AI_Tax.002
				}
				every_subject_country = {
					limit = {
						OR = {
							is_subject_of_type = tributary_state
							is_subject_of_type = close_tributary_state
						}
					}
					grant_independence = yes
				}
			}
		}
		country_event = { id = timur.38 days = 30 }
	}
	option = {
		name = "timur.10.b"
		ai_chance = {
			factor = 20
		}
		ChangeTagEffect = { scope=TIM }
		change_title_6 = yes
		hidden_effect = {
			grant_independence = yes
			central_asia = {
				limit = {
					isValidProv = yes
					OR = {
						culture = chaghatai
						culture = kirgiz
						culture = tajihk
						culture = aimak
						culture = hazara
						culture = turkmeni
						owned_by = MGH
						owned_by = KAS
						owned_by = OIR
						region = syrdarya_region
						region = zungaria_region
					}
					NOT = { province_id = 3094 }
				}
				add_core = TIM
			}
			steppes_group = {
				limit = {
					isValidProv = yes
					NOT = { culture = chaghatai }
					NOT = { culture_group = persian_group }
				}
				add_permanent_claim = TIM
			}
			central_asia = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = persian_group
						culture_group = oghuz
					}
				}
				add_claim = TIM
			}
			lower_mesopotamia_region = {
				add_claim = TIM
			}
			upper_mesopotamia_region = {
				add_claim = TIM
			}
			south_caucasus_region = {
				add_claim = TIM
			}
			west_india_superregion = {
				add_claim = TIM
			}
		}
		hidden_effect = {
			set_country_flag = Timur_East
			Rights_NOGov2Apply = yes
			Rights_NOObl1Apply = yes
			Rights_NOTen3Apply = yes
			Rights_NOSer2Apply = yes
			Rights_BGCom5Apply = yes
			Rights_CLHie3Apply = yes
			Rights_CLTax3Apply = yes
			Rights_CLObl1Apply = yes
			Rights_BUTax1Apply = yes
			Rights_BUInd1Apply = yes
			Rights_BUSer1Apply = yes
			add_corruption = -30
			every_owned_province = {
				limit = {
					isValidProv = yes
				}
				add_local_autonomy = -30
			}
		}
		add_government_reform = Horde_MonarchyS
		change_primary_culture = mongolic_turk
		add_accepted_culture = oirats
		add_accepted_culture = chaghatai
		add_accepted_culture = tartar
		custom_tooltip = Timur_ClaimsE
		custom_tooltip = Timur_Opinion_Effect
		# Those who remember
		hidden_effect = {
			every_country = {
				limit = {
					OR = {
						culture_group = chinese_group
						culture_group = tibetic
						culture_group = korean_group
						culture_group = vietic
						culture_group = persian_group
						culture_group = maghreb
						culture_group = georgian_group
						culture_group = alanian_group
						culture_group = armenian
						culture_group = east_slavic
						culture_group = indus_group
						culture_group = hindi
						culture_group = aramaic_group
						AND = {
							culture_group = oghuz
							OR = {
								has_country_modifier = title_5
								has_country_modifier = title_6
								tag = ERE
								tag = ERZ
							}
						}
						tag = JAI
					}
					OR = {
						has_discovered = 3843
						has_discovered = 436
						has_discovered = 457
					}
				}
				add_mutual_opinion_modifier_effect = {
					scope_country = TIM
					opinion_modifier = Timur_Opinion
				}
				
			}
			KTD = {
				if = {
					limit = {
						exists = yes
					}
					every_owned_province = {
						add_core = TIM
					}
				}
			}
		}
		Effect_set_capital = { target=454 }
		add_ruler_modifier = { name = Timur_Rise duration = -1 }
		add_horde_unity = 80
		add_prestige = 30
		Stab_Add3 = yes
		add_manpower = 20
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=35}
		hidden_effect = {
			add_country_modifier = { name = Timur_Mustering duration = 3650 hidden = yes }
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=BU Amount=-30 }
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=15 }
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=BG Amount=10 }
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=CL Amount=10 }
			if = {
				limit = {
					ai = yes
				}
				add_treasury = 1000
				set_key = { lhs = Tax_CostAdmInp value = 0.35 }
				set_key = { lhs = Tax_CostDipInp value = 0.35 }
				set_key = { lhs = Tax_CostMilInp value = 0.35 }
				add_mil_tech = 1
				country_event = {
					id = AI_Tax.002
				}
				every_subject_country = {
					limit = {
						OR = {
							is_subject_of_type = tributary_state
							is_subject_of_type = close_tributary_state
						}
					}
					grant_independence = yes
				}
			}
		}
		country_event = { id = timur.38 days = 30 }
	}
	after = {
		if = {
			limit = {
				NOT = { is_year = 1410 }
				NOT = { dynasty = "Timurid" }
			}
			clr_country_flag = Timur_Dead
			clr_country_flag = Timur_Dying
			remove_country_modifier = genghis_khanate
			add_country_modifier = {
				name = puppet_khanate
				duration = -1
			}
			Timur_Spawn = yes
			define_ruler_to_general = {
				fire = 6
				shock = 6
				manuever = 6
				siege = 5
			}
			hidden_effect = {
				add_government_reform = Horde_MonarchyS
			}
		}
		AAA = {
			country_event = { id = timur.20 days = 1 }
		}
		#re-calculate rights priorities calculation
		if = {
			limit = {
				ai = yes
			}
			hidden_effect = {
				set_country_flag = AITax_Yearly # Refire Tax Calculation
			}
		}
	}
}
country_event = {
	id = timur.11
	title = timur.11.t
	desc = timur.11.d
	picture = RELIGION_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		has_country_flag = Horde_Timur
		has_country_modifier = puppet_khanate
	}
	
	mean_time_to_happen = {
		months = 36
		modifier = {
			factor = 0.9
			stability = 3
		}
		modifier = {
			factor = 0.9
			stability = 2
		}
		modifier = {
			factor = 0.9
			stability = 1
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 90
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 80
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 70
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 60
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 50
		}
	}
	
	option = {
		name = "timur.11.a"
		ai_chance = {
			factor = 100
		}
		remove_country_modifier = puppet_khanate
		add_ruler_modifier = { name = timurid_khanate duration = -1 }
		add_manpower = 20
		add_horde_unity = 25
		add_prestige = 50
		Stab_Add1 = yes
		define_consort = {
			name = "Saray"
			dynasty = "Mulk-Khanum"
			culture = mongol
			religion = sunni
			adm = 4
			dip = 6
			mil = 3
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=30 }
	}
	
	option = { # WHHHYYY?
		name = "timur.11.b"
		ai_chance = {
			factor = 0
		}
	}
}
country_event = {
	id = timur.12
	title = timur.12.t
	desc = timur.12.d
	picture = BATTLE_eventPicture
	
	major = yes
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		tag = CHG
		is_free_or_tributary_trigger = yes
		NOT = { has_country_flag = Horde_TimurDead }
		NOT = { has_country_flag = Horde_Timur }
		NOT = { has_ruler = "Timur Barlas" }
		NOT = { Timur_Has = yes }
		NOT = { dynasty = "Timurid" }
	}
	
	option = {
		name = "timur.12.a"
		ai_chance = {
			factor = 100
		}
		set_country_flag = Horde_TimurDead
	}
	
	option = { # The choice is there
		name = "timur.12.b"
		ai_chance = {
			factor = 0
		}
	}
}
country_event = {
	id = timur.13
	title = no_localisation
	desc = no_localisation
	picture = BATTLE_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	option = {
		name = no_localisation
		remove_ruler_personality = just_personality
		remove_ruler_personality = righteous_personality
		remove_ruler_personality = tolerant_personality
		remove_ruler_personality = kind_hearted_personality
		remove_ruler_personality = free_thinker_personality
		remove_ruler_personality = well_connected_personality
		remove_ruler_personality = calm_personality
		remove_ruler_personality = careful_personality
		remove_ruler_personality = secretive_personality
		remove_ruler_personality = intricate_web_weaver_personality
		remove_ruler_personality = fertile_personality
		remove_ruler_personality = well_advised_personality
		remove_ruler_personality = benevolent_personality
		remove_ruler_personality = zealot_personality 
		remove_ruler_personality = pious_personality
		remove_ruler_personality = lawgiver_personality
		remove_ruler_personality = midas_touched_personality
		remove_ruler_personality = incorruptible_personality
		remove_ruler_personality = architectural_visionary_personality
		remove_ruler_personality = scholar_personality
		remove_ruler_personality = entrepreneur_personality
		remove_ruler_personality = industrious_personality
		remove_ruler_personality = expansionist_personality
		remove_ruler_personality = charismatic_negotiator_personality
		remove_ruler_personality = silver_tongue_personality
		remove_ruler_personality = conqueror_personality
		remove_ruler_personality = tactical_genius_personality
		remove_ruler_personality = bold_fighter_personality
		remove_ruler_personality = strict_personality
		remove_ruler_personality = inspiring_leader_personality
		remove_ruler_personality = martial_educator_personality
		remove_ruler_personality = navigator_personality
		remove_ruler_personality = fierce_negotiator_personality
		remove_ruler_personality = babbling_buffoon_personality
		remove_ruler_personality = embezzler_personality
		remove_ruler_personality = infertile_personality
		remove_ruler_personality = drunkard_personality
		remove_ruler_personality = sinner_personality
		remove_ruler_personality = greedy_personality
		remove_ruler_personality = cruel_personality
		remove_ruler_personality = naive_personality
		remove_ruler_personality = craven_personality
		remove_ruler_personality = loose_lips_personality
		remove_ruler_personality = obsessive_perfectionist_personality
		remove_ruler_personality = malevolent_personality
		remove_ruler_personality = fanatical_priest_personality
		remove_ruler_personality = midas_touched_personality
		remove_ruler_personality = master_theologian_personality
		remove_ruler_personality = scholarly_theologian_personality
		remove_ruler_personality = forgiving_personality
		remove_ruler_personality = crafty_merchant_personality
		remove_ruler_personality = generous_personality
		remove_ruler_personality = sceptical_personality
		remove_ruler_personality = energetic_personality
		remove_ruler_personality = wise_personality
		remove_ruler_personality = elusive_shadow_personality
		remove_ruler_personality = grey_eminence_personality
		remove_ruler_personality = gruff_diplomat_personality
		remove_ruler_personality = flamboyant_schemer_personality
		remove_ruler_personality = honest_personality
		remove_ruler_personality = brilliant_strategist_personality
		remove_ruler_personality = martial_cleric_personality
		remove_ruler_personality = tough_soldier_personality
		remove_ruler_personality = valorous_personality
		remove_ruler_personality = temperate_personality
		remove_ruler_personality = pacifist_personality
		remove_ruler_personality = lazy_personality
		remove_ruler_personality = selfish_personality
		remove_ruler_personality = hopeless_spender_personality
		remove_ruler_personality = suspicious_personality
		remove_ruler_personality = indulgent_personality
		remove_ruler_personality = trusting_personality
		remove_ruler_personality = amateurish_pettifogger_personality
		remove_ruler_personality = naive_puppet_master_personality
		remove_ruler_personality = deceitful_personality
		remove_ruler_personality = arbitrary_personality
		remove_ruler_personality = modest_personality
		remove_ruler_personality = proud_personality
		remove_ruler_personality = vengeful_personality
		remove_ruler_personality = aggressive_personality
		remove_ruler_personality = misguided_warrior_personality
		remove_ruler_personality = reckless_personality
		remove_ruler_personality = weak_personality
		remove_ruler_personality = mad_personality
		add_ruler_personality = great_conqueror_personality
		add_ruler_personality = cruel_personality
		add_heir_personality = conqueror_personality
		if = {
			limit = { has_heir = yes }
			kill_heir = {}
		}
	}
}
country_event = {
	id = timur.14
	title = timur.14.t
	desc = timur.14.d
	picture = KING_SICK_IN_BED_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		tag = MGH
		ai = no
		OR = {
			overlord_of = CHG
			overlord_of = TIM
		}
	}
	
	option = {
		name = "timur.14.a"
		if = {
			limit = {
				exists = TIM
			}
			TIM = { grant_independence_effect = yes }
		}
		else = {
			CHG = { grant_independence_effect = yes }
		}
	}
	
	option = {
		name = "timur.14.b"
		if = {
			limit = {
				exists = TIM
			}
			TIM = {
				grant_independence = yes
				if = {
					limit = {
						NOT = { war_with = MGH }
					}
					declare_war_with_cb = { who = MGH casus_belli = cb_independence_war }
				}
			}
		}
		else = {
			CHG = {
				grant_independence = yes
				if = {
					limit = {
						NOT = { war_with = MGH }
					}
					declare_war_with_cb = { who = MGH casus_belli = cb_independence_war }
				}
			}
		}
	}
}
country_event = {
	id = timur.15
	title = no_localisation
	desc = no_localisation
	picture = BATTLE_eventPicture
	
	hidden = yes
	
	trigger = {
		is_year = 1368
		Timur_Has = yes
		has_country_flag = Timur_West
		ai = yes
		is_at_war = no
		any_neighbor_country = {
			Timur_WestConquer = yes
			NOT = { alliance_with = PREV }
			OR = {
				NOT = { truce_with = PREV }
				AND = {
					has_country_flag = Ilkhanate_Successor
					ai = yes
				}
			}
			NOT = { guaranteed_by = PREV }
			NOT = { overlord_of = PREV }
			OR = {
				is_subject = no
				AND = {
					is_free_or_tributary_trigger = yes
					ai = yes
				}
				overlord = { Timur_Has = no }
			}
			OR = {
				has_country_flag = Ilkhanate_Successor
				AND = {
					tag = DLH
					PREV = { NOT = { has_country_flag = TIM_DLH } }
				}
				AND = {
					tag = MGH
					PREV = { NOT = { has_country_flag = TIM_MGH } }
				}
				tag = KRS
				tag = HAZ
			}
			isValidCountry = yes
		}
	}
	
	mean_time_to_happen = {
		months = 12
		modifier = {
			factor = 0.9
			stability = 3
		}
		modifier = {
			factor = 0.9
			stability = 2
		}
		modifier = {
			factor = 0.9
			stability = 1
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 90
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 80
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 70
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 60
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 50
		}
		modifier = {
			factor = 0.9
			prestige = 50
		}
	}
	
	option = {	
		name = no_localisation
		if = {
			limit = {
				exists = CHU
				OR = {
					is_neighbor_of = CHU
					any_subject_country = {
						is_neighbor_of = CHU
					}
				}
				CHU = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			CHU = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = CHU
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = KHI
				OR = {
					is_neighbor_of = KHI
					any_subject_country = {
						is_neighbor_of = KHI
					}
				}
				KHI = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			KHI = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = KHI
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = KHO
				OR = {
					is_neighbor_of = KHO
					any_subject_country = {
						is_neighbor_of = KHO
					}
				}
				KHO = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			KHO = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = KHO
				casus_belli = cb_nomadic_conquest_mil
			}
		}
		else_if = {
			limit = {
				exists = KTD
				OR = {
					is_neighbor_of = KTD
					any_subject_country = {
						is_neighbor_of = KTD
					}
				}
				KTD = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			KTD = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = KTD
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = MGH
				OR = {
					is_neighbor_of = MGH
					any_subject_country = {
						is_neighbor_of = MGH
					}
				}
				NOT = { has_country_flag = TIM_MGH }
				MGH = {
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			MGH = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			set_country_flag = TIM_MGH
			declare_war_with_cb = {
				who = MGH
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = MIH
				OR = {
					is_neighbor_of = MIH
					any_subject_country = {
						is_neighbor_of = MIH
					}
				}
				MIH = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			MIH = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = MIH
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = JQB
				OR = {
					is_neighbor_of = JQB
					any_subject_country = {
						is_neighbor_of = JQB
					}
				}
				JQB = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			JQB = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = JQB
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = ATB
				OR = {
					is_neighbor_of = ATB
					any_subject_country = {
						is_neighbor_of = ATB
					}
				}
				ATB = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			ATB = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = ATB
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = MZA
				OR = {
					is_neighbor_of = MZA
					any_subject_country = {
						is_neighbor_of = MZA
					}
				}
				MZA = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			MZA = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = MZA
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = MUZ
				OR = {
					is_neighbor_of = MUZ
					any_subject_country = {
						is_neighbor_of = MUZ
					}
				}
				MUZ = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			MUZ = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = MUZ
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = JAI
				OR = {
					is_neighbor_of = JAI
					any_subject_country = {
						is_neighbor_of = JAI
					}
				}
				JAI = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			JAI = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = JAI
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = KRS
				OR = {
					is_neighbor_of = KRS
					any_subject_country = {
						is_neighbor_of = KRS
					}
				}
				KRS = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			KRS = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = KRS
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = HAZ
				OR = {
					is_neighbor_of = HAZ
					any_subject_country = {
						is_neighbor_of = HAZ
					}
				}
				HAZ = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			HAZ = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = HAZ
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = TEH
				OR = {
					is_neighbor_of = TEH
					any_subject_country = {
						is_neighbor_of = TEH
					}
				}
				TEH = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			TEH = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = TEH
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = TAB
				OR = {
					is_neighbor_of = TAB
					any_subject_country = {
						is_neighbor_of = TAB
					}
				}
				TAB = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			TAB = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = TAB
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = ISF
				OR = {
					is_neighbor_of = ISF
					any_subject_country = {
						is_neighbor_of = ISF
					}
				}
				ISF = {
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			ISF = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = ISF
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = DLH
				OR = {
					is_neighbor_of = DLH
					any_subject_country = {
						is_neighbor_of = DLH
					}
				}
				NOT = { has_country_flag = TIM_DLH }
				DLH = {
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			DLH = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			set_country_flag = TIM_DLH
			declare_war_with_cb = {
				who = DLH
				casus_belli = cb_nomadic_tribute
			}
		}
		else = {
			random_neighbor_country = {
				limit = {
					Timur_WestConquer = yes
					NOT = { alliance_with = PREV }
					OR = {
						NOT = { truce_with = PREV }
						AND = {
							has_country_flag = Ilkhanate_Successor
							ai = yes
						}
					}
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					OR = {
						has_country_flag = Ilkhanate_Successor
						AND = {
							tag = DLH
							PREV = { NOT = { has_country_flag = TIM_DLH } }
						}
						AND = {
							tag = MGH
							PREV = { NOT = { has_country_flag = TIM_MGH } }
						}
						tag = KRS
						tag = HAZ
					}
					isValidCountry = yes
				}
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
				PREV = {
					declare_war_with_cb = {
						who = PREV
						casus_belli = cb_nomadic_conquest_mil
					}
				}
			}
		}
	}
}
country_event = {
	id = timur.16
	title = timur.16.t
	desc = timur.16.d
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	major = yes
	
	immediate = {
	}
	
	option = {
		name = "timur.16.a"
		define_ruler = {
			name = "Shah Rukh"
			dynasty = "Timurid"
			culture = turco_mongol
			religion = sunni
			age = 25
			male = yes
			adm = 4
			dip = 3
			mil = 5
			claim = 95
		}
		define_ruler_to_general = {
			fire = 2
			shock = 4
			manuever = 3
			siege = 1
		}
		clear_scripted_personalities = yes
		add_ruler_personality = scholar_personality
		add_ruler_personality = architectural_visionary_personality
		add_ruler_personality = benevolent_personality
		define_consort = {
			name = "Goharshad"
			age = 35
			dynasty = "Tarkhan"
			culture = persian
			adm = 4
			dip = 5
			mil = 3
		}
		add_ruler_modifier = {
			name = shahrukhs_empire
		}
		country_event = { id = timur.22 days = 90 }
		if = {
			limit = {
				check_key = { lhs = Ruler_SkillScaled value = 15 }
			}
			add_horde_unity = -10
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-15 }
			add_prestige = -20
			Stab_Subtract5 = yes
			add_country_modifier = { name = puppet_khanate duration = -1 }
			hidden_effect = {
				every_owned_province = {
					limit = {
						OR = {
							NOT = { province_group = steppes_group }
							AND = {
								NOT = { continent = central_asia }
								NOT = { region = crimea_region }
							}
						}
						NOT = { region = iran_region }
						NOT = { region = sistan_region }
						NOT = { region = khorasani_region }
						NOT = { region = fars_region }
						NOT = { region = hindusthan_region }
						NOT = { region = punjab_region }
						NOT = { region = upper_doab_region }
						NOT = { region = lower_mesopotamia_region }
						NOT = { region = upper_mesopotamia_region }
						NOT = { region = south_caucasus_region }
						NOT = { region = west_anatolia_region }
						NOT = { region = north_anatolia_region }
						NOT = { region = south_anatolia_region }
					}
					add_nationalism = 40
				}
			}
			every_subject_country = {
				limit = {
					is_subject_of_type = tributary_state # not close ones
				}
				grant_independence = yes
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 10
				}
				spawn_rebels = {
					leader = "Miran Shah Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 4
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Khalil Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 4
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Pir Muhammad Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 4
					should_take_capital = yes
				}
			}
		}
		else_if = {
			limit = {
				check_key = { lhs = Ruler_SkillScaled value = 12 }
			}
			add_horde_unity = -15
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-15 }
			add_prestige = -20
			Stab_Subtract3 = yes
			add_country_modifier = { name = puppet_khanate duration = -1 }
			hidden_effect = {
				every_owned_province = {
					limit = {
						OR = {
							NOT = { province_group = steppes_group }
							AND = {
								NOT = { continent = central_asia }
								NOT = { region = crimea_region }
							}
						}
						NOT = { region = iran_region }
						NOT = { region = sistan_region }
						NOT = { region = khorasani_region }
						NOT = { region = fars_region }
						NOT = { region = hindusthan_region }
						NOT = { region = punjab_region }
						NOT = { region = upper_doab_region }
						NOT = { region = lower_mesopotamia_region }
						NOT = { region = upper_mesopotamia_region }
						NOT = { region = south_caucasus_region }
						NOT = { region = west_anatolia_region }
						NOT = { region = north_anatolia_region }
						NOT = { region = south_anatolia_region }
					}
					add_nationalism = 30
				}
			}
			every_subject_country = {
				limit = {
					is_subject_of_type = tributary_state # not close ones
				}
				grant_independence = yes
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Sultan Husayn Tayichiud"
					type = pretender_rebels
					culture = mongol
					size = 6
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Miran Shah Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 6
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Khalil Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 6
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Pir Muhammad Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 6
					should_take_capital = yes
				}
			}
		}
		else = {
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-20 }
			add_horde_unity = -25
			add_prestige = -25
			Stab_Subtract4 = yes
			add_country_modifier = { name = puppet_khanate duration = -1 }
			hidden_effect = {
				every_owned_province = {
					limit = {
						OR = {
							NOT = { province_group = steppes_group }
							AND = {
								NOT = { continent = central_asia }
								NOT = { region = crimea_region }
							}
						}
						NOT = { region = iran_region }
						NOT = { region = sistan_region }
						NOT = { region = khorasani_region }
						NOT = { region = fars_region }
						NOT = { region = hindusthan_region }
						NOT = { region = punjab_region }
						NOT = { region = upper_doab_region }
						NOT = { region = lower_mesopotamia_region }
						NOT = { region = upper_mesopotamia_region }
						NOT = { region = south_caucasus_region }
						NOT = { region = west_anatolia_region }
						NOT = { region = north_anatolia_region }
						NOT = { region = south_anatolia_region }
					}
					add_nationalism = 20
				}
			}
			every_subject_country = {
				limit = {
					is_subject_of_type = tributary_state # not close ones
				}
				grant_independence = yes
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Sultan Husayn Tayichiud"
					type = pretender_rebels
					culture = mongol
					size = 8
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Miran Shah Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 8
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Khalil Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 8
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Pir Muhammad Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 8
					should_take_capital = yes
				}
			}
		}
	}
}


country_event = {
	id = timur.17
	title = no_localisation
	desc = no_localisation
	picture = BATTLE_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	trigger = {
		Timur_Has = yes
	}
	
	option = {
		name = no_localisation
		if = {
			limit = {
				is_year = 1400
			}
			set_country_flag = Timur_Dead
			add_government_reform = Horde_Monarchy
			if = {
				limit = {
					ai = yes
				}
				country_event = {
					id = timur.16
					days = 30
				}
			}
			else = {
				country_event = {
					id = timur.16
					days = 60
				}
			}
		}
		else_if = {
			limit = {
				NOT = { has_country_flag = Timur_Dying }
			}
			set_country_flag = Timur_Dying
			Timur_Spawn = yes
			define_ruler_to_general = {
				fire = 6
				shock = 6
				manuever = 6
				siege = 5
			}
			country_event = { id = timur.13 }
			if = {
				limit = {
					NOT = { has_country_modifier = puppet_khanate }
				}
				add_ruler_modifier = { name = timurid_khanate duration = -1 }
			}
			add_ruler_modifier = { name = Timur_Rise duration = -1 }
			clr_country_flag = Timur_Dying
		}
	}
}
country_event = {
	id = timur.18
	title = timur.18.t
	desc = timur.18.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		has_country_flag = Horde_Timur
		OR = {
			check_variable = { which = Cores_on_Ilkhanate_Region value = 40 }
			culture_group = persian_group
			AND = {
				Timur_Has = no
				capital_scope = { superregion = persia_superregion }
			}
		}
		NOT = { has_country_flag = Timur_Persianate }
	}
	
	mean_time_to_happen = {
		months = 48
		modifier = {
			factor = 0.9
			stability = 3
		}
		modifier = {
			factor = 0.9
			stability = 2
		}
		modifier = {
			factor = 0.9
			stability = 1
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 90
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 80
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 70
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 60
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 50
		}
	}
	
	option = {
		name = "timur.18.a"
		ai_chance = {
			factor = 60
			modifier = {
				factor = 2
				has_country_flag = Timur_West
			}
		}
		custom_tooltip = Timur_Persianate
		change_government = monarchy
		hidden_effect = {
			set_country_flag = Timur_Persianate
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=5 }
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=BG Amount=5 }
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=CL Amount=5 }
			change_technology_group = muslim
			Rights_NOGov3Apply = yes
			Rights_NOObl1Apply = yes
			Rights_NOTen3Apply = yes
			Rights_NOSer3Apply = yes
			Rights_BGCom5Apply = yes
			Rights_CLHie2Apply = yes
			Rights_CLTax1Apply = yes
			Rights_CLObl1Apply = yes
			Rights_BUTax2Apply = yes
			Rights_BUInd1Apply = yes
			Rights_BUSer3Apply = yes
			add_government_reform = Pol_Succession5
			if = {
				limit = {
					OR = {
						culture_group = altaic
						culture_group = tartar_group
						culture_group = old_turkic
					}
				}
				add_government_reform = Pol_Family4
			}
			else = {
				add_government_reform = Pol_Family3
			}
			add_government_reform = Pol_Nobility1
			add_government_reform = Pol_Assembly1
			add_government_reform = Pol_Structure4
			add_government_reform = Pol_Centralisation2
			add_government_reform = Pol_Autonomy1
			add_government_reform = Pol_Provincial1
			add_government_reform = Pol_Military1
			every_owned_province = {
				limit = {
					isValidProv = yes
				}
				add_local_autonomy = -10
			}
		}
		if = {
			limit = {
				Timur_Has = yes
			}
			add_government_reform = Horde_MonarchyS
		}
		else = {
			add_government_reform = Horde_Monarchy
		}
		add_horde_unity = 50
	}
	
	option = {
		name = "timur.18.b"
		ai_chance = {
			factor = 40
			modifier = {
				factor = 0.5
				has_country_flag = Timur_East
			}
		}
		hidden_effect = {
			set_country_flag = Timur_Persianate
		}
		add_horde_unity = 25
		Stab_Add1 = yes
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=20 }
	}
	after = {
		add_horde_unity = 25
		#re-calculate rights priorities calculation
		if = {
			limit = {
				ai = yes
			}
			hidden_effect = {
				set_country_flag = AITax_Yearly # Refire Tax Calculation
			}
		}
	}
}
country_event = {
	id = timur.19
	title = no_localisation
	desc = no_localisation
	picture = BATTLE_eventPicture
	
	hidden = yes
	
	trigger = {
		is_year = 1375
		Timur_Has = yes
		has_country_flag = Timur_West
		ai = yes
		is_at_war = no
		NOT = {
			any_known_country = {
				OR = {
					has_country_flag = Ilkhanate_Successor
					AND = {
						tag = DLH
						PREV = { NOT = { has_country_flag = TIM_DLH } }
					}
				}
			}
		}
		any_known_country = {
			Timur_WestConquer = yes
			NOT = { alliance_with = PREV }
			NOT = { truce_with = PREV }
			NOT = { guaranteed_by = PREV }
			NOT = { overlord_of = PREV }
			any_neighbor_country = {
				is_subject = yes
				overlord = { Timur_Has = yes }
			}
			OR = {
				is_subject = no
				overlord = { Timur_Has = no }
			}
			isValidCountry = yes
		}
	}
	
	mean_time_to_happen = {
		months = 6
		modifier = {
			factor = 0.9
			stability = 3
		}
		modifier = {
			factor = 0.9
			stability = 2
		}
		modifier = {
			factor = 0.9
			stability = 1
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 90
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 80
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 70
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 60
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 50
		}
	}
	
	option = {	
		name = no_localisation
		if = {
			limit = {
				any_neighbor_country = {
					Timur_WestConquer = yes
					OR = {
						culture_group = persian_group
						culture_group = georgian_group
						culture_group = alanian_group
					}
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					any_neighbor_country = {
						is_subject = yes
						overlord = { Timur_Has = yes }
					}
					OR = {
						is_subject = no
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			random_known_country = {
				limit = {
					Timur_WestConquer = yes
					OR = {
						culture_group = persian_group
						culture_group = georgian_group
						culture_group = alanian_group
					}
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					any_neighbor_country = {
						is_subject = yes
						overlord = { Timur_Has = yes }
					}
					OR = {
						is_subject = no
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
				PREV = {
					declare_war_with_cb = {
						who = PREV
						casus_belli = cb_nomadic_tribute
					}
				}
			}
		}
		else_if = {
			limit = {
				any_neighbor_country = {
					Timur_WestConquer = yes
					OR = {
						culture_group = armenian
						primary_culture = turkoman
					}
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					any_neighbor_country = {
						is_subject = yes
						overlord = { Timur_Has = yes }
					}
					OR = {
						is_subject = no
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			random_known_country = {
				limit = {
					Timur_WestConquer = yes
					OR = {
						culture_group = armenian
						primary_culture = turkoman
					}
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					any_neighbor_country = {
						is_subject = yes
						overlord = { Timur_Has = yes }
					}
					OR = {
						is_subject = no
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
				PREV = {
					declare_war_with_cb = {
						who = PREV
						casus_belli = cb_nomadic_tribute
					}
				}
			}
		}
		else = {
			random_known_country = {
				limit = {
					Timur_WestConquer = yes
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					any_neighbor_country = {
						is_subject = yes
						overlord = { Timur_Has = yes }
					}
					OR = {
						is_subject = no
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
				PREV = {
					declare_war_with_cb = {
						who = PREV
						casus_belli = cb_nomadic_tribute
					}
				}
			}
		}
	}
}
#ongoing timurid/ilkhanate cleanup
country_event = {
	id = timur.20
	title = no_localisation
	desc = no_localisation
	picture = BATTLE_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		tag = AAA
		any_country = {
			exists = yes
			Timur_Has = yes
		}
	}
	option = {
		name = no_localisation
		random_country = {
			limit = {
				exists = yes
				Timur_Has = yes
			}
			if = {
				limit = {
					ai = yes
				}
				every_subject_country = {
					limit = {
						isValidCountry = yes
						Timur_WestConquer = yes
						is_subject_other_than_tributary_trigger = yes
						ai = yes
						NOT = { culture_group = indus_group }
						NOT = { tag = DLH }
					}
					PREV = { inherit = PREV }
				}
			}
			if = {
				limit = {
					Timur_Has = yes
					is_year = 1400
				}
				if = {
					limit = {
						is_year = 1420
					}
					random_list = {
						50 = {
							country_event = {
								id = timur.17
								days = 1
							}
						}
						50 = {
						}
					}
				}
				if = {
					limit = {
						is_year = 1410
					}
					random_list = {
						25 = {
							country_event = {
								id = timur.17
								days = 1
							}
						}
						75 = {
						}
					}
				}
				else = {
					random_list = {
						15 = {
							country_event = {
								id = timur.17
								days = 1
							}
						}
						85 = {
						}
					}
				}
			}
			save_event_target_as = Timur
			if = {
				limit = {
					has_country_flag = Timur_West
				}
				every_neighbor_country = {
					limit = {
						isValidCountry = yes
						OR = {
							# Persianates
							has_country_flag = Ilkhanate_Successor
							tag = SHI
							tag = KRS
							tag = HAZ
							# Tribes
							tag = QAR
							tag = AKK
							tag = KHO
						}
					}
					every_owned_province = {
						limit = {
							isValidProv = yes
						}
						add_core = event_target:Timur
					}
				}
			}
		}
		Timur_CleanupScript = yes
	}
}

#### Occupation, surrender ####
country_event = {
	id = timur.21
	title = timur.21.t
	desc = timur.21.d
	picture = SIEGE_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		TIM = {
			Timur_Has = yes
			ai = yes
			war_with = ROOT
			isValidCountry = yes
		}
		NOT = { is_year = 1420 } # performance
		NOT = { has_country_flag = Timur_Surrender }
		Timur_WestConquer = yes
		NOT = { tag = ORM }
		NOT = { tag = MGH }
		is_at_war = yes
		OR = {
			capital_scope = { controlled_by = TIM }
			TIM = {
				Timur_Has = yes
				war_score_against = {
					who = ROOT
					value = 80
				}
			}
		}
	}
	immediate = {
		hidden_effect = {
			set_key = { lhs = Anatolian_PowerTmp which = Dev_Total }
			multiply_key = { lhs = Anatolian_PowerTmp value = 0.05 }
		}
	}
	
	option = { #Surrender
		name = timur.21.a
		ai_chance = {
			factor = 100
		}
		if = {
			limit = {
				OR = {
					ai = no
					tag = DLH
					culture_group = indus_group
				}
			}
			random_country = {
				limit = {
					exists = yes
					Timur_Has = yes
				}
				white_peace = ROOT
				ROOT = {
					if = {
						limit = {
							is_subject = yes
						}
						grant_independence = yes
					}
				}
				create_subject = {
					subject_type = decentralized_vassal
					who = ROOT
				}
			}
		}
		else = {
			hidden_effect = {
				set_country_flag = Timur_Surrender
			}
			random_country = {
				limit = {
					exists = yes
					Timur_Has = yes
				}
				save_event_target_as = Timur
				PREV = {
					every_subject_country = {
						limit = {
							isValidCountry = yes
						}
						every_owned_province = {
							limit = {
								controlled_by = event_target:Timur
							}
							cede_province = event_target:Timur
						}
					}
				}
				hidden_effect = {
					white_peace = ROOT
				}
				every_province = {
					limit = {
						owned_by = ROOT
					}
					cede_province = PREV
				}
			}
		}
	}
	
	option = { #Fight on - player only
		name = timur.21.b
		ai_chance = {
			factor = 0
		}
	}
	after = {
		set_country_flag = Timur_Surrender
		random_country = {
			limit = {
				exists = yes
				Timur_Has = yes
			}
			add_war_exhaustion = -1
			save_event_target_as = Timur
			every_neighbor_country = {
				limit = {
					Timur_WestConquer = yes
					isValidCountry = yes
				}
				set_key = { lhs = Anatolian_PowerTmp which = ROOT }
				POP_AddAE = { scope=PREV var=Anatolian_PowerTmp }
				set_key = { lhs = Anatolian_PowerTmp value = 0 }
			}
			every_neighbor_country = {
				limit = {
					isValidCountry = yes
					has_country_flag = Ilkhanate_Successor
				}
				every_owned_province = {
					limit = {
						isValidProv = yes
					}
					add_core = event_target:Timur
				}
			}
		}
		AAA = {
			country_event = { id = timur.20 days = 1 }
		}
		set_key = { lhs = Anatolian_PowerTmp value = 0 }
	}
}

# Timur successor, where to focus
country_event = {
	id = timur.22
	title = timur.22.t
	desc = timur.22.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = timur.22.a
		trigger = {
			any_owned_province = {
				OR = {
					area = herat_area
					area = zahedan_area
					area = sistan_area
					area = baluchi_area
					area = quetta_area
				}
			}
			NOT = { has_country_flag = China_ClaimForeign }
			is_emperor_of_china = no
		}
		ai_chance = {
			factor = 0.50
		}
		set_country_flag = Timur_Herat
		if = {
			limit = {
				owns = 447
			}
			Effect_set_capital={ target=447 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.59 days = 4 }
			country_event = { id = timur.24 days = 8 }
			country_event = { id = timur.25 days = 15 }
			country_event = { id = timur.33 days = 27 }
			country_event = { id = timur.26 days = 40 }
			country_event = { id = timur.32 days = 51 }
			country_event = { id = timur.27 days = 60 }
			country_event = { id = timur.28 days = 71 }
			country_event = { id = timur.30 days = 80 }
			country_event = { id = timur.31 days = 89 }
			country_event = { id = timur.29 days = 100 }
		}
	}
	option = {
		name = timur.22.b
		trigger = {
			any_owned_province = {
				OR = {
					area = kish_area
					area = balkh_area
					area = kabulistan_area
				}
			}
			NOT = { has_country_flag = China_ClaimForeign }
			is_emperor_of_china = no
		}
		set_country_flag = Timur_Balkh
		ai_chance = {
			factor = 0.15
		}
		if = {
			limit = {
				owns = 3843
			}
			Effect_set_capital={ target=3843 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.59 days = 4 }
			country_event = { id = timur.24 days = 8 }
			country_event = { id = timur.25 days = 15 }
			country_event = { id = timur.33 days = 27 }
			country_event = { id = timur.26 days = 40 }
			country_event = { id = timur.27 days = 51 }
			country_event = { id = timur.28 days = 60 }
			country_event = { id = timur.32 days = 71 }
			country_event = { id = timur.31 days = 80 }
			country_event = { id = timur.29 days = 89 }
			country_event = { id = timur.30 days = 100 }
		}
	}
	option = {
		name = timur.22.c
		trigger = {
			NOT = { has_country_flag = China_ClaimForeign }
			is_emperor_of_china = no
		}
		ai_chance = {
			factor = 0.05
		}
		set_country_flag = Timur_Khorasan
		if = {
			limit = {
				owns = 4234
			}
			Effect_set_capital={ target=4234 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.59 days = 4 }
			country_event = { id = timur.24 days = 8 }
			country_event = { id = timur.25 days = 15 }
			country_event = { id = timur.33 days = 27 }
			country_event = { id = timur.26 days = 40 }
			country_event = { id = timur.32 days = 51 }
			country_event = { id = timur.30 days = 60 }
			country_event = { id = timur.31 days = 71 }
			country_event = { id = timur.29 days = 80 }
			country_event = { id = timur.27 days = 89 }
			country_event = { id = timur.28 days = 100 }
		}
	}
	option = {
		name = timur.22.d
		trigger = {
			any_owned_province = {
				OR = {
					region = iran_region
					region = fars_region
				}
			}
			NOT = { has_country_flag = China_ClaimForeign }
			is_emperor_of_china = no
		}
		ai_chance = {
			factor = 0.10
		}
		set_country_flag = Timur_Persia
		if = {
			limit = {
				owns = 2225
			}
			Effect_set_capital={ target=2225 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.59 days = 4 }
			country_event = { id = timur.24 days = 8 }
			country_event = { id = timur.25 days = 15 }
			country_event = { id = timur.33 days = 27 }
			country_event = { id = timur.32 days = 40 }
			country_event = { id = timur.30 days = 51 }
			country_event = { id = timur.31 days = 60 }
			country_event = { id = timur.26 days = 71 }
			country_event = { id = timur.29 days = 80 }
			country_event = { id = timur.28 days = 89 }
			country_event = { id = timur.27 days = 100 }
		}
	}
	option = {
		name = timur.22.e
		trigger = {
			any_owned_province = {
				region = amodarya_region
				NOT = { area = balkh_area }
				NOT = { area = vaxsh_area }
			}
			NOT = { has_country_flag = China_ClaimForeign }
			is_emperor_of_china = no
		}
		ai_chance = {
			factor = 0.10
			modifier = {
				factor = 100
				has_country_flag = Timur_Deposed
			}
		}
		set_country_flag = Timur_Samarkand
		if = {
			limit = {
				owns = 457
			}
			Effect_set_capital={ target=457 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.24 days = 4 }
			country_event = { id = timur.59 days = 8 }
			country_event = { id = timur.25 days = 15 }
			country_event = { id = timur.26 days = 27 }
			country_event = { id = timur.32 days = 40 }
			country_event = { id = timur.27 days = 51 }
			country_event = { id = timur.28 days = 60 }
			country_event = { id = timur.29 days = 71 }
			country_event = { id = timur.30 days = 80 }
			country_event = { id = timur.33 days = 89 }
			country_event = { id = timur.31 days = 100 }
		}
	}
	option = {
		name = timur.22.f
		trigger = {
			any_owned_province = {
				OR = {
					area = aleppo_area
					area = diyar_rabia_area
					area = diyar_mudar_area
					area = larestan_area
					region = lower_mesopotamia_region
				}
			}
			NOT = { has_country_flag = China_ClaimForeign }
			is_emperor_of_china = no
		}
		ai_chance = {
			factor = 0.05
		}
		set_country_flag = Timur_Iraq
		if = {
			limit = {
				owns = 410
			}
			Effect_set_capital={ target=410 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.59 days = 4 }
			country_event = { id = timur.32 days = 8 }
			country_event = { id = timur.30 days = 15 }
			country_event = { id = timur.31 days = 27 }
			country_event = { id = timur.29 days = 40 }
			country_event = { id = timur.33 days = 51 }
			country_event = { id = timur.28 days = 60 }
			country_event = { id = timur.24 days = 71 }
			country_event = { id = timur.27 days = 80 }
			country_event = { id = timur.25 days = 89 }
			country_event = { id = timur.26 days = 100 }
		}
	}
	option = {
		name = timur.22.g
		trigger = {
			any_owned_province = {
				OR = {
					region = upper_doab_region
					region = punjab_region
					region = hindusthan_region
					region = kashmir_region
				}
			}
			NOT = { has_country_flag = China_ClaimForeign }
			is_emperor_of_china = no
		}
		ai_chance = {
			factor = 0.03
		}
		set_country_flag = Timur_Indus
		if = {
			limit = {
				owns = 2112
			}
			Effect_set_capital={ target=2112 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.59 days = 4 }
			country_event = { id = timur.24 days = 8 }
			country_event = { id = timur.25 days = 15 }
			country_event = { id = timur.33 days = 27 }
			country_event = { id = timur.26 days = 40 }
			country_event = { id = timur.27 days = 51 }
			country_event = { id = timur.28 days = 60 }
			country_event = { id = timur.31 days = 71 }
			country_event = { id = timur.29 days = 80 }
			country_event = { id = timur.30 days = 89 }
			country_event = { id = timur.32 days = 100 }
		}
	}
	option = {
		name = timur.22.h
		trigger = {
			any_owned_province = {
				OR = {
					region = upper_mesopotamia_region
					region = south_caucasus_region
				}
				NOT = { area = aleppo_area }
				NOT = { area = diyar_rabia_area }
				NOT = { area = diyar_mudar_area }
			}
			NOT = { has_country_flag = China_ClaimForeign }
			is_emperor_of_china = no
		}
		ai_chance = {
			factor = 0.02
		}
		set_country_flag = Timur_Armenia
		if = {
			limit = {
				owns = 2551
			}
			Effect_set_capital={ target=2551 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.59 days = 4 }
			country_event = { id = timur.32 days = 8 }
			country_event = { id = timur.30 days = 15 }
			country_event = { id = timur.31 days = 27 }
			country_event = { id = timur.29 days = 40 }
			country_event = { id = timur.28 days = 51 }
			country_event = { id = timur.27 days = 60 }
			country_event = { id = timur.33 days = 71 }
			country_event = { id = timur.26 days = 80 }
			country_event = { id = timur.24 days = 89 }
			country_event = { id = timur.25 days = 100 }
		}
	}
	option = {
		name = timur.22.i
		trigger = {
			any_owned_province = {
				OR = {
					region = greece_region
					region = west_anatolia_region
					region = north_anatolia_region
					region = south_anatolia_region
				}
			}
			NOT = { has_country_flag = China_ClaimForeign }
			is_emperor_of_china = no
		}
		ai_chance = {
			factor = 0
		}
		set_country_flag = Timur_Anatolia
		if = {
			limit = {
				owns = 2664
			}
			Effect_set_capital={ target=2664 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.59 days = 4 }
			country_event = { id = timur.32 days = 8 }
			country_event = { id = timur.30 days = 15 }
			country_event = { id = timur.31 days = 27 }
			country_event = { id = timur.29 days = 40 }
			country_event = { id = timur.28 days = 51 }
			country_event = { id = timur.27 days = 60 }
			country_event = { id = timur.26 days = 71 }
			country_event = { id = timur.33 days = 80 }
			country_event = { id = timur.25 days = 89 }
			country_event = { id = timur.24 days = 100 }
		}
	}
	option = {
		name = timur.22.j
		trigger = {
			any_owned_province = {
				province_group = steppes_group
				NOT = { region = north_caucasus_region }
				NOT = { region = south_caucasus_region }
				NOT = { region = amodarya_region }
				NOT = { region = syrdarya_region }
				NOT = { region = khorasani_region }
				NOT = { region = sistan_region }
				NOT = { region = kashmir_region }
				NOT = { region = iran_region }
				NOT = { region = fars_region }
			}
			NOT = { has_country_flag = China_ClaimForeign }
			is_emperor_of_china = no
		}
		ai_chance = {
			factor = 0
		}
		set_country_flag = Timur_Sarai
		if = {
			limit = {
				owns = 1310
			}
			Effect_set_capital={ target=1310 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.59 days = 4 }
			country_event = { id = timur.32 days = 8 }
			country_event = { id = timur.30 days = 15 }
			country_event = { id = timur.29 days = 27 }
			country_event = { id = timur.28 days = 40 }
			country_event = { id = timur.27 days = 51 }
			country_event = { id = timur.26 days = 60 }
			country_event = { id = timur.31 days = 71 }
			country_event = { id = timur.24 days = 80 }
			country_event = { id = timur.25 days = 89 }
			country_event = { id = timur.33 days = 100 }
		}
	}
	option = {
		name = timur.22.k
		trigger = {
			any_owned_province = {
				OR = {
					region = outer_mongolia_region
					region = inner_mongolia_region
					region = east_manchuria_region
					region = west_manchuria_region
					liaoning_trigger = yes
					province_id = 2743
					province_id = 3213
					province_id = 2273
					province_id = 3276
					province_id = 4195
					province_id = 1067
				}
			}
			NOT = { has_country_flag = China_ClaimForeign }
			is_emperor_of_china = no
		}
		ai_chance = {
			factor = 0
		}
		set_country_flag = Timur_Mongolia
		if = {
			limit = {
				owns = 3273
			}
			Effect_set_capital={ target=3273 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.24 days = 4 }
			country_event = { id = timur.25 days = 15 }
			country_event = { id = timur.26 days = 27 }
			country_event = { id = timur.32 days = 40 }
			country_event = { id = timur.27 days = 51 }
			country_event = { id = timur.28 days = 60 }
			country_event = { id = timur.29 days = 71 }
			country_event = { id = timur.30 days = 80 }
			country_event = { id = timur.33 days = 89 }
			country_event = { id = timur.31 days = 100 }
			country_event = { id = timur.59 days = 111 }
		}
	}
	option = {
		name = timur.22.l
		trigger = {
			OR = {
				has_country_flag = InMiddleKingdom
				has_country_flag = China_ClaimForeign
				is_emperor_of_china = yes
			}
		}
		ai_chance = {
			factor = 0.1
		}
		set_country_flag = Timur_China
		if = {
			limit = {
				owns = 708
			}
			Effect_set_capital={ target=708 }
		}
		else_if = {
			limit = {
				owns = 701
			}
			Effect_set_capital={ target=701 }
		}
		else_if = {
			limit = {
				owns = 2252
			}
			Effect_set_capital={ target=2252 }
		}
		else_if = {
			limit = {
				owns = 2257
			}
			Effect_set_capital={ target=2257 }
		}
		hidden_effect = {
			if = { limit = { any_owned_province = { continent = asia } } country_event = { id = timur.60 days = 1 } }
			country_event = { id = timur.24 days = 4 }
			country_event = { id = timur.25 days = 15 }
			country_event = { id = timur.26 days = 27 }
			country_event = { id = timur.32 days = 40 }
			country_event = { id = timur.27 days = 51 }
			country_event = { id = timur.28 days = 60 }
			country_event = { id = timur.29 days = 71 }
			country_event = { id = timur.30 days = 80 }
			country_event = { id = timur.33 days = 89 }
			country_event = { id = timur.31 days = 100 }
			country_event = { id = timur.59 days = 111 }
		}
	}
}

#### Occupation, surrender ####
country_event = {
	id = timur.23
	title = timur.23.t
	desc = timur.23.d
	picture = SIEGE_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = Ilkhanate_Successor
		ai = yes
		NOT = { has_country_flag = Horde_Timur }
		NOT = { has_country_flag = Ilkhanate_Surrender }
		any_known_country = {
			has_country_flag = Ilkhanate_Successor
			NOT = { has_country_flag = Horde_Timur }
			isValidCountry = yes
			war_with = ROOT
			war_score_against = {
				who = ROOT
				value = 80
			}
		}
	}
	
	option = { #Surrender
		name = timur.23.a
		ai_chance = {
			factor = 100
		}
		hidden_effect = {
			set_country_flag = Ilkhanate_Surrender
		}
		random_country = {
			limit = {
				has_country_flag = Ilkhanate_Successor
				NOT = { has_country_flag = Horde_Timur }
				isValidCountry = yes
				war_with = ROOT
				war_score_against = {
					who = ROOT
					value = 80
				}
			}
			hidden_effect = {
				white_peace = ROOT
			}
			every_province = {
				limit = {
					owned_by = ROOT
				}
				add_core = PREV
				cede_province = PREV
			}
		}
	}
	
	option = { #Fight on - player only
		name = timur.23.b
		ai_chance = {
			factor = 0
		}
	}
	after = {
		set_country_flag = Ilkhanate_Surrender
	}
}
# Timurid Anatolia, post-Timur
country_event = {
	id = timur.24
	title = timur.24.t
	desc = timur.24.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Centralise
	option = {
		name = timur_centralise
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 8
				has_country_flag = Timur_Anatolia
			}
		}
		if = {
			limit = {
				has_country_flag = Timur_Anatolia
			}
			Timur_AnatoliaCentralise = { nationalism = 5 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Armenia
					has_country_flag = Timur_Iraq
				}
			}
			Timur_AnatoliaCentralise = { nationalism = 20 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Persia
					has_country_flag = Timur_Sarai
				}
			}
			Timur_AnatoliaCentralise = { nationalism = 35 }
		}
		else = {
			Timur_AnatoliaCentralise = { nationalism = 50 }
		}
	}
	# Decentralise
	option = {
		name = timur_decentralise
		ai_chance = {
			factor = 0.80
			modifier = {
				factor = 2
				OR = {
					has_country_flag = Timur_Armenia
					has_country_flag = Timur_Anatolia
					has_country_flag = Timur_Iraq
					has_country_flag = Timur_Persia
					has_country_flag = Timur_Sarai
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = Timur_Anatolia }
			}
			if = {
				limit = {
					has_country_flag = Timur_Armenia
				}
				Timur_AnatoliaVassalise = { subject_type = decentralized_vassal }
			}
			else_if = {
				limit = {
					has_country_flag = Timur_Iraq
				}
				Timur_AnatoliaVassalise = { subject_type = rebellious_decentralized_vassal }
			}
			else_if = {
				limit = {
					has_country_flag = Timur_Persia
				}
				Timur_AnatoliaVassalise = { subject_type = close_tributary_state }
			}
			else = {
				Timur_AnatoliaVassalise = { subject_type = tributary_state }
			}
		}
		else = {
			Timur_AnatoliaDecentraliseCore = yes
		}
	}
	# Let go
	option = {
		name = timur_release
		ai_chance = {
			factor = 0.10
			modifier = {
				factor = 100
				NOT = { has_country_flag = Timur_Anatolia }
				NOT = { has_country_flag = Timur_Armenia }
				NOT = { has_country_flag = Timur_Iraq }
				NOT = { has_country_flag = Timur_Persia }
				NOT = { has_country_flag = Timur_Sarai }
			}
			modifier = {
				factor = 0
				has_country_flag = Timur_Anatolia
			}
		}
		Timur_AnatoliaRelease = yes
		every_subject_country = {
			limit = {
				capital_scope = {
					OR = {
						region = greece_region
						region = west_anatolia_region
						region = north_anatolia_region
						region = south_anatolia_region
					}
				}
			}
			grant_independence = yes
		}
	}
}
# Timurid Armenia, post-Timur
country_event = {
	id = timur.25
	title = timur.25.t
	desc = timur.25.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Centralise
	option = {
		name = timur_centralise
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				has_country_flag = Timur_Armenia
			}
		}
		if = {
			limit = {
				has_country_flag = Timur_Armenia
			}
			Timur_ArmeniaCentralise = { nationalism = 5 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Anatolia
					has_country_flag = Timur_Iraq
				}
			}
			Timur_ArmeniaCentralise = { nationalism = 20 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Persia
					has_country_flag = Timur_Sarai
				}
			}
			Timur_ArmeniaCentralise = { nationalism = 35 }
		}
		else = {
			Timur_ArmeniaCentralise = { nationalism = 50 }
		}
	}
	# Decentralise
	option = {
		name = timur_decentralise
		ai_chance = {
			factor = 0.90
			modifier = {
				factor = 2
				OR = {
					has_country_flag = Timur_Anatolia
					has_country_flag = Timur_Armenia
					has_country_flag = Timur_Iraq
					has_country_flag = Timur_Persia
					has_country_flag = Timur_Khorasan
					has_country_flag = Timur_Herat
					has_country_flag = Timur_Sarai
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = Timur_Armenia }
			}
			if = {
				limit = {
					OR = {
						has_country_flag = Timur_Anatolia
						has_country_flag = Timur_Iraq
					}
				}
				Timur_ArmeniaVassalise = { subject_type = decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Persia
						has_country_flag = Timur_Khorasan
						has_country_flag = Timur_Sarai
					}
				}
				Timur_ArmeniaVassalise = { subject_type = rebellious_decentralized_vassal }
			}
			else_if = {
				limit = {
					has_country_flag = Timur_Herat
				}
				Timur_ArmeniaVassalise = { subject_type = close_tributary_state }
			}
			else = {
				Timur_ArmeniaVassalise = { subject_type = tributary_state }
			}
		}
		else = {
			Timur_ArmeniaDecentraliseCore = yes
		}
	}
	# Let go
	option = {
		name = timur_release
		ai_chance = {
			factor = 0.10
			modifier = {
				factor = 100
				NOT = { has_country_flag = Timur_Anatolia }
				NOT = { has_country_flag = Timur_Armenia }
				NOT = { has_country_flag = Timur_Iraq }
				NOT = { has_country_flag = Timur_Persia }
				NOT = { has_country_flag = Timur_Khorasan }
				NOT = { has_country_flag = Timur_Herat }
				NOT = { has_country_flag = Timur_Sarai }
			}
			modifier = {
				factor = 0
				has_country_flag = Timur_Armenia
			}
		}
		Timur_ArmeniaRelease = yes
		every_subject_country = {
			limit = {
				capital_scope = {
					OR = {
						region = south_caucasus_region
						region = upper_mesopotamia_region
					}
					NOT = { area = diyar_rabia_area }
					NOT = { area = diyar_mudar_area }
					NOT = { region = syria_region }
				}
			}
			grant_independence = yes
		}
	}
	after = {
		Timur_ArmeniaAfter = yes
	}
}
# Timurid Iraq, post-Timur
country_event = {
	id = timur.26
	title = timur.26.t
	desc = timur.26.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Centralise
	option = {
		name = timur_centralise
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				has_country_flag = Timur_Iraq
			}
		}
		if = {
			limit = {
				has_country_flag = Timur_Iraq
			}
			Timur_IraqCentralise = { nationalism = 5 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Armenia
					has_country_flag = Timur_Persia
				}
			}
			Timur_IraqCentralise = { nationalism = 20 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Anatolia
					has_country_flag = Timur_Khorasan
				}
			}
			Timur_IraqCentralise = { nationalism = 35 }
		}
		else = {
			Timur_IraqCentralise = { nationalism = 50 }
		}
	}
	# Decentralise
	option = {
		name = timur_decentralise
		ai_chance = {
			factor = 0.90
			modifier = {
				factor = 2
				OR = {
					has_country_flag = Timur_Anatolia
					has_country_flag = Timur_Armenia
					has_country_flag = Timur_Persia
					has_country_flag = Timur_Khorasan
					has_country_flag = Timur_Herat
					has_country_flag = Timur_Sarai
					has_country_flag = Timur_Samarkand
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = Timur_Iraq }
			}
			if = {
				limit = {
					OR = {
						has_country_flag = Timur_Armenia
						has_country_flag = Timur_Persia
					}
				}
				Timur_IraqVassalise = { subject_type = decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Anatolia
						has_country_flag = Timur_Khorasan
					}
				}
				Timur_IraqVassalise = { subject_type = rebellious_decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Herat
						has_country_flag = Timur_Sarai
					}
				}
				Timur_IraqVassalise = { subject_type = close_tributary_state }
			}
			else = {
				Timur_IraqVassalise = { subject_type = tributary_state }
			}
		}
		else = {
			Timur_IraqDecentraliseCore = yes
		}
	}
	# Let go
	option = {
		name = timur_release
		ai_chance = {
			factor = 0.10
			modifier = {
				factor = 100
				NOT = { has_country_flag = Timur_Anatolia }
				NOT = { has_country_flag = Timur_Armenia }
				NOT = { has_country_flag = Timur_Iraq }
				NOT = { has_country_flag = Timur_Persia }
				NOT = { has_country_flag = Timur_Khorasan }
				NOT = { has_country_flag = Timur_Herat }
				NOT = { has_country_flag = Timur_Sarai }
				NOT = { has_country_flag = Timur_Samarkand }
			}
			modifier = {
				factor = 0
				has_country_flag = Timur_Iraq
			}
		}
		Timur_IraqRelease = yes
		every_subject_country = {
			limit = {
				capital_scope = {
					OR = {
						region = lower_mesopotamia_region
						area = diyar_rabia_area
						area = diyar_mudar_area
						region = syria_region
					}
				}
			}
			grant_independence = yes
		}
	}
	after = {
		Timur_IraqAfter = yes
	}
}
# Timurid Persia, post-Timur
country_event = {
	id = timur.27
	title = timur.27.t
	desc = timur.27.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Centralise
	option = {
		name = timur_centralise
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				has_country_flag = Timur_Persia
			}
		}
		if = {
			limit = {
				has_country_flag = Timur_Persia
			}
			Timur_PersiaCentralise = { nationalism = 5 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Iraq
					has_country_flag = Timur_Khorasan
				}
			}
			Timur_PersiaCentralise = { nationalism = 20 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Armenia
					has_country_flag = Timur_Herat
				}
			}
			Timur_PersiaCentralise = { nationalism = 35 }
		}
		else = {
			Timur_PersiaCentralise = { nationalism = 50 }
		}
	}
	# Decentralise
	option = {
		name = timur_decentralise
		ai_chance = {
			factor = 2 # everyone makes persia a tributary
			modifier = {
				factor = 0.5
				has_country_flag = Timur_Persia
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = Timur_Persia }
			}
			if = {
				limit = {
					OR = {
						has_country_flag = Timur_Iraq
						has_country_flag = Timur_Khorasan
					}
				}
				Timur_PersiaVassalise = { subject_type = decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Armenia
						has_country_flag = Timur_Herat
					}
				}
				Timur_PersiaVassalise = { subject_type = rebellious_decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Anatolia
						has_country_flag = Timur_Samarkand
						has_country_flag = Timur_Balkh
					}
				}
				Timur_PersiaVassalise = { subject_type = close_tributary_state }
			}
			else = {
				Timur_PersiaVassalise = { subject_type = tributary_state }
			}
		}
		else = {
			Timur_PersiaDecentraliseCore = yes
		}
	}
	# Let go
	option = {
		name = timur_release
		ai_chance = {
			factor = 0
		}
		Timur_PersiaRelease = yes
		every_subject_country = {
			limit = {
				capital_scope = {
					OR = {
						region = iran_region
						region = fars_region
					}
					NOT = { area = east_tabarestan_area }
				}
			}
			grant_independence = yes
		}
	}
	after = {
		Timur_PersiaAfter = yes
	}
}
# Timurid Khorasan, post-Timur
country_event = {
	id = timur.28
	title = timur.28.t
	desc = timur.28.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Centralise
	option = {
		name = timur_centralise
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				has_country_flag = Timur_Khorasan
			}
		}
		if = {
			limit = {
				has_country_flag = Timur_Khorasan
			}
			Timur_KhorasanCentralise = { nationalism = 5 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Persia
					has_country_flag = Timur_Herat
				}
			}
			Timur_KhorasanCentralise = { nationalism = 20 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Iraq
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Balkh
				}
			}
			Timur_KhorasanCentralise = { nationalism = 35 }
		}
		else = {
			Timur_KhorasanCentralise = { nationalism = 50 }
		}
	}
	# Decentralise
	option = {
		name = timur_decentralise
		ai_chance = {
			factor = 0.90
			modifier = {
				factor = 2
				OR = {
					has_country_flag = Timur_Armenia
					has_country_flag = Timur_Iraq
					has_country_flag = Timur_Persia
					has_country_flag = Timur_Herat
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Balkh
					has_country_flag = Timur_Indus
					has_country_flag = Timur_Sarai
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = Timur_Khorasan }
			}
			if = {
				limit = {
					OR = {
						has_country_flag = Timur_Persia
						has_country_flag = Timur_Herat
					}
				}
				Timur_KhorasanVassalise = { subject_type = decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Iraq
						has_country_flag = Timur_Samarkand
						has_country_flag = Timur_Balkh
					}
				}
				Timur_KhorasanVassalise = { subject_type = rebellious_decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Indus
						has_country_flag = Timur_Sarai
					}
				}
				Timur_KhorasanVassalise = { subject_type = close_tributary_state }
			}
			else = {
				Timur_KhorasanVassalise = { subject_type = tributary_state }
			}
		}
		else = {
			Timur_KhorasanDecentraliseCore = yes
		}
	}
	# Let go
	option = {
		name = timur_release
		ai_chance = {
			factor = 0.10
			modifier = {
				factor = 100
				NOT = { has_country_flag = Timur_Khorasan }
				NOT = { has_country_flag = Timur_Armenia }
				NOT = { has_country_flag = Timur_Persia }
				NOT = { has_country_flag = Timur_Herat }
				NOT = { has_country_flag = Timur_Samarkand }
				NOT = { has_country_flag = Timur_Balkh }
				NOT = { has_country_flag = Timur_Indus }
				NOT = { has_country_flag = Timur_Sarai }
			}
			modifier = {
				factor = 0
				has_country_flag = Timur_Khorasan
			}
		}
		Timur_KhorasanRelease = yes
		every_subject_country = {
			limit = {
				capital_scope = {
					OR = {
						area = nishapur_area
						area = ahel_area
						area = herat_area
						area = east_tabarestan_area
					}
				}
			}
			grant_independence = yes
		}
	}
}
# Timurid Herat & Sistan, post-Timur
country_event = {
	id = timur.29
	title = timur.29.t
	desc = timur.29.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Centralise
	option = {
		name = timur_centralise
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				has_country_flag = Timur_Herat
			}
		}
		Timur_Release = { tag = BAL }
		if = {
			limit = {
				has_country_flag = Timur_Herat
			}
			Timur_HeratCentralise = { nationalism = 5 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Khorasan
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Balkh
				}
			}
			Timur_HeratCentralise = { nationalism = 20 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Persia
					has_country_flag = Timur_Indus
				}
			}
			Timur_HeratCentralise = { nationalism = 35 }
		}
		else = {
			Timur_HeratCentralise = { nationalism = 50 }
		}
	}
	# Decentralise
	option = {
		name = timur_decentralise
		ai_chance = {
			factor = 0.90
			modifier = {
				factor = 2
				OR = {
					has_country_flag = Timur_Iraq
					has_country_flag = Timur_Persia
					has_country_flag = Timur_Khorasan
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Balkh
					has_country_flag = Timur_Indus
					has_country_flag = Timur_Sarai
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = Timur_Herat }
			}
			if = {
				limit = {
					OR = {
						has_country_flag = Timur_Khorasan
						has_country_flag = Timur_Samarkand
						has_country_flag = Timur_Balkh
					}
				}
				Timur_HeratVassalise = { subject_type = decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Persia
						has_country_flag = Timur_Indus
					}
				}
				Timur_HeratVassalise = { subject_type = rebellious_decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Iraq
						has_country_flag = Timur_Sarai
					}
				}
				Timur_HeratVassalise = { subject_type = close_tributary_state }
			}
			else = {
				Timur_HeratVassalise = { subject_type = tributary_state }
			}
		}
		else = {
			Timur_HeratDecentraliseCore = yes
		}
		Timur_Release = { tag = BAL }
	}
	# Let go
	option = {
		name = timur_release
		ai_chance = {
			factor = 0.10
			modifier = {
				factor = 100
				NOT = { has_country_flag = Timur_Herat }
				NOT = { has_country_flag = Timur_Iraq }
				NOT = { has_country_flag = Timur_Persia }
				NOT = { has_country_flag = Timur_Khorasan }
				NOT = { has_country_flag = Timur_Samarkand }
				NOT = { has_country_flag = Timur_Balkh }
				NOT = { has_country_flag = Timur_Indus }
				NOT = { has_country_flag = Timur_Sarai }
			}
			modifier = {
				factor = 0
				has_country_flag = Timur_Herat
			}
		}
		Timur_HeratRelease = yes
		every_subject_country = {
			limit = {
				capital_scope = {
					OR = {
						area = herat_area
						area = merv_area
						region = sistan_region
					}
				}
			}
			grant_independence = yes
		}
	}
}
# Timurid Afghanistan & Badakhshan, post-Timur
country_event = {
	id = timur.30
	title = timur.30.t
	desc = timur.30.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Centralise
	option = {
		name = timur_centralise
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				has_country_flag = Timur_Balkh
			}
		}
		if = {
			limit = {
				has_country_flag = Timur_Balkh
			}
			Timur_BalkhCentralise = { nationalism = 5 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Herat
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Indus
				}
			}
			Timur_BalkhCentralise = { nationalism = 20 }
		}
		else_if = {
			limit = {
				has_country_flag = Timur_Khorasan
			}
			Timur_BalkhCentralise = { nationalism = 35 }
		}
		else = {
			Timur_BalkhCentralise = { nationalism = 50 }
		}
	}
	# Decentralise
	option = {
		name = timur_decentralise
		ai_chance = {
			factor = 0.90
			modifier = {
				factor = 2
				OR = {
					has_country_flag = Timur_Persia
					has_country_flag = Timur_Khorasan
					has_country_flag = Timur_Herat
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Balkh
					has_country_flag = Timur_Indus
					has_country_flag = Timur_Sarai
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = Timur_Balkh }
			}
			if = {
				limit = {
					OR = {
						has_country_flag = Timur_Herat
						has_country_flag = Timur_Samarkand
						has_country_flag = Timur_Indus
					}
				}
				Timur_BalkhVassalise = { subject_type = decentralized_vassal }
			}
			else_if = {
				limit = {
					has_country_flag = Timur_Khorasan
				}
				Timur_BalkhVassalise = { subject_type = rebellious_decentralized_vassal }
			}
			else_if = {
				limit = {
					has_country_flag = Timur_Persia
				}
				Timur_BalkhVassalise = { subject_type = close_tributary_state }
			}
			else = {
				Timur_BalkhVassalise = { subject_type = tributary_state }
			}
		}
		else = {
			Timur_BalkhDecentraliseCore = yes
		}
	}
	# Let go
	option = {
		name = timur_release
		ai_chance = {
			factor = 0.10
			modifier = {
				factor = 100
				NOT = { has_country_flag = Timur_Herat }
				NOT = { has_country_flag = Timur_Persia }
				NOT = { has_country_flag = Timur_Khorasan }
				NOT = { has_country_flag = Timur_Samarkand }
				NOT = { has_country_flag = Timur_Balkh }
				NOT = { has_country_flag = Timur_Indus }
				NOT = { has_country_flag = Timur_Sarai }
			}
			modifier = {
				factor = 0
				has_country_flag = Timur_Balkh
			}
		}
		Timur_BalkhRelease = yes
		every_subject_country = {
			limit = {
				capital_scope = {
					OR = {
						area = kabulistan_area
						area = balkh_area
						area = vaxsh_area
					}
				}
			}
			grant_independence = yes
		}
	}
}
# Timurid Central Asia, post-Timur
country_event = {
	id = timur.31
	title = timur.31.t
	desc = timur.31.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Centralise
	option = {
		name = timur_centralise
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				has_country_flag = Timur_Samarkand
			}
		}
		if = {
			limit = {
				has_country_flag = Timur_Samarkand
			}
			Timur_SamarkandCentralise = { nationalism = 5 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Herat
					has_country_flag = Timur_Balkh
					has_country_flag = Timur_Sarai
				}
			}
			Timur_SamarkandCentralise = { nationalism = 20 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Khorasan
					has_country_flag = Timur_Indus
				}
			}
			Timur_SamarkandCentralise = { nationalism = 35 }
		}
		else = {
			Timur_SamarkandCentralise = { nationalism = 50 }
		}
	}
	# Decentralise
	option = {
		name = timur_decentralise
		ai_chance = {
			factor = 0.90
			modifier = {
				factor = 2
				OR = {
					has_country_flag = Timur_Persia
					has_country_flag = Timur_Khorasan
					has_country_flag = Timur_Herat
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Balkh
					has_country_flag = Timur_Indus
					has_country_flag = Timur_Sarai
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = Timur_Samarkand }
			}
			if = {
				limit = {
					OR = {
						has_country_flag = Timur_Herat
						has_country_flag = Timur_Balkh
						has_country_flag = Timur_Sarai
					}
				}
				Timur_SamarkandVassalise = { subject_type = decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Khorasan
						has_country_flag = Timur_Indus
					}
				}
				Timur_SamarkandVassalise = { subject_type = rebellious_decentralized_vassal }
			}
			else_if = {
				limit = {
					has_country_flag = Timur_Persia
				}
				Timur_SamarkandVassalise = { subject_type = close_tributary_state }
			}
			else = {
				Timur_SamarkandVassalise = { subject_type = tributary_state }
			}
		}
		else = {
			Timur_SamarkandDecentraliseCore = yes
		}
	}
	# Let go
	option = {
		name = timur_release
		ai_chance = {
			factor = 0.10
			modifier = {
				factor = 100
				NOT = { has_country_flag = Timur_Herat }
				NOT = { has_country_flag = Timur_Persia }
				NOT = { has_country_flag = Timur_Khorasan }
				NOT = { has_country_flag = Timur_Samarkand }
				NOT = { has_country_flag = Timur_Balkh }
				NOT = { has_country_flag = Timur_Indus }
				NOT = { has_country_flag = Timur_Sarai }
			}
			modifier = {
				factor = 0
				has_country_flag = Timur_Samarkand
			}
		}
		Timur_SamarkandRelease = yes
		every_subject_country = {
			limit = {
				capital_scope = {
					OR = {
						region = syrdarya_region
						region = amodarya_region
					}
					NOT = { area = balkh_area }
					NOT = { area = vaxsh_area }
				}
			}
			grant_independence = yes
		}
	}
}
# Timurid Indus, post-Timur
country_event = {
	id = timur.32
	title = timur.32.t
	desc = timur.32.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Centralise
	option = {
		name = timur_centralise
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				has_country_flag = Timur_Indus
			}
		}
		if = {
			limit = {
				has_country_flag = Timur_Indus
			}
			Timur_IndusCentralise = { nationalism = 5 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Herat
					has_country_flag = Timur_Balkh
				}
			}
			Timur_IndusCentralise = { nationalism = 20 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Khorasan
				}
			}
			Timur_IndusCentralise = { nationalism = 35 }
		}
		else = {
			Timur_IndusCentralise = { nationalism = 50 }
		}
	}
	# Decentralise
	option = {
		name = timur_decentralise
		ai_chance = {
			factor = 0.90
			modifier = {
				factor = 2
				OR = {
					has_country_flag = Timur_Khorasan
					has_country_flag = Timur_Herat
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Balkh
					has_country_flag = Timur_Indus
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = Timur_Indus }
			}
			if = {
				limit = {
					has_country_flag = Timur_Balkh
				}
				Timur_IndusVassalise = { subject_type = rebellious_decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Samarkand
						has_country_flag = Timur_Herat
						has_country_flag = Timur_Khorasan
					}
				}
				Timur_IndusVassalise = { subject_type = close_tributary_state }
			}
			else = {
				Timur_IndusVassalise = { subject_type = tributary_state }
			}
		}
		else = {
			Timur_IndusDecentraliseCore = yes
		}
	}
	# Let go
	option = {
		name = timur_release
		ai_chance = {
			factor = 0.10
			modifier = {
				factor = 100
				NOT = { has_country_flag = Timur_Herat }
				NOT = { has_country_flag = Timur_Khorasan }
				NOT = { has_country_flag = Timur_Samarkand }
				NOT = { has_country_flag = Timur_Balkh }
				NOT = { has_country_flag = Timur_Indus }
			}
			modifier = {
				factor = 0
				has_country_flag = Timur_Indus
			}
		}
		Timur_IndusRelease = yes
		every_subject_country = {
			limit = {
				capital_scope = {
					OR = {
						region = hindusthan_region
						region = punjab_region
						region = upper_doab_region
						region = kashmir_region
					}
				}
			}
			grant_independence = yes
		}
	}
}
# Timurid Steppe, post-Timur
country_event = {
	id = timur.33
	title = timur.33.t
	desc = timur.33.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Centralise
	option = {
		name = timur_centralise
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				has_country_flag = Timur_Sarai
			}
		}
		if = {
			limit = {
				has_country_flag = Timur_Sarai
			}
			Timur_SaraiCentralise = { nationalism = 5 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Herat
					has_country_flag = Timur_Balkh
				}
			}
			Timur_SaraiCentralise = { nationalism = 20 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Khorasan
				}
			}
			Timur_SaraiCentralise = { nationalism = 35 }
		}
		else = {
			Timur_SaraiCentralise = { nationalism = 50 }
		}
	}
	# Decentralise
	option = {
		name = timur_decentralise
		ai_chance = {
			factor = 0.90
			modifier = {
				factor = 2
				OR = {
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Armenia
					has_country_flag = Timur_Anatolia
					has_country_flag = Timur_Balkh
					has_country_flag = Timur_Khorasan
					has_country_flag = Timur_Sarai
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = Timur_Sarai }
			}
			if = {
				limit = {
					OR = {
						has_country_flag = Timur_Samarkand
						has_country_flag = Timur_Armenia
					}
				}
				Timur_SaraiVassalise = { subject_type = decentralized_vassal }
			}
			else_if = {
				limit = {
					has_country_flag = Timur_Khorasan
				}
				Timur_SaraiVassalise = { subject_type = rebellious_decentralized_vassal }
			}
			else_if = {
				limit = {
					has_country_flag = Timur_Anatolia
				}
				Timur_SaraiVassalise = { subject_type = close_tributary_state }
			}
			else = {
				Timur_SaraiVassalise = { subject_type = tributary_state }
			}
		}
		else = {
			Timur_SaraiDecentraliseCore = yes
		}
	}
	# Let go
	option = {
		name = timur_release
		ai_chance = {
			factor = 0.10
			modifier = {
				factor = 100
				NOT = { has_country_flag = Timur_Samarkand }
				NOT = { has_country_flag = Timur_Armenia }
				NOT = { has_country_flag = Timur_Anatolia }
				NOT = { has_country_flag = Timur_Khorasan }
				NOT = { has_country_flag = Timur_Balkh }
				NOT = { has_country_flag = Timur_Sarai }
			}
			modifier = {
				factor = 0
				has_country_flag = Timur_Sarai
			}
		}
		Timur_SaraiRelease = yes
		every_subject_country = {
			limit = {
				capital_scope = {
					province_group = steppes_group
					NOT = { region = south_caucasus_region }
					NOT = { region = syrdarya_region }
					NOT = { region = amodarya_region }
					NOT = { region = khorasani_region }
					NOT = { region = sistan_region }
					NOT = { region = kashmir_region }
					NOT = { region = iran_region }
					NOT = { region = fars_region }
					NOT = { continent = asia }
				}
			}
			grant_independence = yes
		}
	}
}
country_event = {
	id = timur.34
	title = timur.34.t
	desc = timur.34.d
	picture = BATTLE_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = KHI
		is_year = 1361
		exists = yes
		exists = CHG
		CHG = {
			Timur_Has = no
			has_disaster = Horde_Collapse
		}
		OR = {
			442 = { NOT = { owned_by = PREV } }
			3278 = { NOT = { owned_by = PREV } }
			3279 = { NOT = { owned_by = PREV } }
			440 = { NOT = { owned_by = PREV } }
		}
	}
	
	mean_time_to_happen = {
		months = 2
	}
	
	option = {
		name = "timur.34.a"
		ai_chance = {
			factor = 90
		}
		add_prestige = 50
		442 = {
			if = {
				limit = {
					NOT = { owned_by = PREV }
				}
				cede_province = PREV
			}
		}
		3278 = {
			if = {
				limit = {
					NOT = { owned_by = PREV }
				}
				cede_province = PREV
			}
		}
		3279 = {
			if = {
				limit = {
					NOT = { owned_by = PREV }
				}
				cede_province = PREV
			}
		}
		440 = {
			if = {
				limit = {
					NOT = { owned_by = PREV }
				}
				cede_province = PREV
			}
		}
		Effect_set_capital = { target=442 }
		CHG = { country_event = { id = timur.35 } }
	}
	option = {
		name = "timur.34.b"
		ai_chance = {
			factor = 10
		}
		add_prestige = -25
	}
	after = {
		hidden_effect = { white_peace = CHG }
	}
}
country_event = {
	id = timur.35
	title = timur.35.t
	desc = timur.35.d
	picture = ACCUSATION_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "timur.35.a"
		add_prestige = -25
	}
}
country_event = {
	id = timur.36
	title = timur.36.t
	desc = timur.36.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		tag = KHI
		exists = yes
		exists = BLU
		is_subject = no
		is_at_war = no
	}
	
	option = {
		name = "timur.36.a"
		ai_chance = {
			factor = 95
		}
		add_prestige = -25
		BLU = {
			create_subject = {
				subject_type = tributary_state
				who = KHI
			}
		}
	}
	option = {
		name = "timur.36.b"
		ai_chance = {
			factor = 5
		}
		add_prestige = 25
	}
}
country_event = {
	id = timur.37
	title = timur.37.t
	desc = timur.37.d
	picture = RELIGION_eventPicture
	
	trigger = {
		has_country_flag = Timur_Persianate
		NOT = { has_country_flag = Timur_Persianised }
		NOT = { has_ruler_flag = Timur_Persianising }
		Timur_Has = no
		capital_scope = { superregion = persia_superregion }
	}
	
	mean_time_to_happen = {
		months = 48
		modifier = {
			factor = 0.9
			stability = 3
		}
		modifier = {
			factor = 0.9
			stability = 2
		}
		modifier = {
			factor = 0.9
			stability = 1
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 90
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 80
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 70
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 60
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 50
		}
	}
	
	option = {
		name = "timur.37.a"
		ai_chance = {
			factor = 30
			modifier = {
				factor = 2
				has_country_flag = Timur_Persia
			}
		}
		if = {
			limit = {
				NOT = { culture_group = persian_group }
			}
			remove_accepted_culture = tajihk
			change_primary_culture = tajihk
		}
		add_government_reform = Pol_NominalEmpire
		hidden_effect = {
			set_country_flag = Timur_Persianised
		}
	}
	
	option = {
		name = "timur.37.b"
		add_horde_unity = 25
		ai_chance = {
			factor = 70
		}
	}
	after = {
		set_ruler_flag = Timur_Persianising
	}
}
country_event = {
	id = timur.38
	title = timur.38.t
	desc = timur.38.d
	picture = ACCUSATION_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = Horde_Timur
		Timur_Has = yes
		exists = KHI
		OR = {
			455 = { owned_by = KHI }
			456 = { owned_by = KHI }
			442 = { owned_by = KHI }
			3278 = { owned_by = KHI }
		}
	}
	
	option = {
		name = "timur.38.a"
		ai_chance = {
			factor = 80
		}
		add_prestige = 25
		add_horde_unity = 10
		KHI = { country_event = { id = timur.39 days = 5 } }
	}
	option = {
		name = "timur.38.b"
		ai_chance = {
			factor = 20
		}
		add_horde_unity = -10
		add_prestige = -25
	}
}
country_event = {
	id = timur.39
	title = timur.39.t
	desc = timur.39.d
	picture = ACCUSATION_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		tag = KHI
		exists = yes
		FROM = { exists = yes }
	}
	
	option = {
		name = "timur.39.a"
		ai_chance = {
			factor = 80
		}
		add_prestige = 50
		add_horde_unity = 25
		FROM = { country_event = { id = timur.40 days = 5 } }
	}
	option = {
		name = "timur.39.b"
		ai_chance = {
			factor = 20
		}
		add_horde_unity = -25
		add_prestige = -50
		FROM = { country_event = { id = timur.41 days = 5 } }
		455 = {
			if = {
				limit = {
					owned_by = PREV
				}
				cede_province = FROM
			}
		}
		456 = {
			if = {
				limit = {
					owned_by = PREV
				}
				cede_province = FROM
			}
		}
		442 = {
			if = {
				limit = {
					owned_by = PREV
				}
				cede_province = FROM
			}
		}
		3278 = {
			if = {
				limit = {
					owned_by = PREV
				}
				cede_province = FROM
			}
		}
		if = {
			limit = {
				OR = {
					is_subject = no
					overlord = { ai = yes }
				}
			}
			hidden_effect = { white_peace = FROM }
			if = {
				limit = {
					is_subject = yes
				}
				grant_independence = yes
			}
			FROM = {
				create_subject = {
					subject_type = tributary_state
					who = KHI
				}
			}
		}
		
	}
}
country_event = {
	id = timur.40
	title = timur.40.t
	desc = timur.40.d
	picture = BATTLE_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "timur.40.a"
		ai_chance = {
			factor = 100
		}
		add_prestige = -25
		add_horde_unity = 10
		if = {
			limit = {
				KHI = { is_subject = yes }
			}
			hidden_effect = { KHI = { grant_independence_effect = yes } }
		}
		declare_war_with_cb = {
			who = KHI
			casus_belli = cb_nomadic_reconquest
		}
	}
	option = {
		name = "timur.40.b"
		ai_chance = {
			factor = 0
		}
		add_prestige = -25
	}
}
country_event = {
	id = timur.41
	title = timur.41.t
	desc = timur.41.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "timur.41.a"
		add_prestige = 10
	}
}

#### Occupation, surrender ####
country_event = {
	id = timur.42
	title = timur.42.t
	desc = timur.42.d
	picture = SIEGE_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = {
		tag = ORM
		NOT = { is_year = 1420 } # performance
		NOT = { has_country_flag = Timur_Surrender }
		any_known_country = {
			Timur_Has = yes
			isValidCountry = yes
			war_with = ROOT
		}
	}
	
	option = { #Surrender
		name = timur.42.a
		ai_chance = {
			factor = 100
		}
		random_country = {
			limit = {
				Timur_Has = yes
				has_country_flag = Timur_West
				isValidCountry = yes
				war_with = ROOT
			}
			every_province = {
				limit = {
					owned_by = ROOT
					superregion = persia_superregion
					NOT = { province_id = 431 }
				}
				add_core = PREV
				cede_province = PREV
			}
		}
	}
	
	option = { #Fight on - player only
		name = timur.42.b
		ai_chance = {
			factor = 0
		}
	}
}
country_event = {
	id = timur.43
	title = timur.43.t
	desc = timur.43.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "timur.43.a"
	}
}

## Tokhtamysh
country_event = {
	id = timur.44
	title = timur.44.t
	desc = timur.44.d
	picture = CIVIL_WAR_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		Timur_Has = yes
		has_country_flag = Timur_West
		is_year = 1372
		exists = BLU
		BLU = {
			NOT = { has_country_flag = Tokhtamysh }
		}
		exists = WHI
		WHI = {
			is_free_or_tributary_trigger = yes
			OR = {
				has_disaster = Horde_Collapse
				has_country_modifier = puppet_khanate
			}
		}
		
	}
	
	mean_time_to_happen = {
		months = 2
	}
	
	option = {
		name = "timur.44.a"
		ai_chance = { factor = 100 }
		add_prestige = 10
		BLU = {
			country_event = { id = timur.45 days = 30 }
			hidden_effect = { set_country_flag = Tokhtamysh }
		}
	}
	
	option = {
		name = "timur.44.b"
		ai_chance = { factor = 0 }
		#BLU = {
		#	add_opinion_modifier = {
		#		who = TIM
		#		modifier = Timur_Noped
		#	}
		#}
	}
}

## Tokhtamysh Attacks
country_event = {
	id = timur.45
	title = timur.45.t
	desc = timur.45.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "timur.45.a"
		ai_chance = { factor = 100 }
		add_prestige = 10
		TIM = { country_event = { id = timur.47 days = 120 random = 60 } }
	}
	option = {
		name = "timur.45.b"
		ai_chance = { factor = 0 }
		hidden_effect = { clr_country_flag = Tokhtamysh }
		add_prestige = 10
		TIM = { country_event = { id = timur.51 days = 10 } }
	}
	
	option = {
		name = "timur.45.b"
		ai_chance = { factor = 0 }
		country_event = { id = timur.46 days = 30 }
	}
}

## Tokhtamysh Ascends
country_event = {
	id = timur.46
	title = timur.46.t
	desc = timur.46.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "timur.46.a"
		Stab_Add3 = yes
		add_horde_unity = 50
		define_ruler = {
			name = "Tokhtamysh"
			dynasty = "Jochid"
			ADM = 5
			DIP = 4
			MIL = 6
		}
		define_heir = {
			name = "Jalal al-Din"
			dynasty = "Jochid"
			ADM = 4
			DIP = 4
			MIL = 3
		}
		define_ruler_to_general = {
			fire = 4
			shock = 5
			manuever = 5
			siege = 1
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=50 }
		hidden_effect = {
			add_country_modifier = { name = Timur_Mustering duration = 1820 hidden = yes }
			set_country_flag = Tokhtamysh_Has
			add_manpower = 10
			add_army_tradition = 10
			every_owned_province = {
				limit = {
					is_core = TIM
					exists = TIM
				}
				cede_province = TIM
			}
		}
		create_alliance = TIM
		TIM = { country_event = { id = timur.48 days = 5 } }
	}
}

## Tokhtamysh Flees
country_event = {
	id = timur.47
	title = timur.47.t
	desc = timur.47.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "timur.47.a"
		ai_chance = { factor = 100 }
		add_prestige = -15
		if = {
			limit = {
				BLU = { has_country_flag = Tokhtamysh }
				BLU = { NOT = { has_country_flag = Tokhtamysh_Has } }
			}
			BLU = { set_ruler_flag = Tokhtamysh_Repelled }
		}
	}
	option = {
		name = "timur.47.b"
		ai_chance = { factor = 0 }
		hidden_effect = { BLU = { clr_country_flag = Tokhtamysh } }
		BLU = { country_event = { id = timur.52 days = 10 } }
	}
}

## Tokhtamysh Wins
country_event = {
	id = timur.48
	title = timur.48.t
	desc = timur.48.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "timur.48.a"
		add_prestige = 10
		add_horde_unity = 10
	}
}

## Tokhtamysh Invades
country_event = {
	id = timur.49
	title = timur.49.t
	desc = timur.49.d
	picture = CIVIL_WAR_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		has_country_flag = Tokhtamysh_Has
		is_year = 1380
		exists = WHI
		WHI = {
			is_free_or_tributary_trigger = yes
			OR = {
				has_disaster = Horde_Collapse
				has_country_modifier = puppet_khanate
			}
		}
		NOT = { truce_with = WHI }
		
	}
	
	mean_time_to_happen = {
		months = 6
	}
	
	option = {
		name = "timur.49.a"
		ai_chance = { factor = 100 }
		add_horde_unity = 10
		add_prestige = 25
		hidden_effect = { set_country_flag = Horde_Unifier }
		declare_war_with_cb = {
			who = WHI
			casus_belli = cb_nomadic_submission
		}
		#HACK till 1.30, join wars command
		hidden_effect = {
			TIM = {
				if = {
					limit = {
						alliance_with = BLU
					}
					declare_war_with_cb = {
						who = WHI
						casus_belli = cb_nomadic_tribute
					}
				}
			}
		}
		TIM = {
			country_event = { id = timur.50 days = 10 }
		}
	}
	
	option = {
		name = "timur.49.b"
		ai_chance = { factor = 0 }
	}
}

## Tokhtamysh Invades Notice
country_event = {
	id = timur.50
	title = timur.50.t
	desc = timur.50.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "timur.50.a"
		add_prestige = -10
	}
}

## Tokhtamysh Executed
country_event = {
	id = timur.51
	title = timur.51.t
	desc = timur.51.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "timur.51.a"
		add_prestige = -15
	}
}

## Tokhtamysh in Chains
country_event = {
	id = timur.52
	title = timur.52.t
	desc = timur.52.d
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "timur.52.a"
		add_prestige = 20
		add_horde_unity = 10
	}
}
## White Horde Victory
country_event = {
	id = timur.53
	title = timur.53.t
	desc = timur.53.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		tag = WHI
		FROM = {
			province_id = 3298
			controlled_by = BLU
		}
	}
	
	option = {
		name = "timur.53.a"
		add_prestige = 10
		add_horde_unity = 10
		hidden_effect = { white_peace = BLU }
		hidden_effect = { BLU = { grant_independence_effect = yes } }
		create_subject = {
			subject_type = decentralized_vassal
			who = BLU
		}
		ai_chance = {
			factor = 100
		}
	}
	option = {
		name = "timur.53.b"
		add_horde_unity = -5
		ai_chance = {
			factor = 0
		}
	}
}
## Blue Horde Victory
country_event = {
	id = timur.54
	title = timur.54.t
	desc = timur.54.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		tag = BLU
		FROM = {
			province_id = 1310
			controlled_by = WHI
		}
	}
	
	option = {
		name = "timur.54.a"
		add_prestige = 10
		add_horde_unity = 10
		hidden_effect = { white_peace = WHI }
		hidden_effect = { WHI = { grant_independence_effect = yes } }
		create_subject = {
			subject_type = decentralized_vassal
			who = WHI
		}
		if = {
			limit = {
				has_country_flag = Tokhtamysh_Has
				exists = TIM
			}
			TIM = {
				create_subject = {
					subject_type = tributary_state
					who = PREV
				}
			}
			
		}
		ai_chance = {
			factor = 100
		}
	}
	option = {
		name = "timur.54.b"
		add_horde_unity = -5
		ai_chance = {
			factor = 0
		}
	}
}
country_event = {
	id = timur.55
	title = no_localisation
	desc = no_localisation
	picture = BATTLE_eventPicture
	
	hidden = yes
	
	trigger = {
		is_year = 1368
		Timur_Has = yes
		has_country_flag = Timur_East
		ai = yes
		is_at_war = no
		any_neighbor_country = {
			Timur_EastConquer = yes
			NOT = { alliance_with = PREV }
			NOT = { truce_with = PREV }
			NOT = { guaranteed_by = PREV }
			NOT = { overlord_of = PREV }
			OR = {
				is_subject = no
				AND = {
					is_free_or_tributary_trigger = yes
					ai = yes
				}
				overlord = { Timur_Has = no }
			}
			OR = {
				NOT = { tag = DLH }
				PREV = { NOT = { has_country_flag = TIM_DLH } }
			}
			isValidCountry = yes
		}
	}
	
	mean_time_to_happen = {
		months = 18
		modifier = {
			factor = 0.9
			stability = 3
		}
		modifier = {
			factor = 0.9
			stability = 2
		}
		modifier = {
			factor = 0.9
			stability = 1
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 90
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 80
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 70
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 60
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 50
		}
		modifier = {
			factor = 0.9
			prestige = 50
		}
	}
	
	option = {	
		name = no_localisation
		if = {
			limit = {
				exists = KHI
				OR = {
					is_neighbor_of = KHI
					any_subject_country = {
						is_neighbor_of = KHI
					}
				}
				KHI = {
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			KHI = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = KHI
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = KTD
				OR = {
					is_neighbor_of = KTD
					any_subject_country = {
						is_neighbor_of = KTD
					}
				}
				KTD = {
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			KTD = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = KTD
				casus_belli = cb_nomadic_reconquest
			}
		}
		else_if = {
			limit = {
				exists = KHO
				OR = {
					is_neighbor_of = KHO
					any_subject_country = {
						is_neighbor_of = KHO
					}
				}
				KHO = {
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			KHO = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = KHO
				casus_belli = cb_nomadic_conquest_mil
			}
		}
		else_if = {
			limit = {
				exists = JQB
				OR = {
					is_neighbor_of = JQB
					any_subject_country = {
						is_neighbor_of = JQB
					}
				}
				JQB = {
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			JQB = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = JQB
				casus_belli = cb_nomadic_conquest_mil
			}
		}
		else_if = {
			limit = {
				exists = MGH
				OR = {
					is_neighbor_of = MGH
					any_subject_country = {
						is_neighbor_of = MGH
					}
				}
				MGH = {
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			MGH = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = MGH
				casus_belli = cb_nomadic_submission
			}
		}
		else_if = {
			limit = {
				exists = BLU
				OR = {
					is_neighbor_of = BLU
					any_subject_country = {
						is_neighbor_of = BLU
					}
				}
				BLU = {
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			BLU = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = BLU
				casus_belli = cb_nomadic_submission
			}
		}
		else_if = {
			limit = {
				exists = YUA
				OR = {
					is_neighbor_of = YUA
					any_subject_country = {
						is_neighbor_of = YUA
					}
				}
				YUA = {
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			YUA = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = YUA
				casus_belli = cb_nomadic_submission
			}
		}
		else_if = {
			limit = {
				exists = WHI
				OR = {
					is_neighbor_of = WHI
					any_subject_country = {
						is_neighbor_of = WHI
					}
				}
				WHI = {
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			WHI = {
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
			}
			declare_war_with_cb = {
				who = WHI
				casus_belli = cb_nomadic_submission
			}
		}
		else_if = {
			limit = {
				exists = DLH
				NOT = { has_country_flag = TIM_DLH }
				OR = {
					is_neighbor_of = DLH
					any_subject_country = {
						is_neighbor_of = DLH
					}
				}
				DLH = {
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					isValidCountry = yes
				}
			}
			set_country_flag = TIM_DLH
			declare_war_with_cb = {
				who = DLH
				casus_belli = cb_nomadic_tribute
			}
		}
		else = {
			random_neighbor_country = {
				limit = {
					Timur_EastConquer = yes
					NOT = { alliance_with = PREV }
					NOT = { truce_with = PREV }
					NOT = { guaranteed_by = PREV }
					NOT = { overlord_of = PREV }
					OR = {
						is_subject = no
						AND = {
							is_free_or_tributary_trigger = yes
							ai = yes
						}
						overlord = { Timur_Has = no }
					}
					OR = {
						NOT = { tag = DLH }
						PREV = { NOT = { has_country_flag = TIM_DLH } }
					}
					isValidCountry = yes
				}
				if = {
					limit = {
						is_subject = yes
						is_subject_of_type = tributary_state
					}
					grant_independence = yes
				}
				PREV = {
					declare_war_with_cb = {
						who = PREV
						casus_belli = cb_nomadic_conquest_mil
					}
				}
			}
		}
	}
}

#### Occupation, surrender ####
country_event = {
	id = timur.56
	title = timur.56.t
	desc = timur.56.d
	picture = SIEGE_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = {
		tag = MGH
		NOT = { is_year = 1420 } # performance
		NOT = { has_country_flag = Timur_Surrender }
		is_at_war = yes
		TIM = {
			Timur_Has = yes
			has_country_flag = Timur_West
			ai = yes
			war_with = MGH
			isValidCountry = yes
		}
		OR = {
			capital_scope = { controlled_by = TIM }
			TIM = {
				Timur_Has = yes
				war_score_against = {
					who = MGH
					value = 30
				}
			}
		}
	}
	
	option = { #Surrender
		name = timur.56.a
		ai_chance = {
			factor = 100
		}
		TIM = { white_peace = MGH }
		hidden_effect = { white_peace = TIM }
		every_province = {
			limit = {
				owned_by = MGH
				is_core = TIM
			}
			cede_province = TIM
		}
	}
	
	option = { #Fight on - player only
		name = timur.56.b
		ai_chance = {
			factor = 0
		}
	}
	after = {
		hidden_effect = {
			set_country_flag = Timur_Surrender
			TIM = { set_country_flag = TIM_MGH }
		}
	}
}
## Blue Horde Victory trigger by timur
country_event = {
	id = timur.57
	title = timur.57.t
	desc = timur.57.d
	picture = HORDE_ON_HORSEBACK_eventPicture
	
	hidden = yes
	is_triggered_only = yes
	
	trigger = {
		tag = TIM
		BLU = { has_country_flag = Tokhtamysh_Has }
		OR = {
			overlord_of = BLU
			alliance_with = BLU
		}
		FROM = {
			province_id = 1310
			owned_by = WHI
		}
	}
	
	option = {
		name = "timur.57.a"
		white_peace = WHI
		BLU = { country_event = { id = timur.54 } }
	}
}
country_event = {
	id = timur.58
	title = timur.58.t
	desc = timur.58.d
	picture = ACCUSATION_eventPicture
	
	hidden = yes
	fire_only_once = yes
	
	trigger = {
		tag = BLU
		has_country_flag = Tokhtamysh
		NOT = { has_country_flag = Tokhtamysh_Has }
		has_ruler_flag = Tokhtamysh_Repelled
		is_year = 1377
	}
	
	mean_time_to_happen = {
		months = 2
	}
	
	option = {
		name = "timur.58.a"
		kill_ruler = yes
	}
}
# Timurid Mongolia, post-Timur
country_event = {
	id = timur.59
	title = timur.59.t
	desc = timur.59.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Centralise
	option = {
		name = timur_centralise
		ai_chance = {
			factor = 0.1
			modifier = {
				factor = 10
				has_country_flag = Timur_Mongolia
			}
		}
		if = {
			limit = {
				has_country_flag = Timur_Mongolia
			}
			Timur_MongoliaCentralise = { nationalism = 5 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Sarai
				}
			}
			Timur_MongoliaCentralise = { nationalism = 20 }
		}
		else_if = {
			limit = {
				OR = {
					has_country_flag = Timur_Herat
					has_country_flag = Timur_Balkh
				}
			}
			Timur_MongoliaCentralise = { nationalism = 35 }
		}
		else = {
			Timur_MongoliaCentralise = { nationalism = 50 }
		}
	}
	# Decentralise
	option = {
		name = timur_decentralise
		ai_chance = {
			factor = 0.90
			modifier = {
				factor = 2
				OR = {
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Mongolia
				}
			}
		}
		if = {
			limit = {
				NOT = { has_country_flag = Timur_Mongolia }
			}
			if = {
				limit = {
					has_country_flag = Timur_Samarkand
				}
				Timur_MongoliaVassalise = { subject_type = rebellious_decentralized_vassal }
			}
			else_if = {
				limit = {
					OR = {
						has_country_flag = Timur_Sarai
						has_country_flag = Timur_Herat
						has_country_flag = Timur_Balkh
					}
				}
				Timur_MongoliaVassalise = { subject_type = close_tributary_state }
			}
			else = {
				Timur_MongoliaVassalise = { subject_type = tributary_state }
			}
		}
		else = {
			Timur_MongoliaDecentraliseCore = yes
		}
	}
	# Let go
	option = {
		name = timur_release
		ai_chance = {
			factor = 0.10
			modifier = {
				factor = 100
				NOT = { has_country_flag = Timur_Samarkand }
				NOT = { has_country_flag = Timur_Sarai }
				NOT = { has_country_flag = Timur_Herat }
				NOT = { has_country_flag = Timur_Balkh }
				NOT = { has_country_flag = Timur_China }
			}
			modifier = {
				factor = 0
				has_country_flag = Timur_Mongolia
			}
		}
		Timur_MongoliaRelease = yes
	}
}
# Timurid China, post-Timur
country_event = {
	id = timur.60
	title = timur.60.t
	desc = timur.60.desc
	picture = OVEREXTENSION_eventPicture
	
	is_triggered_only = yes
	
	# Forge a Dynasty
	option = {
		name = timur_chinadynasty
		trigger = {
			OR = {
				has_country_flag = Timur_China
				has_country_flag = Timur_Mongolia
				has_country_flag = Timur_Samarkand
				has_country_flag = Timur_Sarai
			}
		}
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				NOT = { has_country_flag = Timur_China }
			}
		}
		set_country_flag = China_ClaimForeign
		add_prestige = 10
		north_china_superregion = { limit = { owned_by = ROOT } add_core = ROOT }
		east_china_superregion = { limit = { owned_by = ROOT } add_core = ROOT }
		southwest_china_superregion = { limit = { owned_by = ROOT } add_core = ROOT }
		Timur_Vassalise = { tag = KOR subject_type = close_tributary_state }
	}
	# Create a Puppet Dynasty
	option = {
		trigger = {
			OR = {
				has_country_flag = Timur_China
				has_country_flag = Timur_Mongolia
				has_country_flag = Timur_Samarkand
				has_country_flag = Timur_Sarai
			}
			OR = {
				NOT = { exists = YUA }
				NOT = { exists = QIN }
			}
		}
		name = timur_chinapuppet
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0
				has_country_flag = Timur_China
			}
		}
		if = {
			limit = {
				NOT = { exists = QIN }
			}
			hidden_effect = {
				every_province = {
					limit = {
						isValidProv = yes
					}
					remove_core = QIN
				}
				every_owned_province = {
					limit = {
						OR = {
							has_province_flag = InMiddleKingdom
							region = tibet_region
						}
					}
					add_core = QIN
					cede_province = QIN
				}
				QIN = {
					change_primary_culture = turco_mongol
					chinese_government_change_steppe = yes
					Reset_Religion_to_Capital = yes
					clr_country_flag = POP_Init
				}
			}
			Timur_Vassalise = { tag = QIN subject_type = warlord }
		}
		else = {
			hidden_effect = {
				every_province = {
					limit = {
						isValidProv = yes
					}
					remove_core = YUA
				}
				every_owned_province = {
					limit = {
						OR = {
							superregion = north_china_superregion
							superregion = east_china_superregion
							superregion = southwest_china_superregion
						}
					}
					add_core = YUA
					cede_province = YUA
				}
				YUA = {
					Reset_Religion_to_Capital = yes
					clr_country_flag = POP_Init
					change_primary_culture = turco_mongol
					chinese_government_change_steppe = yes
				}
			}
			Timur_Vassalise = { tag = YUA subject_type = warlord }
		}
		Timur_Release = { tag = KOR }
	}
	# Abandon China
	option = {
		name = timur_chinarelease
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					has_country_flag = Timur_China
					has_country_flag = Timur_Mongolia
					has_country_flag = Timur_Samarkand
					has_country_flag = Timur_Sarai
				}
			}
		}
		Timur_ChinaRelease = yes
	}
}

country_event = {
	id = timur.61
	title = timur.61.t
	desc = timur.61.d
	picture = OVEREXTENSION_eventPicture
	
	trigger = {
		Timur_Has = yes
		tag = TIM
		is_subject_other_than_tributary_trigger = yes
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = Timur_Dead
			set_country_flag = Timur_Deposed
			add_government_reform = Horde_Monarchy
		}
	}
	
	option = {
		name = "timur.61.a"
		define_ruler = {
			name = "Shah Rukh"
			dynasty = "Timurid"
			culture = turco_mongol
			religion = sunni
			age = 25
			male = yes
			adm = 4
			dip = 3
			mil = 5
			claim = 95
		}
		define_ruler_to_general = {
			fire = 2
			shock = 4
			manuever = 3
			siege = 1
		}
		clear_scripted_personalities = yes
		add_ruler_personality = scholar_personality
		add_ruler_personality = architectural_visionary_personality
		add_ruler_personality = benevolent_personality
		define_consort = {
			name = "Goharshad"
			age = 35
			dynasty = "Tarkhan"
			culture = persian
			adm = 4
			dip = 5
			mil = 3
		}
		add_ruler_modifier = {
			name = shahrukhs_empire
		}
		country_event = { id = timur.22 days = 90 }
		if = {
			limit = {
				check_key = { lhs = Ruler_SkillScaled value = 15 }
			}
			add_horde_unity = -10
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-15 }
			add_prestige = -20
			Stab_Subtract5 = yes
			add_country_modifier = { name = puppet_khanate duration = -1 }
			hidden_effect = {
				every_owned_province = {
					limit = {
						OR = {
							NOT = { province_group = steppes_group }
							AND = {
								NOT = { continent = central_asia }
								NOT = { region = crimea_region }
							}
						}
						NOT = { region = sistan_region }
						NOT = { region = iran_region }
						NOT = { region = fars_region }
						NOT = { region = khorasani_region }
						NOT = { region = hindusthan_region }
						NOT = { region = punjab_region }
						NOT = { region = upper_doab_region }
						NOT = { region = lower_mesopotamia_region }
						NOT = { region = upper_mesopotamia_region }
						NOT = { region = south_caucasus_region }
						NOT = { region = west_anatolia_region }
						NOT = { region = north_anatolia_region }
						NOT = { region = south_anatolia_region }
					}
					add_nationalism = 40
				}
			}
			every_subject_country = {
				limit = {
					is_subject_of_type = tributary_state # not close ones
				}
				grant_independence = yes
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 10
				}
				spawn_rebels = {
					leader = "Miran Shah Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 4
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Khalil Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 4
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Pir Muhammad Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 4
					should_take_capital = yes
				}
			}
		}
		else_if = {
			limit = {
				check_key = { lhs = Ruler_SkillScaled value = 12 }
			}
			add_horde_unity = -15
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-15 }
			add_prestige = -20
			Stab_Subtract3 = yes
			add_country_modifier = { name = puppet_khanate duration = -1 }
			hidden_effect = {
				every_owned_province = {
					limit = {
						OR = {
							NOT = { province_group = steppes_group }
							AND = {
								NOT = { continent = central_asia }
								NOT = { region = crimea_region }
							}
						}
						NOT = { region = sistan_region }
						NOT = { region = iran_region }
						NOT = { region = fars_region }
						NOT = { region = khorasani_region }
						NOT = { region = hindusthan_region }
						NOT = { region = punjab_region }
						NOT = { region = upper_doab_region }
						NOT = { region = lower_mesopotamia_region }
						NOT = { region = upper_mesopotamia_region }
						NOT = { region = south_caucasus_region }
						NOT = { region = west_anatolia_region }
						NOT = { region = north_anatolia_region }
						NOT = { region = south_anatolia_region }
					}
					add_nationalism = 30
				}
			}
			every_subject_country = {
				limit = {
					is_subject_of_type = tributary_state # not close ones
				}
				grant_independence = yes
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Sultan Husayn Tayichiud"
					type = pretender_rebels
					culture = mongolic_turk
					size = 6
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Miran Shah Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 6
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Khalil Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 6
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Pir Muhammad Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 6
					should_take_capital = yes
				}
			}
		}
		else = {
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=TR Amount=-20 }
			add_horde_unity = -25
			add_prestige = -25
			Stab_Subtract4 = yes
			add_country_modifier = { name = puppet_khanate duration = -1 }
			hidden_effect = {
				every_owned_province = {
					limit = {
						OR = {
							NOT = { province_group = steppes_group }
							AND = {
								NOT = { continent = central_asia }
								NOT = { region = crimea_region }
							}
						}
						NOT = { region = sistan_region }
						NOT = { region = iran_region }
						NOT = { region = fars_region }
						NOT = { region = khorasani_region }
						NOT = { region = hindusthan_region }
						NOT = { region = punjab_region }
						NOT = { region = upper_doab_region }
						NOT = { region = lower_mesopotamia_region }
						NOT = { region = upper_mesopotamia_region }
						NOT = { region = south_caucasus_region }
						NOT = { region = west_anatolia_region }
						NOT = { region = north_anatolia_region }
						NOT = { region = south_anatolia_region }
					}
					add_nationalism = 20
				}
			}
			every_subject_country = {
				limit = {
					is_subject_of_type = tributary_state # not close ones
				}
				grant_independence = yes
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Sultan Husayn Tayichiud"
					type = pretender_rebels
					culture = mongolic_turk
					size = 8
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Miran Shah Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 8
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Khalil Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 8
					should_take_capital = yes
				}
			}
			random_owned_province = {
				limit = {
					isValidProv = yes
					OR = {
						culture_group = tartar_group
						culture_group = persian_group
						culture_group = altaic
						culture_group = ROOT
					}
					development = 7
				}
				spawn_rebels = {
					leader = "Pir Muhammad Timurid"
					type = pretender_rebels
					culture = turco_mongol
					size = 8
					should_take_capital = yes
				}
			}
		}
	}
}
#### Occupation, surrender ####
country_event = {
	id = timur.62
	title = timur.62.t
	desc = timur.62.d
	picture = SIEGE_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = {
		NOT = { is_year = 1420 } # performance
		tag = DLH
		NOT = { has_country_flag = Timur_Surrender }
		is_at_war = yes
		TIM = {
			Timur_Has = yes
			ai = yes
			war_with = DLH
			isValidCountry = yes
		}
		OR = {
			capital_scope = { controlled_by = TIM }
			DLH = {
				Timur_Has = yes
				war_score_against = {
					who = DLH
					value = 50
				}
			}
		}
	}
	
	option = { #Surrender
		name = timur.62.a
		ai_chance = {
			factor = 100
		}
		TIM = { white_peace = DLH }
		hidden_effect = { white_peace = TIM }
		TIM = {
			create_subject = {
				subject_type = muscovite_tributary_state
				who = PREV
			}
		}
	}
	
	option = { #Fight on - player only
		name = timur.62.b
		ai_chance = {
			factor = 0
		}
	}
	after = {
		hidden_effect = {
			set_country_flag = Timur_Surrender
			TIM = { set_country_flag = TIM_DLH }
		}
	}
}
#### Occupation, surrender ####
country_event = {
	id = timur.63
	title = timur.63.t
	desc = timur.63.d
	picture = SIEGE_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = {
		NOT = { is_year = 1420 } # performance
		tag = MAM
		NOT = { has_country_flag = Timur_Surrender }
		is_at_war = yes
		TIM = {
			Timur_Has = yes
			ai = yes
			war_with = MAM
			isValidCountry = yes
		}
		OR = {
			capital_scope = { controlled_by = TIM }
			377 = { controlled_by = TIM }
			MAM = {
				Timur_Has = yes
				war_score_against = {
					who = MAM
					value = 30
				}
			}
		}
	}
	
	option = { #Surrender
		name = timur.63.a
		ai_chance = {
			factor = 100
		}
		TIM = { white_peace = MAM }
		MAM = {
			every_subject_country = {
				TIM = { white_peace = PREV }
			}
		}
		TIM = { white_peace = SYR }
		TIM = { white_peace = DUL }
		hidden_effect = { white_peace = TIM }
		every_province = {
			limit = {
				owner = {
					OR = {
						is_subject_of = MAM
						tag = MAM
					}
				}
				OR = {
					region = west_anatolia_region
					region = north_anatolia_region
					region = south_anatolia_region
					region = upper_mesopotamia_region
					region = lower_mesopotamia_region
					area = aleppo_area
				}
				NOT = { province_id = 2750 }
				NOT = { province_id = 321 }
			}
			add_core = TIM
			cede_province = TIM
		}
		TIM = {
			create_subject = {
				subject_type = muscovite_tributary_state
				who = PREV
			}
		}
	}
	
	option = { #Fight on - player only
		name = timur.63.b
		ai_chance = {
			factor = 0
		}
	}
	after = {
		hidden_effect = {
			set_country_flag = Timur_Surrender
			TIM = { set_country_flag = TIM_MAM }
		}
	}
}
#### The End of Qocho ####
country_event = {
	id = moghul.1
	title = moghul.1.t
	desc = moghul.1.d
	picture = SIEGE_eventPicture

	fire_only_once = yes
	
	trigger = {
		is_year = 1389 # performance
		NOT = { is_year = 1420 } # performance
		tag = MGH
		religion_group = muslim
		OR = {
			overlord_of = KAS
			KAS = { is_subject = no }
		}
		KAS = {
			NOT = { religion_group = muslim }
			NOT = { religion = tengri_pagan }
		}
	}

	mean_time_to_happen = {
		months = 6
		modifier = {
			factor = 0.9
			stability = 3
		}
		modifier = {
			factor = 0.9
			stability = 2
		}
		modifier = {
			factor = 0.9
			stability = 1
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 90
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 80
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 70
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 60
		}
		modifier = {
			factor = 0.9
			legitimacy_equivalent = 50
		}
		modifier = {
			factor = 0.9
			prestige = 50
		}
	}
	
	option = { #end
		name = moghul.1.a
		KAS = { grant_independence_effect = yes }
		add_country_modifier = { name = CL_ReligiousWar_L duration = 3650 }
		declare_war_with_cb = {
			who = KAS
			casus_belli = cb_crusade
		}
		3213 = {
			add_core = MGH
		}
		KAS = { country_event = { id = moghul.2 } }
		ai_chance = {
			factor = 0.9
		}
	}
	
	option = { #player only
		name = moghul.1.b
		ai_chance = {
			factor = 0.1
		}
	}
}
country_event = {
	id = moghul.2
	title = moghul.2.t
	desc = moghul.2.d
	picture = SIEGE_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
	
	option = { 
		name = moghul.2.a
		trigger = {
			ai = no
		}
		add_legitimacy = 25
		Stab_Add1 = yes
		add_army_tradition = 10
	}
	
	option = { 
		name = moghul.2.b
		trigger = {
			ai = yes
		}
		Stab_Subtract1 = yes
	}
}
country_event = {
	id = moghul.3
	title = moghul.3.t
	desc = moghul.3.d
	picture = SIEGE_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		tag = KAS
		war_with = MGH
		MGH = { religion_group = muslim }
		owns = 3213
		NOT = { controls = 3213 }
		NOT = { is_year = 1420 } # performance
	}
	
	option = { 
		name = moghul.3.a
		if = {
			limit = {
				4705 = { culture = old_uyghur }
			}
			4705 = {
				change_culture = chaghatai
				change_religion = sunni
				if = {
					limit = {
						owner = { ai = no }
						4705 = {
							any_neighbor_province = {
								owned_by = MGH
							}
						}
					}
					4705 = {
						cede_province = MGH
					}
					hidden_effect = {
						province_event = {
							id = DG_Convert.005
						}
					}
				}
			}
		}
		if = {
			limit = {
				2118 = { culture = old_uyghur }
			}
			2118 = {
				change_culture = chaghatai
				change_religion = sunni
				if = {
					limit = {
						owner = { ai = no }
						2118 = {
							any_neighbor_province = {
								owned_by = MGH
							}
						}
					}
					2118 = {
						cede_province = MGH
					}
					hidden_effect = {
						province_event = {
							id = DG_Convert.005
						}
					}
				}
			}
		}
		if = {
			limit = {
				717 = { culture = old_uyghur }
			}
			717 = {
				change_culture = chaghatai
				change_religion = sunni
				if = {
					limit = {
						owner = { ai = no }
						717 = {
							any_neighbor_province = {
								owned_by = MGH
							}
						}
					}
					717 = {
						cede_province = MGH
					}
					hidden_effect = {
						province_event = {
							id = DG_Convert.005
						}
					}
				}
			}
		}
		if = {
			limit = {
				4958 = { OR = { culture = old_uyghur owned_by = KAS } }
			}
			4958 = {
				change_culture = oirats
				change_religion = tengri_pagan
				if = {
					limit = {
						owner = { ai = no }
						4958 = {
							any_neighbor_province = {
								owned_by = OIR
							}
						}
					}
					4958 = {
						cede_province = OIR
					}
					hidden_effect = {
						province_event = {
							id = DG_Convert.005
						}
					}
				}
			}
		}
		if = {
			limit = {
				ai = no
			}
			2743 = {
				if = {
					limit = {
						culture = old_uyghur
					}
					change_culture = chaghatai
				}
			}
			3213 = {
				if = {
					limit = {
						culture = old_uyghur
					}
					change_culture = chaghatai
				}
			}
			every_province = {
				limit = {
					owned_by = KAS
					OR = {
						AND = {
							NOT = { area = hami_area }
							NOT = { area = zungaria_area }
						}
						province_id = 3213
					}
				}
				cede_province = MGH
				hidden_effect = {
					province_event = {
						id = DG_Convert.005
					}
				}
			}
			if = {
				limit = {
					exists = OIR
				}
				every_province = {
					limit = {
						owned_by = KAS
						OR = {
							province_id = 2742
							province_id = 4958
						}
					}
					cede_province = OIR
					hidden_effect = {
						province_event = {
							id = DG_Convert.005
						}
					}
				}
			}
			if = {
				limit = {
					exists = YUA
				}
				every_province = {
					limit = {
						owned_by = KAS
					}
					cede_province = YUA
					hidden_effect = {
						province_event = {
							id = DG_Convert.005
						}
					}
				}
			}
			else = {
				every_province = {
					limit = {
						owned_by = KAS
					}
					add_core = HMI
					cede_province = HMI
					hidden_effect = {
						province_event = {
							id = DG_Convert.005
						}
					}
				}
			}
		}
	}
}
#### The End of Qocho ####
country_event = {
	id = moghul.4
	title = moghul.4.t
	desc = moghul.4.d
	picture = SIEGE_eventPicture

	fire_only_once = yes
	
	trigger = {
		is_year = 1370 # performance
		NOT = { is_year = 1389 } # performance
		tag = MGH
		religion_group = muslim
		OR = {
			overlord_of = KAS
			KAS = { is_subject = no }
		}
		KAS = {
			NOT = { religion_group = muslim }
			NOT = { religion = tengri_pagan }
		}
	}

	mean_time_to_happen = {
		years = 1
	}
	
	option = { # remain buddhist
		name = moghul.4.b
		add_prestige = 20

		ai_chance = {
			factor = 0.9
		}
	}
	
	option = { #embrace islam
		name = moghul.4.a
		change_religion = sunni
		force_converted = yes
		Stab_Subtract3 = yes
		add_legitimacy = -50
		add_prestige = -20
		Public_ChangeConcernTooltipProv = { Concern=Spirituality Amount=-3 }
		hidden_effect = {
			capital_scope = {
				province_event = {
					id = DG_Convert.005
				}
			}
		}

		ai_chance = {
			factor = 0.1
		}
	}
}