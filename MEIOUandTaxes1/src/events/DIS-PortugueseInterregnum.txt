namespace = portuguese_interregnum

#Portuguese Interregnum notification
country_event = {
	id = portuguese_interregnum.1
	title = "portuguese_interregnum.1.t"
	desc = "portuguese_interregnum.1.d"
	picture = CIVIL_WAR_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "portuguese_interregnum.1.a"
		set_country_flag = portuguese_interregnum
		country_event = {
			id = "portuguese_interregnum.10"
			days = 30
			tooltip = "portuguese_interregnum.10.d"
		}
	}
}

#There were potentially two Joao candidate, one being the Joao Duke of Valencia de Campos and another Joao of de Aviz but a popular Bastard
#Problem with the first one was he was exiled in Castile and married to the hated Queen's scheming mother's sister
country_event = {
	id = portuguese_interregnum.10
	title = "portuguese_interregnum.10.t"
	desc = "portuguese_interregnum.10.d"
	picture = COURT_INTRIGUE_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "portuguese_interregnum.10.a"
		set_country_flag = joao_borgonha
		define_ruler = {
			name = "João"
			dynasty = "Borgonha"
			age = 36
		}
	}

	option = {
		name = "portuguese_interregnum.10.a"
		ai_chance = {
			factor = 100
		}
		set_country_flag = joao_aviz
		define_ruler = {
			name = "João"
			dynasty = "Aviz"
			adm = 6
			mil = 5
			dip = 6
			max_age = 28
		}
	}

	after = {
		CAS = {
			country_event = {
				id = "portuguese_interregnum.11"
				days = 30
				tooltip = "portuguese_interregnum.11.d"
			}
		}
	}
}

#Castile: Backdown or enforce it?
country_event = {
	id = portuguese_interregnum.11
	title = "portuguese_interregnum.11.t"
	desc = "portuguese_interregnum.11.d"
	picture = COURT_INTRIGUE_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "portuguese_interregnum.11.a"
		ai_chance = {
			factor = 100
		}
		set_country_flag = enforce_beatriz_rights
		POR = {
			country_event = {
				id = "portuguese_interregnum.12"
				tooltip = "portuguese_interregnum.12.d"
			}
		}

		declare_war_with_cb = {
			casus_belli = cb_restore_personal_union
			who = POR
		}
		every_ally = {
			add_truce_with = POR
		}
	}

	option = {
		name = "portuguese_interregnum.11.b"
		set_country_flag = givesup_beatriz_rights
		POR = {
			end_disaster = portuguese_interregnum
		}
	}
}


#Savior of Portugal, Nuno Álvares Pereira
country_event = {
	id = portuguese_interregnum.12
	title = "portuguese_interregnum.12.t"
	desc = "portuguese_interregnum.12.d"
	picture = COURT_INTRIGUE_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "portuguese_interregnum.12.a"
		define_general = {
			fire = 6
			shock = 5
			manuever = 6
			siege = 3
			name = "Nuno Álvares Pereira"
			trait = hardy_warrior_personality
		}
	}
}


#Bourgeoisie helps Aviz
country_event = {
	id = portuguese_interregnum.50
	title = "portuguese_interregnum.50.t"
	desc = "portuguese_interregnum.50.d"
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "portuguese_interregnum.50.a"
		add_treasury = 100
		random_owned_province = {
			Public_ChangeClassWealthVal = { class = BG type = value inp = 100 }
		}
		country_event = {
			id = "portuguese_interregnum.51"
			days = 30
			tooltip = "portuguese_interregnum.51.d"
		}
	}
}

#Bourgeoisie helps Aviz - Spanish Notification
country_event = {
	id = portuguese_interregnum.51
	title = "portuguese_interregnum.51.t"
	desc = "portuguese_interregnum.51.d"
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "portuguese_interregnum.51.a"
	}
}

#Nobility helps Aviz
country_event = {
	id = portuguese_interregnum.52
	title = "portuguese_interregnum.52.t"
	desc = "portuguese_interregnum.52.d"
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "portuguese_interregnum.52.a"
		Public_ChangePowerbrokerLoyaltyTooltipProv = {
			Powerbroker = NO
			Amount = 20
		}
		NO_EnforceLevee = yes
		country_event = {
			id = "portuguese_interregnum.53"
			days = 30
			tooltip = "portuguese_interregnum.53.d"
		}
	}
}

#Nobility helps Aviz - Spanish Notification
country_event = {
	id = portuguese_interregnum.53
	title = "portuguese_interregnum.53.t"
	desc = "portuguese_interregnum.53.d"
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "portuguese_interregnum.53.a"
	}
}

#Raids across border
country_event = {
	id = portuguese_interregnum.54
	title = "portuguese_interregnum.54.t"
	desc = "portuguese_interregnum.54.d"
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					any_neighbor_province = {
						owner = {
							tag = CAS
						}
					}
				}
				save_event_target_as = raided_province
			}
		}
	}

	option = {
		name = "portuguese_interregnum.54.a"
		random_list = {
			75 = {
				country_event = {
					id = portuguese_interregnum.57
				}
			}
			25 = { 
				event_target:raided_province = {
					add_treasury = 20
					random_owned_province = {
						Public_ChangeClassWealthVal = { class= NO type = value inp= 20 }
					}
				}
				country_event = {
					id = portuguese_interregnum.56
				}
			 }
		}
	}

	option = {
		name = "portuguese_interregnum.54.b"
	}
}

#Raids across border - Success
country_event = {
	id = portuguese_interregnum.55
	title = "portuguese_interregnum.55.t"
	desc = "portuguese_interregnum.55.d"
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	option = {
		name = "portuguese_interregnum.55.a"
		add_legitimacy = -5
	}
}

#Raids across border - Failure
country_event = {
	id = portuguese_interregnum.56
	title = "portuguese_interregnum.56.t"
	desc = "portuguese_interregnum.56.d"
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes
	option = {
		name = "portuguese_interregnum.56.a"
		add_legitimacy = 5
	}
}

#Portuguese Interregnum End
country_event = {
	id = portuguese_interregnum.100
	title = "portuguese_interregnum.100.t"
	desc = "portuguese_interregnum.100.d"
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "portuguese_interregnum.100.a"
		clr_country_flag = portuguese_interregnum
		set_country_flag = had_portuguese_interregnum
		Stab_Add1 = yes

		if = {
			limit = {
				CAS = {
					has_casus_belli = {
						type = cb_restore_personal_union
						target = POR
					}
				}
			}
			CAS = {
				remove_casus_belli = {
					type = cb_restore_personal_union
					target = POR
				}
			}
		}
	}
}