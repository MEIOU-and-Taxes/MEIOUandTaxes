namespace = flavor_pol
namespace = flavor_hun

### SUCCESSION OF KAZIMIERZ THE GREAT AND LOUIS THE GREAT ###

#SUCCESSION OF KAZIMIERZ THE III
country_event = {
	id = flavor_pol.499
	title = "flavor_pol.3021b.title"
	desc = "flavor_pol.3021b.desc"
	picture = POLICY_eventPicture
	fire_only_once = yes
	is_triggered_only = yes ##on startup
	major = yes
	trigger = { 
		HUN = {
			dynasty = "d'Anjou"
			has_ruler = "Louis the Great"
		}
	}
	
	option = {  						#accept him
		name = "flavor_pol.3021b.a"
		custom_tooltip = tooltip_flavor_pol.3021.a
		ai_chance = { factor = 95 }
		create_alliance = HUN
		set_country_flag = pol_louis_great_heir
		log = "FE-POL:[GetYear]:[Root.GetName]:made Louis d'Anjou heir to Casimir:flavor_pol.499"
	}
	
	option = {							#no louis rawr
		name = "flavor_pol.3021b.b"
		custom_tooltip = tooltip_flavor_pol.3021.b
		ai_chance = { factor = 5 }
		hidden_effect = {
			kill_heir = {}
			PWO = {
				kill_heir = {}
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:rejected Louis d'Anjou as heir to Casimir:flavor_pol.499"
		define_heir = {
			dynasty = "Piast"
			name = "Kazimierz"
			male = yes
			age = 6
			claim = 30
			adm = 2
			dip = 4
			mil = 1
		}
		PWO = {
			define_heir = {
				dynasty = "Gryf"
				name = "Elzbieta"
				male = no
				age = 9
				adm = 3
				dip = 6
				mil = 1
				claim = 20
			}
		}
		HUN = {
			add_trust = { 
				who = POL 
				value = -50
			}
			add_casus_belli = {
				target = POL 
				type = cb_restore_personal_union
				months = 300
			}
			add_opinion = {
				who = POL
				modifier = dishonoured_agreement
			}
		}
		add_prestige = 10
		add_legitimacy = -25
		break_marriage = HUN
	}
	after = {
	    hidden_effect = { #After 1356 Kazimierz separated from Adelheid
		    set_consort_flag = marriage_length_timer
		    country_event = { id = consort_events.201 days = 365 random = 90 }
			add_papal_influence = 25
		} 
	}
}

#SUCCESSION OF KAZIMIERZ THE GREAT
country_event = {
	id = flavor_pol.500
	title = "flavor_pol.3023.title"
	desc = "flavor_pol.3023.desc"
	picture = POLICY_eventPicture
	fire_only_once = yes
	is_triggered_only = yes #on monarch death
	hidden = yes
	
		
	immediate = {
		if = {
			limit = {
				NOT = { has_country_flag = pol_louis_great_heir }
			}
		}
		else_if = {										
			limit = {
				OR = {
					#HUN = { is_lesser_in_union = yes } 
					POL = { is_lesser_in_union = yes } 
					POL = { senior_union_with = LIT }
				}
			}
		}
		else_if = {                              #normal PU event
			limit = {
				OR = {
					AND = {                     #if pol has not Piast male, checks for HUN having a male too.
						NOT = {
							AND = { 
								has_heir = yes 
								has_female_heir = no
								OR = { 	
									has_regency = yes 
									has_consort_regency = yes
								} 
							}
						}
						NOT = { 
							AND = {
								is_female = no
								dynasty = "Piast"
								OR = { 	
									has_regency = no
									has_consort_regency = no
								} 
							}
						}
						OR = {
							HUN = { is_female = no }
							HUN = { 
								has_heir = yes 
								has_female_heir = no 
								OR = { 
									has_regency = yes
									has_consort_regency = yes
								}
							}
						}
					}
					AND = {
						OR = {      		#pol has woman and hun male 
							AND = {
								is_female = yes
								dynasty = "Piast"
								OR = {
									has_consort_regency = no
									has_regency = no
								}
							}
							AND = { 
								has_heir = yes 
								has_female_heir = yes
								OR = { 	
									has_regency = yes 
									has_consort_regency = yes
								} 
							}
						}
								
						OR = {
							AND = {
								HUN = { 
									is_female = no
									HUN = { dynasty = "d'Anjou" }
									OR = { 
										has_consort_regency = no
										has_regency = no
									}
								}
							}
							HUN = { 
								has_heir = yes 
								has_female_heir = no 
								OR = { 
									has_regency = yes
									has_consort_regency = yes
								}
							}
						}
					}
				}
			}
			country_event = { id = flavor_pol.501 days = 1 }
		}
		else_if = {										#poland got a proper heir!
			limit = {
				OR = {
					AND = {
						has_heir = yes 
						has_female_heir = no #heir is male
						OR = { 	
							has_regency = yes 
							has_consort_regency = yes
						} 
					}
					AND = {
						is_female = no
						dynasty = "Piast"
						OR = { 	
							has_regency = no
							has_consort_regency = no
						} 
					}
				}	
			}
			country_event = { id = flavor_pol.502 days = 1 }
		}
		else_if = { 									#hungary has no male and poland has no piast monarch either female or male.-
			limit = {
				NOT = { dynasty = "Piast" }
				OR = {
					AND = {
						HUN = { 
							is_female = yes
							OR = {
								has_consort_regency = no
								has_regency = no
							}	
						}
					}
					AND = {
						HUN = { 
							has_heir = yes 
							has_female_heir = yes
							OR = {
								has_consort_regency = yes
								has_regency = yes
							}
						}
					}
				}
			}
			country_event = { id = flavor_pol.503 days = 1 }
		}
		else_if = {                                #hungary has no male but poland has piast female monarch-> nothing happens
			limit = {
				OR = {
					AND = {
						is_female = yes
						has_consort_regency = no
						has_regency = no
						dynasty = "Piast"
					}
					OR = {
						HUN = { is_female = yes }
						HUN = { AND = { has_heir = yes has_female_heir = yes OR = { has_regency = yes has_consort_regency = yes } } }
					}
				}
			}
		}
	}
	option = {
		name = no_localisation
	}
	after = {
		clr_country_flag = pol_louis_great_heir
	}
}

#DEATH OF KAZIMIERZ III (with male heir, no union)
country_event = {
	id = flavor_pol.502
	title = "flavor_pol.502.title"
	desc = "flavor_pol.502.desc"
	picture = DEATH_OF_HEIR_eventPicture
	is_triggered_only = yes
		
	option = {
		name = "option.flavor_pol.502.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Poland had male heir - no union:flavor_pol.502"		
		add_prestige = 35
		add_legitimacy = 30
	}
}
	
#DEATH OF KAZIMIERZ III (Checks if Louis is still alive, has a son or heir. PUs Poland. Won't fire if Poland got a male heir)
country_event = {
	id = flavor_pol.501
	title = "flavor_pol.3022b.title"
	desc = {
		trigger = {
			HUN = { has_ruler = "Louis the Great" } 
		}
		desc = "flavor_pol.3022b.desca"
	}
	desc = {
		trigger = {
			NOT = { HUN = { has_ruler = "Louis the Great" } }
			NOT = { HUN = { has_regency = yes } }
			NOT = { HUN = { has_consort_regency = yes } }
		}
		desc = "flavor_pol.30222b.descb"
	}
	desc = {
		trigger = {
			NOT = { HUN = { has_ruler = "Louis the Great" } }
			HUN = { 
				has_heir = yes 
				has_female_heir = no 
				OR = { 
					has_regency = yes 
					has_consort_regency = yes 
				} 
			}
		}
		desc = "flavor_pol.302222b.desc"
	}
	
	desc = {
		trigger = {
			is_female = no
			dynasty = "Piast"
		}
		desc = "flavor_pol.3022222b.desc"
	}
	
	picture = DEATH_OF_HEIR_eventPicture
	major = yes
	fire_only_once = yes
	is_triggered_only = yes #fire from on dependency obtained
	trigger = {
		NOT = {
			AND = { 
				has_heir = yes 
				has_female_heir = no
				
				OR = { 	
					has_regency = yes 
					has_consort_regency = yes
				} 
			}
		}
		NOT = { 
			AND = {
				is_female = no
				dynasty = "Piast"
			}
		}
		OR = {
			HUN = { is_female = no }
			HUN = { 
				has_heir = yes 
				has_female_heir = no 
				OR = { 
					has_regency = yes
					has_consort_regency = yes
				}
			}
		}
	}
	
	option = { #normal PU when louis alive
		trigger = { 
		    HUN = { has_ruler = "Louis the Great" } 
		}
		name = "flavor_pol.3022.a"
		HUN = { create_union = POL }
		set_country_flag = pol_louis_great_king
		add_liberty_desire = 50
		#country_event = {  id = flavor_pol.504 days = 3 }
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (with Louis):flavor_pol.501"	
	}
	
	option = { #make new male ruler PU
		name = "flavor_pol.3022c.a"
		ai_chance = { 
			factor = 10
			modifier = { 
				factor = 1.5
				HUN = { legitimacy = 60 }
			}
			modifier = { 
				factor = 2
				HUN = { legitimacy = 85 }
			}	
		}
		trigger = { 
			NOT = { HUN = { has_ruler = "Louis the Great" } }
			NOT = { HUN = { has_regency = yes } }
			NOT = { HUN = { has_consort_regency = yes } }
			HUN = { is_lesser_in_union = no }
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (without Louis):flavor_pol.501"	
		HUN = { create_union = POL }
		#country_event = {  id = flavor_pol.504 days = 3 }
		add_liberty_desire = 100
		set_country_flag = pol_louis_son_great_king
	}
	
	option = { #make male heir PU
		name = "flavor_pol.3022c.b"
		ai_chance = { 
			factor = 10
			modifier = { 
				factor = 1.5
				HUN = { heir_claim = 60 }
			}
			modifier = { 
				factor = 2
				HUN = { heir_claim = 85 }
			}
		}
		trigger = {	
			NOT = { HUN =  { has_ruler = "Louis the Great" } }
			HUN = { 
				has_heir = yes 
				has_female_heir = no 
				OR = { 
					has_regency = yes 
					has_consort_regency = yes 
				}
                is_lesser_in_union = no				
			}
		}
		HUN = { create_union = POL }
		#country_event = {  id = flavor_pol.504 days = 3 }
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (without Louis):flavor_pol.501"	
		add_liberty_desire = 100
		set_country_flag = pol_louis_son_great_king
	}
	
	option = { #We shall choose a Piast!
		name = "flavor_pol.3022c.c"
		ai_chance = { factor = 90 }
		trigger = {
			NOT = { HUN =  { has_ruler = "Louis the Great" } }
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, declined PU under Hungary (without Louis):flavor_pol.501"
		hidden_effect = {
		    Pol_ChangeGovMonarchy = { Succession=4 Assembly=2 }
        }
		if = {
		    limit = { 
			    MAZ = {
				    exists = yes
                    dynasty = "Piast"
					is_female = no
					ai = yes
                }				
			}
			hidden_effect = {
			    MAZ = {
				    exile_heir_as = heir_move_to_poland
				    exile_ruler_as = { name = ruler_move_to_poland }
				}
				set_ruler = ruler_move_to_poland
			    set_heir = heir_move_to_poland
			    set_ruler_flag = elected_ruler
			}
			inherit = MAZ
		}
		else_if = {
		    limit = { 
			    any_known_country = {
                    dynasty = "Piast"
					is_female = no
					ai = yes
					NOT = { num_of_cities = 3 }
                }				
			}
			hidden_effect = {
			    random_known_country = {
				    limit = {
					    dynasty = "Piast"
						is_female = no
						ai = yes
						NOT = { num_of_cities = 3 }
					}
				    exile_heir_as = heir_move_to_poland
				    exile_ruler_as = { name = ruler_move_to_poland }
					set_country_flag = heir_to_polish_crown
				}
				set_ruler = ruler_move_to_poland
			    set_heir = heir_move_to_poland
			    set_ruler_flag = elected_ruler
			}
			every_country = {
			    limit = { has_country_flag = heir_to_polish_crown }
				ROOT = { inherit = PREV }
			}
		}
		else = {
		    define_ruler = {
				dynasty = "Piast"
				claim = 25
            }
		}
	}
}

#DEATH OF KAZIMIERZ III (Hungary has no male and Poland has no Piast monarch either female or male)
country_event = {
	id = flavor_pol.503
	title = "flavor_pol.title.30236"
	desc = "flavor_pol.desc.30236"
	picture = DEATH_OF_HEIR_eventPicture
	is_triggered_only = yes
	
	option = { #female woman
		name = "flavor_pol.30236.a"
		ai_chance = { factor = 10 }
		trigger = {
			NOT = { HUN =  { has_country_flag = looking_for_heir } }
			HUN = { is_lesser_in_union = no }
		}
		HUN = { create_union = POL }
		#country_event = {  id = flavor_pol.504 days = 3 }
		add_liberty_desire = 100
		set_country_flag = woman_great_king
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, union with Hungary (ruled by woman):flavor_pol.503"
	}
	
	option = { #no thx
		name = "flavor_pol.30236.b"
		ai_chance = { factor = 75 }
		add_legitimacy = -15
		add_prestige = 10
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, no union with Hungary (as it was ruled by woman):flavor_pol.503"
	}
	
	option = { #go with bohemia
		name = flavor_pol.30234.a
		ai_chance = { factor = 15 }
		trigger = {
			BOH = { is_lesser_in_union = no }
		}
		BOH = {
			create_subject = {
			    subject_type = temporary_union
			    subject = POL
		    }
		}
		#country_event = { id = flavor_pol.504 days = 3 }
		add_liberty_desire = 75
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, no union with Hungary (as it was ruled by woman):flavor_pol.503"
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, union with Bohemia:flavor_pol.503"
	}
}


#DEATH OF KAZIMIERZ (Fired from insta PU. Almost the same as previous event (501) with the difference that it adds possibility for Bohemian PU)
#country_event = { #this event don't seem to work, it isn't needed to complete the event chain anyway
#	id = flavor_pol.504
#	title = "flavor_pol.30234.title"
#	desc = {
#		trigger = {
#			HUN = { has_ruler = "Louis the Great" } 
#		}
#		desc = "flavor_pol.3022b.desca"
#	}
#	desc = {
#		trigger = {
#			NOT = { HUN = { has_ruler = "Louis the Great" } }
#			NOT = { HUN = { has_regency = yes } }
#			NOT = { HUN = { has_consort_regency = yes } }
#			NOT = { HUN = { is_female = yes } }
#		}
#		desc = "flavor_pol.30222b.descb"
#	}
#	desc = {
#		trigger = {
#			NOT = { HUN = { has_ruler = "Louis the Great" } }
#			HUN = { 
#				has_heir = yes 
#				has_female_heir = no 
#				OR = { 
#					has_regency = yes 
#					has_consort_regency = yes 
#				} 
#			}
#		}
#		desc = "flavor_pol.302222b.desc"
#	}
#	
#	desc = {
#		trigger = {
#			NOT = { HUN =  { has_ruler = "Louis the Great" } }
#			OR = {
#				HUN = { 
#					has_heir = yes 
#					has_female_heir = yes 
#					OR = { 
#						has_regency = yes 
#						has_consort_regency = yes 
#					} 
#				}
#				AND = {
#					is_female = yes
#					has_regency = no
#					has_consort_regency = no
#				}
#			}
#		}
#		desc = "flavor_pol.3022222b.desc"
#	}
#	picture = POLICY_eventPicture
#	is_triggered_only = yes 
#	fire_only_once = yes
#	major = yes
#	trigger = { 
#		tag = POL
#		junior_union_with = HUN 
#		NOT = { is_year = 1390 }
#		AND = {
#			NOT = { has_country_flag = pol_louis_great_king }
#			NOT = { has_country_flag = pol_louis_son_great_king }
#			NOT = { has_country_flag = woman_great_king }
#		}
#	}
#	
#	immediate = {
#		clr_country_flag = pol_louis_great_heir
#		
#	}
#	
#	option = { #normal PU when louis alive
#		trigger = { HUN = { has_ruler = "Louis the Great" } }
#		name = "flavor_pol.30234.a"
#		#HUN = { create_union = POL }
#		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (with Louis):flavor_pol.504"	
#		set_country_flag = pol_louis_great_king
#		add_liberty_desire = 40
#	}
#	
#	option = { #make new male ruler PU
#		name = "flavor_pol.3022c.a"
#		ai_chance = { 
#			factor = 10
#			modifier = { 
#				factor = 1.5
#				HUN = { legitimacy = 60 }
#			}
#			modifier = { 
#				factor = 2
#				HUN = { legitimacy = 85 }
#			}	
#		}
#		trigger = { 
#			NOT = { HUN =  { has_ruler = "Louis the Great" } }
#			NOT = { HUN = { has_regency = yes } }
#			NOT = { HUN = { has_consort_regency = yes } }
#			NOT = { is_female = yes }
#		}
#			
#		HUN = { create_union = POL }
#		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (without Louis):flavor_pol.504"	
#		add_liberty_desire = 75
#		set_country_flag = pol_louis_son_great_king
#	}
#	
#	option = { #make male heir PU
#		name = "flavor_pol.3022c.b"
#		ai_chance = { 
#			factor = 10
#			modifier = { 
#				factor = 1.5
#				HUN = { heir_claim = 60 }
#			}
#			modifier = { 
#				factor = 2
#				HUN = { heir_claim = 85 }
#			}
#		}
#		trigger = {	
#			NOT = { HUN =  { has_ruler = "Louis the Great" } }
#			HUN = { 
#				has_heir = yes 
#				has_female_heir = no 
#				OR = { 
#					has_regency = yes 
#					has_consort_regency = yes 
#				} 
#			}
#		}
#		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (without Louis):flavor_pol.504"	
#		HUN = { create_union = POL }
#		add_liberty_desire = 75
#		set_country_flag = pol_louis_son_great_king
#	}
#	
#	option = { #We shall choose a Piast!
#		name = "flavor_pol.30234.c"
#		ai_chance = { factor = 90 }
#		trigger = {
#			NOT = { HUN =  { has_ruler = "Louis the Great" } }
#		}
#		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, declined PU under Hungary (without Louis):flavor_pol.504"
#		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Piast became ruler:flavor_pol.504"
#		break_union = HUN
#		hidden_effect = {
#		    Pol_ChangeGovMonarchy = { Succession=4 Assembly=2 }
#        }
#		if = {
#		    limit = { 
#			    MAZ = {
#				    exists = yes
#                   dynasty = "Piast"
#					is_female = no
#					ai = yes
#                }				
#			}
#			hidden_effect = {
#			    MAZ = {
#				    exile_heir_as = heir_move_to_poland
#				    exile_ruler_as = { name = ruler_move_to_poland }
#				}
#				set_ruler = ruler_move_to_poland
#			    set_heir = heir_move_to_poland
#			    set_ruler_flag = elected_ruler
#			}
#			inherit = MAZ
#		}
#		else_if = {
#		    limit = { 
#			    any_known_country = {
#                    dynasty = "Piast"
#					is_female = no
#					ai = yes
#					NOT = { num_of_cities = 3 }
#                }				
#			}
#			hidden_effect = {
#			    random_known_country = {
#				    limit = {
#					    dynasty = "Piast"
#						is_female = no
#						ai = yes
#						NOT = { num_of_cities = 3 }
#					}
#				    exile_heir_as = heir_move_to_poland
#				    exile_ruler_as = { name = ruler_move_to_poland }
#					set_country_flag = heir_to_polish_crown
#				}
#				set_ruler = ruler_move_to_poland
#			    set_heir = heir_move_to_poland
#			    set_ruler_flag = elected_ruler
#			}
#			every_country = {
#			    limit = { has_country_flag = heir_to_polish_crown }
#				ROOT = { inherit = PREV }
#			}
#		}
#		else = {
#		    define_ruler = {
#				dynasty = "Piast"
#				claim = 25
#            }
#		}
#	}
#	
#	option = { #Go with woman
#		name = "flavor_pol.30236.a"
#		ai_chance = { factor = 10 }
#		trigger = {
#			NOT = { HUN =  { has_ruler = "Louis the Great" } }
#			OR = {
#				HUN = { 
#					has_heir = yes 
#					has_female_heir = yes 
#					OR = { 
#						has_regency = yes 
#						has_consort_regency = yes 
#					} 
#				}
#				AND = {
#					is_female = yes
#					has_regency = no
#					has_consort_regency = no
#				}
#			}
#		}
#		HUN = {
#			create_union = POL
#		}
#		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (ruler is a woman):flavor_pol.504"
#		add_liberty_desire = 100
#		set_country_flag = woman_great_king
#	}
#	
#	option = { #bohemia
#		name = "flavor_pol.30236.c"
#		trigger = {
#		}
#		ai_chance = { factor = 10 }
#		BOH = {
#			create_union = POL
#		}
#		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Bohemia:flavor_pol.504"
#		add_liberty_desire = 75
#	}
#}

#MAZOVIA INDEPENDENCE (hidden event)
country_event = { 
	id = flavor_pol.505
	title = "flavor_pol.title.505"
	desc = "flavor_pol.desc.505"
	picture = DEATH_OF_HEIR_eventPicture
	is_triggered_only = yes #triggered from kazimiers death from on actions
	fire_only_once = yes
	hidden = yes
	trigger = {
		tag = POL
		MAZ = { exists = yes }
	}
	immediate = {  
		if = {
			limit = {
				POL = { is_lesser_in_union = yes }
			}
			country_event = { id = flavor_pol.506 days = 1 }
		}
		else = {
			country_event = { id = flavor_pol.507  days = 1 }
		}
	}
	
	option = {
		name = flavor_pol.505.a
	}
}

#THE QUESTION OF MAZOVIA
country_event = { 
	id = flavor_pol.506
	title = "flavor_pol.title.506"
	desc = "flavor_pol.desc.506"
	picture = DEATH_OF_HEIR_eventPicture
	is_triggered_only = yes
	trigger = {
		tag = POL
		MAZ = { exists = yes }
	}
	
	
	option = { #fully accept everything
		name = "option.flavor_pol.506.a"
		custom_tooltip = custom.option.flavor_pol.506.a
		ai_chance = { factor = 10 }
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Mazovia became independent:flavor_pol.506"
		MAZ = { 
			grant_independence_effect = yes 
		}
		if = { 
			limit = {
				257 = { #Plock
					owned_by = POL
				}
			}
			257 = { cede_province = MAZ }
			log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Plock ceded to Mazovia:flavor_pol.506"
		}
		if = { 
			limit = {
				2506 = { #Wizna
					owned_by = POL
				}
			}
			2506 = { cede_province = MAZ }
			log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Wizna ceded to Mazovia:flavor_pol.506"
		}
		if = { 
			limit = {
				2815 = { #Dobrzyn
					owned_by = POL
				}
			}
			2815 = { cede_province = MAZ }
			log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Dobrzyn ceded to Mazovia:flavor_pol.506"
		}
		hidden_effect = {
			if = { 
				limit = { 
					HUN = { 
						ai = yes
						overlord_of = POL
					}
				}
				HUN = {
					create_guarantee = MAZ
				}
			}
			MAZ = {
				add_trust = { 
					who = POL 
					value = 40
				}
			}
		}
	}
	
	option = { #not cede provinces
		name = "option.flavor_pol.506.b"
		ai_chance = { factor = 10 }
		custom_tooltip = custom.option.flavor_pol.506.b
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Mazovia became independent, no provinces ceded:flavor_pol.506"
		MAZ = { 
			grant_independence_effect = yes 
			set_country_flag = pol_meh_rights
		}
		hidden_effect = {
			if = { 
				limit = { 
					HUN = { ai = yes }
				}
				HUN = {
					create_guarantee = MAZ
				}
			}
		}
	}
}

#THE QUESTION OF MAZOVIA
country_event = { 
	id = flavor_pol.507
	title = "flavor_pol.title.507"
	desc = "flavor_pol.desc.507"
	picture = DEATH_OF_HEIR_eventPicture
	is_triggered_only = yes
	trigger = {
		tag = POL
		MAZ = { exists = yes }
	}
	immediate = {  
	}
	
	option = { #fully accept everything
		name = "option.flavor_pol.507.a"
		ai_chance = { factor = 70 }
		custom_tooltip = custom.option.flavor_pol.506.a
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Mazovia became independent:flavor_pol.507"
		MAZ = { 
			grant_independence_effect = yes 
		}
		if = {
			limit = { ai = yes }
			POL = {
				create_guarantee = MAZ
			}
		}
		MAZ = {
			add_trust = { 
				who = POL 
				value = 40
			}
		}
		add_truce_with = MAZ
	}
	
	option = { #Mazovia caves
		name = "option.flavor_pol.507.b"
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Mazovia did not became independent:flavor_pol.507"
		custom_tooltip = custom.option.flavor_pol.507.b
		ai_chance = { factor = 100 }
		trigger = {
			legitimacy = 75
		}
	}
	
	option = { #Mazovia rebels
		name = "option.flavor_pol.507.c"
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Mazovia did not became independent:flavor_pol.507"
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, war started over Mazovian vassalage:flavor_pol.507"
		ai_chance = { factor = 30 }
		trigger = {
			NOT = { legitimacy = 75 }
		}
		MAZ = {
			add_trust = { 
				who = POL 
				value = -40
			}
			set_country_flag = pol_dennied_rights
			add_opinion = {
				who = POL
				modifier = dishonoured_agreement
			}
		}
		declare_war_with_cb = {
			who = MAZ
			casus_belli = cb_vassalize_mission
		}
	}
}

#HUNGARIAN CAPET-ANJOU SUCCESSION (Louis or whoever got a woman heir)
country_event = {
	id = flavor_pol.302
	title = "flavor_pol.302.title"
	desc = "flavor_pol.302.desc"
	picture = JADWIGA_OATH_eventPicture
	
	major = yes
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		tag = POL
		junior_union_with = HUN
		OR = {
			has_country_flag = pol_louis_great_king
			has_country_flag = pol_louis_son_great_king
			has_country_flag = woman_great_king
		}
		HUN = {
			is_lesser_in_union = no
			OR = {
				AND = {
					is_female = yes
                    has_consort_regency = no
				}
                AND = {
					is_female = yes
					has_regency = no
				}
				AND = {
					has_consort_regency = yes
					has_female_heir = yes
                    has_heir = yes
				}
				AND = {
					has_regency = yes
					has_female_heir = yes
                    has_heir = yes
				}
			}
		}
	}
	
	option = { # Jadwiga
		name = "flavor_pol.302.a"
		ai_chance = { factor = 85 }
		trigger = {
			has_country_flag = pol_louis_great_king
			is_year = 1374
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Jadwiga became a ruler of Poland:flavor_pol.302"
		if = {
			limit = {
				junior_union_with = HUN
			}
			hidden_effect = {
				break_union = HUN
			}
		}
		define_ruler = {
			name = "Interregnum"
			regency = yes
		}
		define_heir = {
			name = "Jadwiga"
			dynasty = "d'Anjou"
			claim = 20
			birth_date = 1373.10.3
			adm = 5
			dip = 5
			mil = 4
			female = yes
		}
		set_heir_flag = jadwiga
		#in exchange for nobles support for woman taking a throne, they were granted tax privilege
		if = {
			limit = { #if they are already at level 4 of tax exemption, increase tax exemption only once and service exemption instead
				Privilege_HasGreater = { Privilege=NOTaxE Lvl=3 } 
			}
			Privilege_NOTaxERaise = yes
			##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
			Privilege_NOServiceERaise = { costs = yes }
			##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Service Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
		}
		else = {
			Privilege_NOTaxERaise = yes
			##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
			Privilege_NOTaxERaise = yes
			##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
		}
		#re-calculate rights priorities calculation
		if = {
			limit = {
				ai = yes
			}
			hidden_effect = {
				set_country_flag = AITax_Yearly # Refire Tax Calculation
			}
		}
	}
	
	option = { # Random woman
		name = "flavor_pol.302.c"
		ai_chance = { factor = 5 }
		trigger = {
			OR = {
				has_country_flag = pol_louis_son_great_king
				has_country_flag = woman_great_king
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:d'Anjou woman (not Jadwiga) became a ruler of Poland:flavor_pol.302"
		if = {
			limit = {
				junior_union_with = HUN
			}
			hidden_effect = {
				break_union = HUN
			}
		}
		define_ruler = {
			dynasty = "d'Anjou"
			claim = 20
			female = yes
		}
		#in exchange for nobles support for woman taking a throne, they were granted tax privilege
		if = {
			limit = { #if they are already at level 4 of tax exemption, increase tax exemption only once and service exemption instead
				Privilege_HasGreater = { Privilege=NOTaxE Lvl=3 } 
			}
				Privilege_NOTaxERaise = yes
				##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
				Privilege_NOServiceERaise = { costs = yes }
				##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Service Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"	
			else = {
				Privilege_NOTaxERaise = yes
				##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
				Privilege_NOTaxERaise = yes
				##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
			}
		}
		#re-calculate rights priorities calculation
		if = {
			limit = {
				ai = yes
			}
			hidden_effect = {
				set_country_flag = AITax_Yearly # Refire Tax Calculation
			}
		}
	}
	
	option = { # stay in the pu
		name = "flavor_pol.302.f"
		trigger = {
			NOT = { HUN = { has_country_flag = looking_for_heir } }
			HUN = { is_lesser_in_union = no }
		}
		ai_chance = { 
			factor = 5
			modifier = {
				factor = 0
				NOT = {
					HUN = {
						dynasty = "d'Anjou"
					}
				}
			}	
		}
		HUN = {
		    create_subject = {
			    subject_type = temporary_union
			    subject = POL
		    }
		}
		add_liberty_desire = -20
		log = "FE-POL:[GetYear]:[Root.GetName]:stayed in PU (d'Anjou woman had not became a ruler of Poland):flavor_pol.302"
	}
	
	option = { #We shall choose a Piast!
		name = "flavor_pol.3023.e"
		ai_chance = { factor = 5 }
		trigger = {
			NOT = { HUN =  { has_ruler = "Louis the Great" } }
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, declined PU under Hungary (without Louis):flavor_pol.501"
		hidden_effect = {
		    Pol_ChangeGovMonarchy = { Succession=4 Assembly=2 }
        }
		if = {
		    limit = { 
			    MAZ = {
				    exists = yes
                    dynasty = "Piast"
					is_female = no
					ai = yes
                }				
			}
			hidden_effect = {
			    MAZ = {
				    exile_heir_as = heir_move_to_poland
				    exile_ruler_as = { name = ruler_move_to_poland }
				}
				set_ruler = ruler_move_to_poland
			    set_heir = heir_move_to_poland
			    set_ruler_flag = elected_ruler
			}
			inherit = MAZ
		}
		else_if = {
		    limit = { 
			    any_known_country = {
                    dynasty = "Piast"
					is_female = no
					ai = yes
					NOT = { num_of_cities = 3 }
                }				
			}
			hidden_effect = {
			    random_known_country = {
				    limit = {
					    dynasty = "Piast"
						is_female = no
						ai = yes
						NOT = { num_of_cities = 3 }
					}
				    exile_heir_as = heir_move_to_poland
				    exile_ruler_as = { name = ruler_move_to_poland }
					set_country_flag = heir_to_polish_crown
				}
				set_ruler = ruler_move_to_poland
			    set_heir = heir_move_to_poland
			    set_ruler_flag = elected_ruler
			}
			every_country = {
			    limit = { has_country_flag = heir_to_polish_crown }
				ROOT = { inherit = PREV }
			}
		}
		else = {
		    define_ruler = {
				dynasty = "Piast"
				claim = 25
            }
		}
	}
	
	after = {
		clr_country_flag = pol_louis_great_king
		clr_country_flag = pol_louis_son_great_king
		clr_country_flag = woman_great_king
	}
}

#SUCCESSION OF LOUIS THE GREAT (Louis I Anjou or whoever got a son)
country_event = {
	id = flavor_pol.303
	title = "flavor_pol.3023.title"
	desc = "flavor_pol.3023.desc"
	picture = NEW_HEIR_eventPicture
	
	major = yes
	fire_only_once = yes
	is_triggered_only = yes #from on_actions
	
	trigger = {
		tag = POL
		junior_union_with = HUN
		OR = {
			has_country_flag = pol_louis_great_king
			has_country_flag = pol_louis_son_great_king
			has_country_flag = woman_great_king
		}
		HUN = {
			is_lesser_in_union = no
			OR = {
				AND = {
					is_female = no
					has_consort_regency = no
				}
				AND = {
					is_female = no
					has_regency = no
				}
				AND = {
					has_consort_regency = yes
					has_female_heir = no
					has_heir = yes
				}
				AND = {
					has_regency = yes
					has_female_heir = no
					has_heir = yes
				}
			}
		}
	}
	
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					has_country_flag = pol_louis_great_king
				}
				random_list = {
					50 = { 
						HUN = { set_country_flag = hun_will_fight_pu }
					}
					50 = {
					}
				}
			}
			else_if = {
				limit = {
					has_country_flag = pol_louis_son_great_king
				}
				random_list = {
					30 = {
						HUN = { set_country_flag = hun_will_fight_pu }
					}
					70 = {
					}
				}
			}
			else = {
				random_list = {
					20 = {
						HUN = { set_country_flag = hun_will_fight_pu }
					}
					80 = {
					}
				}
			}
		}
	}
	
	option = { # stay in the pu
		name = "flavor_pol.3023.a"
		ai_chance = {
			factor = 5
		}
		trigger = {
			has_country_flag = pol_louis_great_king
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, PU continues:flavor_pol.303"
        HUN = {
		    create_subject = {
			    subject_type = temporary_union
			    subject = POL
		    }
		}		
		add_liberty_desire = -50
	}
	option = { # stay in the pu
		name = "flavor_pol.302.b"
		ai_chance = {
			factor = 5
		}
		trigger = {
			has_country_flag = pol_louis_son_great_king
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, PU continues:flavor_pol.303"
        HUN = {
		    create_subject = {
			    subject_type = temporary_union
			    subject = POL
		    }
		}		
		add_liberty_desire = -20
	}
	
	option = { # stay in the pu 
		name = "flavor_pol.302.b"
		ai_chance = {
			factor = 5
		}
		trigger = {
			has_country_flag = woman_great_king
		}
		HUN = {
		    create_subject = {
			    subject_type = temporary_union
			    subject = POL
		    }
		}
		add_liberty_desire = -10
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, PU continues:flavor_pol.303"	
	}
		
	option = { # polands nobility doesnt accept heir
		name = "flavor_pol.3023.e"
		ai_chance = { 
			factor = 25
			modifier = {
				factor = 2
				NOT = {	HUN = {	dynasty = "d'Anjou"	} }
			}
		}
		custom_tooltip = custom.flavor_pol.3023.e
		POL = { break_union = HUN }
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, Polish nobility doesn't accept his heir:flavor_pol.303"	
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, end of personal union:flavor_pol.303"	
		hidden_effect = {
			HUN = {
				country_event = { id = flavor_hun.90 days = 5 }
			}
		}
		hidden_effect = {
		    Pol_ChangeGovMonarchy = { Succession=4 Assembly=2 }
        }
		if = {
		    limit = { 
			    MAZ = {
				    exists = yes
                    dynasty = "Piast"
					is_female = no
					ai = yes
                }				
			}
			hidden_effect = {
			    MAZ = {
				    exile_heir_as = heir_move_to_poland
				    exile_ruler_as = { name = ruler_move_to_poland }
				}
				set_ruler = ruler_move_to_poland
			    set_heir = heir_move_to_poland
			    set_ruler_flag = elected_ruler
			}
			inherit = MAZ
		}
		else_if = {
		    limit = { 
			    any_known_country = {
                    dynasty = "Piast"
					is_female = no
					ai = yes
					NOT = { num_of_cities = 3 }
                }				
			}
			hidden_effect = {
			    random_known_country = {
				    limit = {
					    dynasty = "Piast"
						is_female = no
						ai = yes
						NOT = { num_of_cities = 3 }
					}
				    exile_heir_as = heir_move_to_poland
				    exile_ruler_as = { name = ruler_move_to_poland }
					set_country_flag = heir_to_polish_crown
				}
				set_ruler = ruler_move_to_poland
			    set_heir = heir_move_to_poland
			    set_ruler_flag = elected_ruler
			}
			every_country = {
			    limit = { has_country_flag = heir_to_polish_crown }
				ROOT = { inherit = PREV }
			}
		}
		else = {
		    define_ruler = {
				dynasty = "Piast"
				claim = 25
            }
		}
	}
	
	option = { # jadwiga
		name = "flavor_pol.302.a"
		trigger = {
			is_year = 1374
		}
		ai_chance = { 
			factor = 60
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, Jadwiga becomes ruler:flavor_pol.303"	
		custom_tooltip = custom.flavor_pol.3023.f
		break_union = HUN
		define_ruler = {
			name = "Interregnum"
			regency = yes
		}
		define_heir = {
			name = "Jadwiga"
			dynasty = "d'Anjou"
			claim = 20
			birth_date = 1373.10.3
			adm = 5
			dip = 5
			mil = 4
			female = yes
		}
		set_heir_flag = jadwiga
		#in exchange for nobles support for woman taking a throne, they were granted tax privilege
		if = {
			limit = { #if they are already at level 4 of tax exemption, increase tax exemption only once and service exemption instead
				Privilege_HasGreater = { Privilege=NOTaxE Lvl=3 } 
			}
			Privilege_NOTaxERaise = yes
			##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
			Privilege_NOServiceERaise = { costs = yes }
			##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Service Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
		}
		else = {
			Privilege_NOTaxERaise = yes
			##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
			Privilege_NOTaxERaise = yes
			##UNCOMMENTFORLOG log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
		}
		#re-calculate rights priorities calculation
		if = {
			limit = {
				ai = yes
			}
			hidden_effect = {
				set_country_flag = AITax_Yearly # Refire Tax Calculation
			}
		}
		
		hidden_effect = {
			if = {
				limit = {
					has_country_flag = pol_louis_great_king
					HUN = { 
						AND = {	
							dynasty = "d'Anjou"
							is_female = no
							has_regency = no
							has_consort_regency = no
						}
					}
				}
				HUN = { 
					set_country_flag = more_chance_of_cb
				}
			}
			if = {
				limit = {
					HUN = { 
						OR = {
							AND = {
								is_female = no	
								dynasty = "d'Anjou"
								has_consort_regency = no
								has_regency = no
							}
							AND = {	
								OR = {
									has_regency = yes
									has_consort_regency = yes
								}
								has_female_heir = no
								legitimacy = 75
							}
						}
					}
				}
				HUN = { country_event = { id = flavor_pol.801 days = 1 } }
			}
		}
	}
	
	after = {
		clr_country_flag = pol_louis_great_king
		clr_country_flag = pol_louis_son_great_king
		clr_country_flag = woman_great_king
	}
}

#THE POLAND SUCCESSION (Hungary male decides if he gets the cb or not)
country_event = {
	id = flavor_pol.801
	title = "flavor_pol.801.t"
	desc = "flavor_pol.801.d"
	picture = COURT_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes 
	
	immediate = {
		hidden_effect = {
			remove_casus_belli = {
				target = POL
				type = cb_restore_personal_union
			}
		}
	}
	
	option = { ### hungary male will claim
		name = "flavor_pol.801.a"
		ai_chance = {
			factor = 20
			modifier = {
				factor = 3
				has_country_flag = more_chance_of_cb
			}
			modifier = {
				factor = 2
				legitimacy = 60
			}
			modifier = {
				factor = 2.5
				legitimacy = 75
			}
			modifier = {
				factor = 3
				legitimacy = 90
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:male heir makes claim to Polish throne:flavor_pol.303"
		add_casus_belli = {
			target = POL 
			type = cb_restore_personal_union
			months = 300
		}
		add_opinion = {
			who = POL
			modifier = opinion_spurned_pu
		}
		tooltip = {
			POL = {
				add_opinion = {
					who = HUN
					modifier = dishonoured_agreement
				}
			}
		}
		hidden_effect = {
			POL = { country_event = { id = flavor_pol.802 days = 1 } }
		}
	}
	
	option = { ### hungary male doesn't do a thing
		name = "flavor_pol.801.b"
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0.5
				has_country_flag = more_chance_of_cb
			}
		}
		add_prestige = -10
		log = "FE-POL:[GetYear]:[Root.GetName]:male heir do not make claims to Polish throne:flavor_pol.303"
		tooltip = {
			remove_casus_belli = {
				target = POL
				type = cb_restore_personal_union
			}
		}
	}
	
	after = {
		clr_country_flag = more_chance_of_cb
	}
}

#HUNGARY CLAIMS POLAND (Poland informed)
country_event = {
	id = flavor_pol.802
	title = "flavor_pol.802.t"
	desc = "flavor_pol.802.d"
	picture = COURT_eventPicture
	
	is_triggered_only = yes 
	
	immediate = {
	}
	
	option = { ### hungary male will claim
		name = "flavor_pol.802.a"
		tooltip = {
			HUN = {
				add_casus_belli = {
					target = POL 
					type = cb_restore_personal_union
					months = 300
				}
			}
		}
		add_opinion = {
			who = HUN
			modifier = dishonoured_agreement
		}
	}
}

#THE QUESTION OF POLAND (Hungary fights por PU)
country_event = {
	id = flavor_hun.90
	title = "flavor_hun.90.t"
	desc = "flavor_hun.90.d"
	picture = COURT_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes ##by POL flavor_pol.3023
	
	immediate = {
	}
	
	option = { ### hungary fights
		name = "flavor_hun.90.a"
		ai_chance = {
			factor = 1
			modifier = {
				factor = 100
				has_country_flag = hun_will_fight_pu
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:male heir declared war over claims to Polish throne:flavor_hun.90"
		declare_war_with_cb = {
			who = POL
			casus_belli = cb_restore_personal_union
		}
	}
	
	option = { ### hungary lets poland go
		name = "flavor_hun.90.b"
		ai_chance = {
			factor = 99
			modifier = {
				factor = 0
				has_country_flag = hun_will_fight_pu
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:male heir decided not to start war over claims to Polish throne:flavor_hun.90"
		log = "FE-POL:[GetYear]:[Root.GetName]:end of Polish-Hungarian union:flavor_hun.90"
		
		POL = {
			if = {
				limit = {
					junior_union_with = HUN
				}
				break_union = HUN
			}			
		}
	}
	
	after = {
		clr_country_flag = hun_will_fight_pu
	}
}

### POLISH-LITHUANIAN UNION ###

### POLISH-LITHUANIAN UNION (Poland has female ruler)
country_event = {
	id = flavor_pol.100
	title = "flavor_pol.100.title"
	desc = "flavor_pol.100.desc"
	picture = DIPLOMACY_eventPicture
	
	major = yes
	fire_only_once = yes
	
	trigger = {
		tag = POL
		NOT = { is_year = 1450 }
		OR = {
			AND = {
				has_regency = no
				is_female = yes
			}
			AND = {
				has_regency = yes
				has_female_heir = yes
			}
		}
		LIT = {
			exists = yes
			ai = yes
			is_lesser_in_union = no
			OR = {
				is_neighbor_of = ROOT
				any_subject_country = {
					is_neighbor_of = ROOT
				}
			}
			has_regency = no
			is_female = no
		}
		NOT = { war_with = LIT }
		is_lesser_in_union = no
		NOT = { exists = PLC }
	}
	
	mean_time_to_happen = {
		months = 36
		modifier = {
			factor = 0.5
			marriage_with = LIT
		}
		modifier = {
			factor = 0.5
			LIT = { religion_group = european_pagan }
		}
		modifier = {
			factor = 3.0
			LIT = { religion = orthodox }
		}
	}

	immediate = {
		if = {
			limit = {
				is_at_war = yes
			}
			every_country = {
				limit = {
					OR = {
						is_in_war = {
							attacker_leader = THIS
							participants = ROOT
						}
						is_in_war = {
							defender_leader = THIS
							participants = ROOT
						}
					}
				}
				PREV = {
					white_peace = PREV
				}
			}
		}
		if = {
		    limit = {
			    OR = {
				    AND = {
			            has_ruler = "Jadwiga"
				        dynasty = "d'Anjou"
				    }
					has_heir_flag = jadwiga
				}
			}
			set_country_flag = jadwiga_marriage
		}
	}
	
	option = { #Accept their Duke on the throne of Poland, but demand his christianisation
		name = "flavor_pol.100.a"
		ai_chance = { 
		    factor = 90 
		    modifier = {
				factor = 0
				LIT = { ai = no }
			}
		}
		trigger = {
			LIT = {
				religion_group = european_pagan
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Accepted Lithuanian Duke on the throne, but demanded his christianisation:flavor_pol.100"
		hidden_effect = {
		    Pol_ChangeGovMonarchy = { Succession=4 Assembly=2 }
        }		
		hidden_effect = {
			MAZ = { country_event = { id = flavor_pol.509 days = 2 } }
			if = {
				limit = {
					has_country_flag = jadwiga_marriage
				}
				POL = { country_event = { id = flavor_pol.512 days = 30 } } #Habsurg marriage
			}
		}
		hidden_effect = {
			LIT = {
				exile_heir_as = heir_move_to_poland
				exile_ruler_as = { name = ruler_move_to_poland }
				grant_independence_effect = yes
			}
			set_ruler = ruler_move_to_poland
			set_ruler_flag = elected_ruler
			if = {
			    limit = { has_country_flag = jadwiga_marriage }
			    define_consort = {
				    name = "Jadwiga"
				    dynasty = "d'Anjou"
					birth_date = 1373.10.3
				    culture = hungarian
				    country_of_origin = HUN
				    adm = 5
				    dip = 5
				    mil = 4
				    female = yes
			    }
				add_queen_personality = generous_personality
				clr_country_flag = jadwiga_marriage
			}
			log = "FE-POL:[GetYear]:[Root.GetName]:Jadwiga d'Anjou set as Queen:flavor_pol.100"
			if = {
				limit = {
					religion = catholic
				}
				set_ruler_religion = catholic
			}
			else_if = {
				limit = {
					religion = avignonist
				}
				set_ruler_religion = avignonist
			}
			create_subject = {
				subject_type = permanent_union
				subject = LIT
			}
			set_country_flag = pol_lit_union_timer	
		}
		tooltip = {
			create_union = LIT
		}
		if = {
			limit = {
				religion = catholic
				LIT = { NOT = { religion = catholic } }
			}
			LIT = { change_religion = catholic force_converted = yes }
			if = {
			    limit = { TRK = { is_subject_of = LIT } }
				TRK = { change_religion = catholic force_converted = yes }
			}
		}
		else_if = {
			limit = {
				religion = avignonist
				LIT = { NOT = { religion = avignonist } }
			}
			LIT = { change_religion = avignonist force_converted = yes }
			if = {
			    limit = { TRK = { is_subject_of = LIT } }
				TRK = { change_religion = avignonist force_converted = yes }
			}
		}
		else_if = {
			limit = {
				religion = orthodox
				LIT = { NOT = { religion = orthodox } }
			}
			LIT = { change_religion = orthodox force_converted = yes }
			if = {
			    limit = { TRK = { is_subject_of = LIT } }
				TRK = { change_religion = orthodox force_converted = yes }
			}
		}
		POL = {
			set_country_flag = female_pol_lit_union_female
			add_historical_friend = LIT
		}
		add_opinion = {
			who = LIT
			modifier = pol_lit_union
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union
			}
			add_historical_friend = POL
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = warlord_rebels
				size = 2
			}
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = warlord_rebels
				size = 2
			}
		}
		every_known_country = {
			limit = {
				marriage_with = LIT
			}
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_negative
			}
		}
	}
	option = { # Accept their King on the throne of Poland
		name = "flavor_pol.100.b"
		ai_chance = { 
		    factor = 90 
		    modifier = {
				factor = 0
				LIT = { ai = no }
			}
		}
		trigger = {
			LIT = {
				religion_group = christian
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Accepted Lithuanian Duke on the throne, he was already Christian:flavor_pol.100"
		hidden_effect = {
		    Pol_ChangeGovMonarchy = { Succession=4 Assembly=2 }
        }
		hidden_effect = {
			MAZ = { country_event = { id = flavor_pol.509 days = 2 } } #Mazovia vassalization
			if = {
				limit = {
					has_country_flag = jadwiga_marriage
				}
				POL = { country_event = { id = flavor_pol.512 days = 30 } } #Habsurg marriage
			}
		}
		hidden_effect = {
			LIT = {
				exile_heir_as = heir_move_to_poland
				exile_ruler_as = { name = ruler_move_to_poland }
				grant_independence = yes
				grant_independence_effect = yes
			}
			set_ruler = ruler_move_to_poland
			set_heir = heir_move_to_poland
			set_ruler_flag = elected_ruler
			if = {
			    limit = { has_country_flag = jadwiga_marriage }
			    define_consort = {
				    name = "Jadwiga"
				    dynasty = "d'Anjou"
					birth_date = 1373.10.3
				    culture = hungarian
				    country_of_origin = HUN
				    adm = 5
				    dip = 5
				    mil = 4
				    female = yes
			    }
				add_queen_personality = generous_personality
				clr_country_flag = jadwiga_marriage
			}
			
			if = {
				limit = {
					religion = catholic
				}
				set_ruler_religion = catholic
				set_heir_religion = catholic
			}
			else_if = { 
				limit = {
					religion = avignonist
				}
				set_ruler_religion = avignonist
				set_heir_religion = avignonist
			}

			create_subject = { 
				subject_type = permanent_union
				subject = LIT
			}
			set_country_flag = pol_lit_union_timer
		}
		tooltip = {
			create_union = LIT
		}
		add_opinion = {
			who = LIT
			modifier = pol_lit_union
		}
		POL = {
			set_country_flag = female_pol_lit_union_female
			add_historical_friend = LIT
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union
			}
			add_historical_friend = POL
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = warlord_rebels
				size = 2
			}
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = warlord_rebels
				size = 2
			}
		}
		every_known_country = {
			limit = {
				marriage_with = LIT
			}
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_negative
			}
		}
	}
	option = { #No, let us marry the Piast
		name = "flavor_pol.100.c"
		ai_chance = { factor = 10 }
		log = "FE-POL:[GetYear]:[Root.GetName]:Rejected Lithuanian Duke on the throne, married Piast duke:flavor_pol.100"
		hidden_effect = {
		    Pol_ChangeGovMonarchy = { Succession=4 Assembly=2 }
        }
		hidden_effect = {
			if = {
				limit = {
					has_country_flag = jadwiga_marriage
				}
				POL = { country_event = { id = flavor_pol.512 days = 30 } } #Habsurg marriage
			}
		}
		if = {
		    limit = { 
			    MAZ = {
				    exists = yes
                    dynasty = "Piast"
					is_female = no
					ai = yes
                }				
			}
			hidden_effect = {
			    MAZ = {
				    exile_heir_as = heir_move_to_poland
				    exile_ruler_as = { name = ruler_move_to_poland }
				}
				set_ruler = ruler_move_to_poland
			    set_heir = heir_move_to_poland
			    set_ruler_flag = elected_ruler
			}
			inherit = MAZ
		}
		else_if = {
		    limit = { 
			    any_known_country = {
                    dynasty = "Piast"
					is_female = no
					ai = yes
                }				
			}
			hidden_effect = {
			    random_known_country = {
				    limit = {
					    dynasty = "Piast"
						is_female = no
						ai = yes
					}
				    exile_heir_as = heir_move_to_poland
				    exile_ruler_as = { name = ruler_move_to_poland }
					set_country_flag = heir_to_polish_crown
				}
				set_ruler = ruler_move_to_poland
			    set_heir = heir_move_to_poland
			    set_ruler_flag = elected_ruler
			}
			every_country = {
			    limit = { has_country_flag = heir_to_polish_crown }
				ROOT = { inherit = PREV }
			}
		}
		else = {
		    define_ruler = {
				dynasty = "Piast"
				claim = 25
            }
		}
		
		if = {
			limit = { has_country_flag = jadwiga_marriage }
			define_consort = {
		        name = "Jadwiga"
		        dynasty = "d'Anjou"
			    birth_date = 1373.10.3
		        culture = hungarian
				country_of_origin = HUN
				adm = 5
				dip = 5
				mil = 4
				female = yes
			}
		    add_queen_personality = generous_personality
			clr_country_flag = jadwiga_marriage
		}
		
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_declined
			}
			add_casus_belli = {
					target = POL 
					type = cb_restore_personal_union
					months = 120
			}
		}
	}
	after = {
	    set_global_flag = plc_union_outcome_flag
	}
}

#POLISH-LITHUANIAN UNION (Lithuania has female ruler) 
country_event = {
	id = flavor_pol.101
	title = "flavor_pol.101.title"
	desc = "flavor_pol.101.desc"
	picture = DIPLOMACY_eventPicture
	
	major = yes
	fire_only_once = yes
	
	trigger = {
		tag = POL
		NOT = { is_year = 1450 }
		OR = {
			AND = {
				has_regency = no
				is_female = no
			}
			AND = {
				has_regency = yes
				has_female_heir = no
			}
		}
		LIT = {
			exists = yes
			ai = yes
			is_lesser_in_union = no
			OR = {
				is_neighbor_of = ROOT
				any_subject_country = {
					is_neighbor_of = ROOT
				}
			}
			OR = {
				AND = {
					has_regency = no
					is_female = yes
				}
				AND = {
					has_regency = yes
					has_female_heir = yes
				}
			}
		}
		NOT = { war_with = LIT }
		is_lesser_in_union = no
		NOT = { exists = PLC }
	}
	
	mean_time_to_happen = {
		months = 24
		modifier = {
			factor = 0.5
			marriage_with = LIT
		}
		modifier = {
			factor = 0.25
			LIT = { religion_group = european_pagan }
		}
		modifier = {
			factor = 3.0
			LIT = { religion = orthodox }
		}
	}
	
	option = {		# Accept the crown of Grand Duchy and demand its christianisation
		name = "flavor_pol.101.a"
		ai_chance = { factor = 100 }
		log = "FE-POL:[GetYear]:[Root.GetName]:Accepted the crown of Lithuanian Grand Duchy, but demanded its christianisation:flavor_pol.101"
		trigger = {
			LIT = {
				religion_group = european_pagan
			}
		}
		create_subject = { 
			subject_type = permanent_union
			subject = LIT
		}

		if = {
			limit = {
				religion = catholic
				LIT = { NOT = { religion = catholic } }
			}
			#LIT = { set_country_flag = lit_become_catholic }
			LIT = { change_religion = catholic force_converted = yes }
		}
		else_if = {
			limit = {
				religion = avignonist
				LIT = { NOT = { religion = avignonist } }
			}
			LIT = { change_religion = avignonist force_converted = yes }
		}
		else_if = {
			limit = {
				religion = orthodox
				LIT = { NOT = { religion = orthodox } }
			}
			#LIT = { set_country_flag = lit_become_orthodox }
			LIT = { change_religion = orthodox force_converted = yes }
		}
		
		add_opinion = {
			who = LIT
			modifier = pol_lit_union
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union
			}
			add_historical_friend = POL
		}
		add_historical_friend = LIT
		
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		every_known_country = {
			limit = {
				marriage_with = LIT
			}
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_negative
			}
		}
		hidden_effect = {
			MAZ = { country_event = { id = flavor_pol.509 days = 2 } }
			set_country_flag = pol_lit_union_timer
		}
	}
	
	option = {		# Accept the crown of Grand Duchy
		name = "flavor_pol.101.b"
		ai_chance = { factor = 100 }
		trigger = {
			LIT = {
				religion = catholic
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Accepted the crown of Lithuanian Grand Duchy, have not demanded its christianisation:flavor_pol.101"
		create_subject = { 
			subject_type = permanent_union
			subject = LIT
		}
		add_opinion = {
			who = LIT
			modifier = pol_lit_union
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union
			}
			add_historical_friend = POL
		}
		add_historical_friend = LIT
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		every_known_country = {
			limit = {
				marriage_with = LIT
			}
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_negative
			}
		}
		hidden_effect = {
			MAZ = { country_event = { id = flavor_pol.509 days = 2 } }
			set_country_flag = pol_lit_union_timer
		}
	}
	
	option = {		# Seach for an appropriate Polish bride
		name = "flavor_pol.101.c"
		log = "FE-POL:[GetYear]:[Root.GetName]:Rejected the crown of Lithuanian Grand Duchy, married local noble:flavor_pol.101"
		ai_chance = { factor = 0 }
		Stab_Add1 = yes
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_declined
			}
		}
	}
	after = {
	    set_global_flag = plc_union_outcome_flag
	}
}

#THE POLISH-LITHUANIAN UNION (Mazovian vassalization)
country_event = {
	id = flavor_pol.509
	title = "flavor_pol.509.t"
	desc = "flavor_pol.509.d"
	picture = COURT_eventPicture
	is_triggered_only = yes 
	
	trigger = {
		MAZ = { is_subject = no }
	}
		
	option = { ### Mazovia becomes loyal again
		name = "flavor_pol.509.a"
		ai_chance = {
			factor = 99
			modifier = {
				factor = 0.5
				has_country_flag = pol_dennied_rights
			}
			modifier = {
				factor = 0.3
				has_country_flag = pol_meh_rights
			}
		}
		tooltip = {
			POL = { vassalize = MAZ }
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:became loyal to Poland again:flavor_pol.509"
		hidden_effect = {
			POL = { 
				country_event = { id = flavor_pol.510 days = 1 }
			}
		}
	}
	
	option = { ### mazovia rawr
		name = "flavor_pol.509.b"
		ai_chance = {
			factor = 1
			modifier = {
				factor = 50
				has_country_flag = pol_dennied_rights
			}
			modifier = {
				factor = 30
				has_country_flag = pol_meh_rights
			}
		}
		tooltip = {
			POL = {
				add_casus_belli = {
					target = MAZ
					type = cb_vassalize_mission
					months = 60
				}
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:did not became loyal to Poland again:flavor_pol.509"
		hidden_effect = {
			POL = { 
				country_event = { id = flavor_pol.511 days = 1 }
			}
		}
	}
	
	after = {
		clr_country_flag = pol_dennied_rights
		clr_country_flag = pol_meh_rights
	}
}

###THE MAZOVIAN ALLEGIANCE (Poland notification Mazovia becomes a vassal)
country_event = {
	id = flavor_pol.510
	title = "flavor_pol.510.t"
	desc = "flavor_pol.510.d"
	picture = COURT_eventPicture
	is_triggered_only = yes	
	
	option = { ### Mazovia becomes loyal again
		name = "flavor_pol10.a"
		create_subject = {
			subject_type = appanage_subject #it's more historical outcome than simple vassalization
			subject = MAZ
		}
		add_prestige = 20
		MAZ = { 
			add_trust = {
				who = POL
				value = 50
				mutual = yes
			}
		}
	}
}

#THE MAZOVIAN DISRESPECT (Poland notification Mazovia won't become a vassal)
country_event = {
	id = flavor_pol.511
	title = "flavor_pol.511.t"
	desc = "flavor_pol.511.d"
	picture = COURT_eventPicture
	is_triggered_only = yes 
	
	
	option = { ### Mazovia rawr
		name = "flavor_pol11.a"
		add_casus_belli = {
			target = MAZ
			type = cb_vassalize_mission
			months = 60
		}
	}
}

###ROYAL TIES WITH AUSTRIA
country_event = {
	id = flavor_pol.512
	title = "flavor_pol.512.t"
	desc = "flavor_pol.512.d"
	picture = COURT_eventPicture
	
	is_triggered_only = yes 
	
	option = { ### Pay austria
		name = "flavor_po512.a"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				NOT = { treasury = 51 }
			}
			modifier = {
				factor = 0.5
				NOT = { LIT = { treasury = 51 } }
			}
		}
		add_treasury = -50
		LIT = { add_treasury = -50 }
		tooltip = {
			HAB = { add_treasury = 100 }
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:paid compensation for Jadwiga behtrotal to Habsburgs:flavor_pol.512"
		hidden_effect = {
			HAB = { country_event = { id = flavor_pol.513 days = 1 } }
		}
	}
	
	option = { ### Don't pay
		name = "flavor_po512.b"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.5
				NOT = { treasury = 51 }
			}
			modifier = {
				factor = 1.5
				NOT = { LIT = { treasury = 51 } }
			}
		}
		tooltip = {
			HAB = {
				add_casus_belli = {
					target = POL 
					type = cb_restore_personal_union
					months = 300
				}
				add_trust = {
					who = POL
					value = -30
				}
				add_opinion = {
					who = POL
					modifier = break_marriage
				}	
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:refused to pay compensation for Jadwiga behtrotal to Habsburgs:flavor_pol.512"
		hidden_effect = {
			HAB = { country_event = { id = flavor_pol.514 days = 1 } }
		}
	}
}

###POLISH MARRIAGE CONTROVERSY (Poland paid)
country_event = {
	id = flavor_pol.513
	title = "flavor_pol.513.t"
	desc = "flavor_pol.513.d"
	picture = COURT_eventPicture
	
	is_triggered_only = yes 
	
	option = { 
		name = "flavor_po513.a"
		add_treasury = 100
		add_opinion = {
			who = POL
			modifier = opinion_spurned_heir
		}	
	}
}

###POLISH MARRIAGE CONTROVERSY (Poland didn't pay)
country_event = {
	id = flavor_pol.514
	title = "flavor_pol.514.t"
	desc = "flavor_pol.514.d"
	picture = COURT_eventPicture
	
	is_triggered_only = yes 

	option = { 
		name = "flavor_po514.a"
		add_casus_belli = {
			target = POL 
			type = cb_restore_personal_union
			months = 300
		}
		add_opinion = {
			who = POL
			modifier = break_marriage
		}	
		add_trust = {
			who = POL
			value = -30
		}
	}
}

#DYNASTY FOR NEW KING! (Create dynasty after Polish-Lithuanian union)
country_event = {
	id = flavor_pol.305
	title = "flavor_pol.305.title"
	desc = "flavor_pol.305.desc"
	picture = NEW_HEIR_eventPicture
	is_triggered_only = yes #from on_monarch_death
	fire_only_once = yes
	
	trigger = {
		tag = POL
		dynasty = "Gediminai"
	}
		
	option = {
		name = "flavor_pol.305.a"
		ai_chance = { factor = 5 }
		set_dynasty = "Piast"
		custom_tooltip = flavor_pol.305.a.tooltip
		log = "FE-POL:[GetYear]:[Root.GetName]:changed dynasty name to Piast:flavor_pol.305"
	}
	option = {
		name = "flavor_pol.305.b"
		ai_chance = { factor = 5 }
		log = "FE-POL:[GetYear]:[Root.GetName]:kept dynasty name as Gediminai:flavor_pol.305"
	}
	option = {
		name = "flavor_pol.305.c"
		ai_chance = { factor = 90 }
		set_dynasty =  "Jagiellon" 
		custom_tooltip = flavor_pol.305.c.tooltip
		log = "FE-POL:[GetYear]:[Root.GetName]:changed dynasty name to Jagiellon:flavor_pol.305"
	}
}

###POLISH LITHUANIAN-CLAIMS FOR PODLASIA
country_event = {
	id = flavor_pol.313
	title = "flavor_pol.313.title"
	desc = "flavor_pol.313.desc"
	picture = DIPLOMACY_eventPicture
	fire_only_once = yes
	trigger = {
		tag = POL
		is_at_war = no
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
				is_subject_of_type = decentralized_vassal
			}
		}
		dip_tech = 24
		LIT = {
			OR = {
				owns_or_vassal_of = 271  #Bialystok
				owns_or_vassal_of = 3759 #Drohiczyn
				owns_or_vassal_of = 3763 #Bielskas
			}
		}
		OR = { #event is about Mazowsze nobles interests
			owns_or_vassal_of = 4026  #Ciechanow
			owns_or_vassal_of = 2816 #Liw
		}
	}
	mean_time_to_happen = {
		years = 10
	}
	option = {
		name = "flavor_pol.313.a"
		trigger = {
			NOT = {
				LIT = {
					has_opinion = {
						who = ROOT
						value = 150
					}
				}
			}
		}

		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 271
				}
			}
			log = "FE-POL:[GetYear]:[271.Owner.GetName]:ceded Bialystok to Poland:flavor_pol.313"
			271 = { #Bialystok
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 2
				}
			}
		}
		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 3759
				}
			}
			log = "FE-POL:[GetYear]:[3759.Owner.GetName]:ceded Drohiczyn to Poland:flavor_pol.313"
			3759 = { #Drohiczyn
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 2
				}
			}
		}
		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 3763
				}
			}
			log = "FE-POL:[GetYear]:[3763.Owner.GetName]:ceded Bielskas to Poland:flavor_pol.313"
			3763 = { #Bielskas
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 2
				}
			}
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = ceded_podlasia
			}
		}
		Pol_ChangeRelationsStateTooltip = { NO=yes type=value val=5 }

		hidden_effect = {
			every_province = {
				limit = { 
					area = mazovia_area 
					owner = {
						OR = {
							tag = ROOT
							vassal_of = ROOT
						}
					}
				}
				Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=10 }
			}
		}
		custom_tooltip = mazovia_NO_loy_plus_10_tt
	}
	option = {
		name = "flavor_pol.313.b"
		trigger = {
			LIT = {
				has_opinion = {
					who = ROOT
					value = 150
				}
			}
		}
		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 271
				}
			}
			log = "FE-POL:[GetYear]:[271.Owner.GetName]:ceded Bialystok to Poland:flavor_pol.313"
			271 = { #Bialystok
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 1
				}
			}
		}
		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 3759
				}
			}
			log = "FE-POL:[GetYear]:[3759.Owner.GetName]:ceded Drohiczyn to Poland:flavor_pol.313"
			3759 = { #Drohiczyn
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 1
				}
			}
		}
		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 3763
				}
			}
			log = "FE-POL:[GetYear]:[3763.Owner.GetName]:ceded Bielskas to Poland:flavor_pol.313"
			3763 = { #Bielskas
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 1
				}
			}
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = ceded_podlasia
			}
		}
		Pol_ChangeRelationsStateTooltip = { NO=yes type=value val=5 }
		hidden_effect = {
			every_province = {
				limit = { 
					area = mazovia_area 
					owner = {
						OR = {
							tag = ROOT
							vassal_of = ROOT
						}
					}
				}
				Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=10 }
			}
		}
		custom_tooltip = mazovia_NO_loy_plus_10_tt
	}
	option = {
		name = "flavor_pol.313.c"
		add_prestige = -5
		log = "FE-POL:[GetYear]:[Root.GetName]:have not pushed Lithuania for ceding Podolia:flavor_pol.313"
		Pol_ChangeRelationsStateTooltip = { NO=yes type=value val=-5 }
		hidden_effect = {
			every_province = {
				limit = { 
					area = mazovia_area 
					owner = {
						OR = {
							tag = ROOT
							vassal_of = ROOT
						}
					}
				}
				Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=-10 }
			}
		}
		custom_tooltip = mazovia_NO_loy_minus_10_tt
	}
}

#TERRITORIAL DISPUTES BETWEEN POLAND AND LITHUANIA
country_event = {
	id = flavor_pol.306
	title = "flavor_pol.306.title"
	desc = "flavor_pol.306.desc"
	picture = DIPLOMACY_eventPicture
	fire_only_once = yes
	trigger = {
		tag = POL
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
				is_subject_of_type = decentralized_vassal
			}		
		}
		OR = {
		    has_global_flag = ostrow_agreement
			dip_tech = 22
		}
		OR = {
			claim = LIT
			core_claim = LIT
			LIT = {
				claim = ROOT
			}
			LIT = {
				core_claim = ROOT
			}
			GVO = {
				is_subject_of = LIT
				exists = yes
				ai = yes
			}
		}
	}
	mean_time_to_happen = {
		months = 12
	}
	
	immediate = {
	    if = {
			limit = {
				GVO = {
					is_subject_of = LIT
					exists = yes
					ai = yes
				}
			}
			LIT = {
				inherit = GVO
			}
		}
	}
	
	option = { #Demand Galicia and Podolia
		name = "flavor_pol.306.a"
		ai_chance = {
			factor = 75
		}
		trigger = {
		    any_province = {
			    area = red_ruthenia_area
				owned_by = LIT
		    }
		}
		LIT = { add_liberty_desire = 10 }
		every_province = {
		    limit = {
			    owned_by = LIT
				is_core = POL
				NOT = { area = red_ruthenia_area }
				NOT = { area = podolia_volhynia_area }
			}
			cede_province = POL
		}
		every_province = {
		    limit = {
			    owned_by = LIT
				OR = {
				    area = red_ruthenia_area
					province_id = 1433 #Podolia
				}
				NOT = { province_id = 2507 } #Belz
			}
			cede_province = POL
		}
		if = {
		    limit = {
			    MAZ = {
				    exists = yes
					is_subject_of = ROOT
				}
			}
			2507 = { cede_province = MAZ }
		}
		else = {
			2507 = { cede_province = POL }
		}
		LIT = {
			custom_tooltip = flavor_pol.306.tooltip.a
			hidden_effect = {
				every_owned_province = {
					limit = {
						OR = {
							is_claim = POL
							is_core = POL
						}
					}
					remove_claim = POL
					remove_core = POL
				}
			}
		}
		POL = {
			custom_tooltip = flavor_pol.306.tooltip.b
			hidden_effect = {
				every_owned_province = {
					remove_claim = LIT
					remove_core = LIT
				}
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:removed cores and claims from Lithuania provinces:flavor_pol.306"
		log = "FE-POL:[GetYear]:[Root.GetName]:Lithuania removed cores and claims from  Polish provinces:flavor_pol.306"
		log = "FE-POL:[GetYear]:[Root.GetName]:acquired Galician and Podolian provinces while settling border dispute with Lithuania:flavor_pol.306"
	}
	
	option = { #Demand Galicia, Volhynia and Podolia
		name = "flavor_pol.306.b"
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				LIT = { NOT = { liberty_desire = 25 } }
			}
		}
		trigger = {
		    any_province = {
			    area = podolia_volhynia_area
				owned_by = LIT
		    }
		}
		LIT = { add_liberty_desire = 25 }
		if = {
		    limit = {
			    MAZ = {
				    exists = yes
					is_subject_of = ROOT
				}
			}
			MAZ = { add_liberty_desire = 25 }
		}
		every_province = {
		    limit = {
			    owned_by = LIT
				is_core = POL
				NOT = { area = red_ruthenia_area }
				NOT = { area = podolia_volhynia_area }
			}
			cede_province = POL
		}
		every_province = {
		    limit = {
			    owned_by = LIT
				area = red_ruthenia_area
			}
			cede_province = POL
		}
		every_province = {
		    limit = {
			    owned_by = LIT
				area = podolia_volhynia_area
			}
			cede_province = POL
		}
		LIT = {
			custom_tooltip = flavor_pol.306.tooltip.a
			hidden_effect = {
				every_owned_province = {
					limit = {
						OR = {
							is_claim = POL
							is_core = POL
						}
					}
					remove_claim = POL
					remove_core = POL
				}
			}
		}
		POL = {
			custom_tooltip = flavor_pol.306.tooltip.b
			hidden_effect = {
				every_owned_province = {
					remove_claim = LIT
					remove_core = LIT
				}
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:removed cores and claims from Lithuania provinces:flavor_pol.306"
		log = "FE-POL:[GetYear]:[Root.GetName]:Lithuania removed cores and claims from  Polish provinces:flavor_pol.306"
		log = "FE-POL:[GetYear]:[Root.GetName]:acquired Galician, Volhynian and Podolian provinces while settling border dispute with Lithuania:flavor_pol.306"
	}
	
	option = {
		name = "flavor_pol.306.c"
		ai_chance = {
			factor = 0
		}		
		log = "FE-POL:[GetYear]:[Root.GetName]:decided not to settle border disputes with Lithuania, maintained status quo:flavor_pol.306"
	}
}

###UNION OF KREWO
country_event = {
	id = flavor_pol.600
	title = "flavor_pol.600.title"
	desc = "flavor_pol.600.desc"
	picture = DIPLOMACY_eventPicture
	major = yes
	fire_only_once = yes
	trigger = {
		tag = POL
		#is_year = 1380
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}		
		}
		NOT = {	exists = PLC }
		NOT = {	has_country_flag = 1_union_krewo }
	}
	mean_time_to_happen = {
		years = 1
	}
	option = {
		name = "flavor_pol.600.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:signed union of Krewo:flavor_pol.600"
		ai_chance = {
			factor = 100
		}
		set_country_flag = 1_union_krewo
		tooltip = {
			custom_tooltip = flavor_pol.union_sign.1
		}
		add_dip_power = -100
		add_legitimacy = 10
		add_prestige = 10
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 10 }
		hidden_effect = {
			if = {
				limit = {
					government = monarchy
					NOT = {	absolutism = 70 }
				}
			}
		}
	}
}

###UNION OF HORODLO
country_event = {
	id = flavor_pol.601
	title = "flavor_pol.601.title"
	desc = "flavor_pol.601.desc"
	picture = DIPLOMACY_eventPicture
	major = yes
	fire_only_once = yes
	is_triggered_only = yes		#on_five_year_pulse on_action
	trigger = {
		tag = POL
		has_regency = no
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
				is_subject_of_type = decentralized_vassal
			}
		}
		has_country_flag = 1_union_krewo
		NOT = {	has_global_flag = 1530_start_date }
		NOT = {	exists = PLC }
		had_country_flag = {
			flag = pol_lit_union_timer
			days = 7300 #20 years
		}
		dip_tech = 21
	}

	option = {
		name = "flavor_pol.601.a"
		ai_chance = {
			factor = 90
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:signed union of Horodlo:flavor_pol.601"
		add_dip_power = -100
		add_prestige = 10
		LIT = {
		    Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 10 }
		}
		set_country_flag = 2_union_horodlo
		tooltip = {
			custom_tooltip = flavor_pol.union_sign.2
		}
	}
	option = {
		name = "flavor_pol.601.b"
		ai_chance = {
			factor = 10
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:refused union of Horodlo:flavor_pol.601"
		add_prestige = -10
		Stab_Add50Percent = yes
	}
}

###UNION OF GRODNO
country_event = {
	id = flavor_pol.602
	title = "flavor_pol.602.title"
	desc = "flavor_pol.602.desc"
	picture = DIPLOMACY_eventPicture
	major = yes
	fire_only_once = yes
	is_triggered_only = yes #on_five_year_pulse on_action
	trigger = {
		tag = POL
		has_regency = no
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
				is_subject_of_type = decentralized_vassal
			}		
		}
		has_country_flag = 2_union_horodlo
		NOT = {	has_global_flag = 1530_start_date }
		NOT = {	exists = PLC }
		had_country_flag = {
			flag = pol_lit_union_timer
			days = 14600 #40 years
		}
		dip_tech = 23
	}
	option = {
		name = "flavor_pol.602.a"
		ai_chance = {
			factor = 90
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:signed union of Grodno:flavor_pol.602"
		set_country_flag = 3_union_grodno
		tooltip = {
			custom_tooltip = flavor_pol.union_sign.3
		}
		add_dip_power = -100
		add_prestige = 10
		LIT = {
			add_country_modifier = {
			    name = "pol_union_of_grodno"
			    duration = -1
		    }
		}
		every_known_country = {
		    limit = { is_subject_of = LIT }
			add_country_modifier = {
			    name = "pol_union_of_grodno"
			    duration = -1
		    }
		}
	}
	option = {
		name = "flavor_pol.602.b"
		ai_chance = {
			factor = 10
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:refused union of Grodno:flavor_pol.602"
		add_prestige = -10
		Stab_Add50Percent = yes
	}
}

###UNION OF KRAKÓW AND VILNA
country_event = {
	id = flavor_pol.603
	title = "flavor_pol.603.title"
	desc = "flavor_pol.603.desc"
	picture = DIPLOMACY_eventPicture
	major = yes
	fire_only_once = yes
	is_triggered_only = yes	#on_five_year_pulse on_action
	trigger = {
		tag = POL
		has_regency = no
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}		
		}
		has_country_flag = 3_union_grodno
		NOT = {
			has_global_flag = 1530_start_date
		}
		NOT = {
			exists = PLC
		}
		had_country_flag = {
			flag = pol_lit_union_timer
			days = 36500 #100 years
		}
		dip_tech = 30
	}

	option = {
		name = "flavor_pol.603.a"
		ai_chance = {
			factor = 90
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:signed union of Krakow and Vilna:flavor_pol.603"
		set_country_flag = 4_union_krakow
		tooltip = {
			custom_tooltip = flavor_pol.union_sign.4
		}
		add_dip_power = -100
		add_prestige = 10
	}
	option = {
		name = "flavor_pol.603.b"
		ai_chance = {
			factor = 10
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:refused union of Krakow and Vilna:flavor_pol.603"
		add_prestige = -10
		Stab_Add50Percent = yes
	}
}

###UNION OF LUBLIN
country_event = {
	id = flavor_pol.604
	title = "flavor_pol.604.title"
	desc = "flavor_pol.604.desc"
	picture = UNION_LUBLIN_eventPicture
	major = yes
	fire_only_once = yes
	is_triggered_only = yes		#on_five_year_pulse on_action
	trigger = {
		tag = POL
		dip_tech = 32
		OR = {
		    has_heir = no
			dip_tech = 38
		}
		is_free_or_tributary_trigger = yes
		has_country_flag = 4_union_krakow
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}
		}
		is_at_war = no
		has_regency = no
		NOT = {	exists = PLC }
		had_country_flag = {
			flag = pol_lit_union_timer
			days = 43800  #120 years
		}
	}
	immediate = {
		hidden_effect = {
			clr_country_flag = pol_lit_union_timer
		}
	}
	option = {
		name = "flavor_pol.604.a"
		ai_chance = {
			factor = 90
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:signed union of Lublin:flavor_pol.604"
		custom_tooltip = flavor_pol.union_sign.5
		set_country_flag = 5_union_lublin
		add_dip_power = -100
		add_prestige = 10
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 10 }
		LIT = {
		    add_liberty_desire = 25
		}
	}
	option = {
		name = "flavor_pol.604.b"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				has_global_flag = 1530_start_date
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:refused union of Lublin:flavor_pol.604"
		add_prestige = -10
		Stab_Add50Percent = yes
		LIT = {
		    add_liberty_desire = -25
		}
	}
}

### ELECTION OF X (Hereditary elective monarchy mechanics for Poland)
country_event = {
	id = flavor_pol.610
	title = "flavor_pol.610.title"
	desc = "flavor_pol.610.desc"
	picture = LIBERUM_VETO_eventPicture
	
	is_triggered_only = yes #on_new_monarch on_actions
	trigger = {
		OR = {
			tag = POL
			tag = PLC
		}
		government = monarchy
		NOT = {
 			has_ruler_flag = elected_ruler
 		}
		has_reform = Pol_Succession4
		has_regency = no
	}
	
	immediate = {
 	    set_ruler_flag = elected_ruler
 	}
	option = { #Regular election
		name = "flavor_pol.610.a"
		add_legitimacy = 10
 		NO_FactionBoost = yes
		hidden_effect = {
			set_variable = {
				which = vivente_rege
				value = 0
			}
		}
	}
	option = { #Vivente rege election
		name = "flavor_pol.610.b"
		trigger = {
		    has_heir = yes
			has_female_heir = no
			OR = {
			    has_reform = Pol_Structure4
				has_reform = Pol_Structure5
			}
		}
		
		add_legitimacy = 10
		add_heir_claim = 20
		Pol_ChangeRelationsStateTooltip = { NO=yes type=value val=-10 }
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -10 }
		
		hidden_effect = {
			change_variable = {
				which = vivente_rege
				value = 1
			}
		}
		
		custom_tooltip = flavor_pol.610.tooltip.b
	}
	option = { #End of Elective Monarchy
		name = "flavor_pol.610.c"
		trigger = {
		    has_heir = yes
			has_female_heir = no
			has_reform = Pol_Structure5
			check_variable = {
			    which = vivente_rege
			    value = 2
		    }
		}
		
		Pol_ChangeRelationsStateTooltip = { NO=yes type=value val=-25 }
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -25 }
		
		random_owned_province = {
		    limit = {
			    is_capital = no
				continent = europe
				is_in_capital_area = yes
			}
			spawn_rebels = {
					type = warlord_rebels
					size = 3
			}
		}
		random_owned_province = {
		    limit = {
			    is_capital = no
				continent = europe
			}
			spawn_rebels = {
					type = warlord_rebels
					size = 2
			}
		}
		random_owned_province = {
		    limit = {
			    is_capital = no
				continent = europe
			}
			spawn_rebels = {
					type = warlord_rebels
					size = 2
			}
		}
		
		hidden_effect = {
		    Pol_ChangeGovMonarchy = { Succession=1 }
        }
        hidden_effect = {
			set_variable = {
				which = vivente_rege
				value = 0
			}
		}
        custom_tooltip = flavor_pol.610.tooltip.c        	
	}
}

### POLISH-TEUTONIC RIVALRY ###

#THE TEUTONIC ORDER (End of historical rivalry)
country_event = {
	id = flavor_pol.17
	title = flavor_pol.17.t
	desc = flavor_pol.17.d
	picture = LIBERUM_VETO_eventPicture
	fire_only_once = yes
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = {	exists = PLC }
			}
			tag = PLC
		}
		historical_rival_with = TEU
		TEU = {	is_subject_of = ROOT }
	}
	mean_time_to_happen = {
		months = 1
	}
	option = {
		name = flavor_pol.17.a
		log = "FE-POL:[GetYear]:[Root.GetName]:ended historical rivalry with Teutonic Order:flavor_pol.17"
		add_prestige = 10
		remove_historical_rival = TEU
		TEU = {
			remove_historical_rival = ROOT
		}
	}
}

###FIRST PEACE OF THORN (Polish version)
country_event = {
	id = flavor_pol.722
	title = "flavor_pol.722.title"
	desc = "flavor_pol.722.desc"
	picture = SIEGE_eventPicture
	major = yes
	trigger = { 
		tag = POL
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
				is_subject_of_type = decentralized_vassal
			}	
		}
		NOT = { exists = PLC }
		TEU = { NOT = { has_country_flag = broken_by_polish } }
		NOT = { has_country_flag = first_peace_of_thorn }
		NOT = { has_global_flag = lithuanian_civil_war	}
		war_score_against = {
			who = TEU
			value = 30
		}

	}
	fire_only_once = yes
	
	mean_time_to_happen = { months = 2 }

	immediate = {
		set_country_flag = first_peace_of_thorn
		if = {
		    limit = {
			    any_country = {
                    is_emperor = yes
					ai = yes
					has_opinion = {
	                    who = TEU
	                    value = 10
                    }
                }				
			}
			random_country = {
			    limit = { is_emperor = yes }
				create_guarantee = TEU
				set_ai_attitude = {
                    attitude = attitude_friendly
                    who = TEU
                    locked = yes
                }
			}
		}
	}

	option = {
		ai_chance = { factor = 65 }
		name = "flavor_pol.722.a" #Peace with Teutons
		white_peace = TEU
			LIT = {
				add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
				}
				add_liberty_desire = -50
			}
			every_known_country = {
				limit = {
					is_subject_of = LIT
				}
				add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
				}
			}
		every_province = {
            limit = {
                owned_by = TEU
                is_core = LIT				
            }
            cede_province = LIT			
        }
		TEU = { 
			add_treasury = -500
			set_country_flag = broken_by_polish
		}
		add_treasury = 500
		hidden_effect = {
		POL = {
			every_owned_province = {
				remove_claim = TEU
				remove_core = TEU
			}
		}
		if = {
			limit = {
				LIT = {
					is_subject_of = POL
					OR = {
						is_subject_of_type = permanent_union 
						is_subject_of_type = permanent_union_limited
						is_subject_of_type = decentralized_vassal
					}
				}
			}
			LIT = {
				every_owned_province = {
					remove_claim = TEU
					remove_core = TEU
				}
			}
		}
		}
	}

	option = {
	    trigger = { 2398 = { owned_by = TEU } }
		ai_chance = { factor = 30 }
		name = "flavor_pol.722.b" #Peace with Teutons, but demand Chełmno
		white_peace = TEU
			LIT = {
				add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
				}
				add_liberty_desire = -50
			}
			every_known_country = {
				limit = {
					is_subject_of = LIT
				}
				add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
				}
			}  
		2398 = { #Chelmno
			if = {
				limit = {
					owned_by = TEU
				}
				cede_province = POL
				add_core = POL
				remove_core = TEU
			}
		}
		every_province = {
            limit = {
                owned_by = TEU
                is_core = LIT				
            }
            cede_province = LIT			
        }
		add_country_modifier = { 
		     name = diplo_faux_pas
			 duration = 3650
		}	 
		TEU = {
			set_country_flag = broken_by_polish
		}
		hidden_effect = {
		    POL = {
			    every_owned_province = {
				    remove_claim = TEU
				    remove_core = TEU
			    }
		    }
		}
	}
     
	option = {
	    ai_chance = { factor = 5 }
		name = "flavor_pol.722.c" #Continue fighting
		if = {
		    limit = { 
				LIT = {
					is_subject_of = POL
					OR = {
						is_subject_of_type = permanent_union 
						is_subject_of_type = permanent_union_limited
						is_subject_of_type = decentralized_vassal
					}
				}
			 }
	        LIT = {
			    add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			    }
				add_liberty_desire = 100
				white_peace = TEU
				remove_historical_friend = POL
		    }
			add_war_exhaustion = 5
			every_known_country = {
			    limit = {
				     is_subject_of = LIT
				}
                add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			    }
                white_peace = TEU
			} 
            remove_historical_friend = LIT
		}
		hidden_effect = {
		every_known_country = {
			limit = {
				religion = catholic
				capital_scope = {
			        OR = {
				        superregion = germany_superregion
				        superregion = greater_austrian_circle_superregion
			        }
		        }
			}
			add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			}
		}
		}
		set_country_flag = refused_peace_of_thorn
	}
}

###FIRST PEACE OF THORN (Commonwealth version)
country_event = {
	id = flavor_pol.7221
	title = "flavor_pol.7221.title"
	desc = "flavor_pol.7221.desc"
	picture = SIEGE_eventPicture
    major = yes
    trigger = { 
        tag = PLC
		TEU = { NOT = { has_country_flag = broken_by_polish } }
		NOT = { has_country_flag = first_peace_of_thorn }
		NOT = { has_global_flag = lithuanian_civil_war	}
		war_score_against = {
	        who = TEU
	        value = 40
        }
	}
    fire_only_once = yes
	
    mean_time_to_happen = { months = 2 }

    immediate = {
    	set_country_flag = first_peace_of_thorn
		if = {
		    limit = {
			    any_country = {
                    is_emperor = yes
					ai = yes
					has_opinion = {
	                    who = TEU
	                    value = 10
                    }
                }				
			}
			random_country = {
			    limit = { is_emperor = yes }
				create_guarantee = TEU
				set_ai_attitude = {
                    attitude = attitude_friendly
                    who = TEU
                    locked = yes
                }
			}
		}
	}
    
	option = {
	    ai_chance = { factor = 65 }
		name = "flavor_pol.7221.a" #Peace with Teutons
		white_peace = TEU
		every_known_country = {
		limit = {
		    is_subject_of = LIT
			}
            add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
			}
			add_liberty_desire = -50
		}  
		every_province = {
            limit = {
                owned_by = TEU
                is_core = LIT				
            }
            cede_province = LIT			
        }
		TEU = { 
		    add_treasury = -500
			set_country_flag = broken_by_polish
		}
		add_treasury = 500
		hidden_effect = {
			PLC = {
				every_owned_province = {
					remove_claim = TEU
					remove_core = TEU
				}
			}
			every_known_country = {
				limit = {
					is_subject_of = PLC
					}
					every_owned_province = {
						remove_claim = TEU
						remove_core = TEU
					}
			}  
		}
	}

    option = {
	    trigger = { 2398 = { owned_by = TEU } }
	    ai_chance = { factor = 30 }
		name = "flavor_pol.7221.b" #Peace with Teutons, but demand Chełmno
		white_peace = TEU
		2398 = { #Chelmno
			if = {
				limit = {
                    owned_by = TEU
				}
				cede_province = POL
				add_core = POL
				remove_core = TEU
			}
		}
		every_known_country = {
		limit = {
		    is_subject_of = PLC
			}
            add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
			}
			add_liberty_desire = -50
		}  
		every_province = {
            limit = {
                owned_by = TEU
                is_core = LIT				
            }
            cede_province = LIT			
        }
		add_country_modifier = { 
		     name = diplo_faux_pas
			 duration = 3650
		}	 
		TEU = {
			set_country_flag = broken_by_polish
		}
		hidden_effect = {
		PLC = {
			every_owned_province = {
				remove_claim = TEU
				remove_core = TEU
			}
		}
		every_known_country = {
			limit = {
				is_subject_of = PLC
				}
				every_owned_province = {
					remove_claim = TEU
					remove_core = TEU
				}
			}  
		}
	}
     
	option = {
	    ai_chance = { factor = 5 }
		name = "flavor_pol.7221.c" #Continue fighting
		every_known_country = {
		    limit = {
				is_subject_of = PLC
			}
            add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			}
			add_liberty_desire = 50
		}
		add_war_exhaustion = 5 
		hidden_effect = {
		every_known_country = {
			limit = {
				religion = catholic
				capital_scope = {
			        OR = {
				        superregion = germany_superregion
				        superregion = greater_austrian_circle_superregion
			        }
		        }
			}	
			add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			}
			set_country_flag = refused_peace_of_thorn
			}
		}
	}
}

###FIRST PEACE OF THORN (Poland without Lithuania version)
country_event = {
	id = flavor_pol.7222
	title = "flavor_pol.7221.title"
	desc = "flavor_pol.7221.desc"
	picture = SIEGE_eventPicture
    major = yes
    trigger = { 
        tag = POL
		NOT = { 
			LIT = {
				is_subject_of = POL
				OR = {
					is_subject_of_type = permanent_union 
					is_subject_of_type = permanent_union_limited
					is_subject_of_type = decentralized_vassal
				}
			}
		 }
		TEU = { NOT = { has_country_flag = broken_by_polish } }
		NOT = { has_country_flag = first_peace_of_thorn }
		NOT = { has_global_flag = lithuanian_civil_war	}
		war_score_against = {
	        who = TEU
	        value = 40
        }
	}
    fire_only_once = yes
	
    mean_time_to_happen = { months = 2 }	

    immediate = {
    	set_country_flag = first_peace_of_thorn
		if = {
		    limit = {
			    any_country = {
                    is_emperor = yes
					ai = yes
					has_opinion = {
	                    who = TEU
	                    value = 10
                    }
                }				
			}
			random_country = {
			    limit = { is_emperor = yes }
				create_guarantee = TEU
				set_ai_attitude = {
                    attitude = attitude_friendly
                    who = TEU
                    locked = yes
                }
			}
		}
	}	
    
	option = {
	    ai_chance = { factor = 65 }
		name = "flavor_pol.7222.a" #Peace with Teutons
		white_peace = TEU
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 10 } 
		every_known_country = {
		limit = {
		    is_subject_of = POL
			}
            add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
			}		
			add_liberty_desire = -50
		}
		every_province = {
            limit = {
                owned_by = TEU
                is_core = POL
                NOT = { province_id = 2398 } #Chelmno				
            }
            cede_province = POL		
        }
		TEU = { 
		    add_treasury = -500
			set_country_flag = broken_by_polish
		}
		add_treasury = 500
		hidden_effect = {
			POL = {
				every_owned_province = {
					remove_claim = TEU
					remove_core = TEU
				}
			}
			every_known_country = {
				limit = {
					is_subject_of = POL
					}
					every_owned_province = {
						remove_claim = TEU
						remove_core = TEU
					}
			}  
		}
	}

    option = {
	    trigger = { 2398 = { owned_by = TEU } }
	    ai_chance = { factor = 30 }
		name = "flavor_pol.7222.b" #Peace with Teutons, but demand Chełmno
		white_peace = TEU
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 5 }
		2398 = { #Chelmno
			if = {
				limit = {
                    owned_by = TEU
				}	
				cede_province = POL
				add_core = POL
				remove_core = TEU
			}
		}
		every_province = {
            limit = {
                owned_by = TEU
                is_core = POL
                NOT = { province_id = 2398 } #Chelmno				
            }
            cede_province = POL		
        }
		every_known_country = {
		limit = {
		    is_subject_of = POL
			}
            add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
			}		
			add_liberty_desire = -50
		}
		add_country_modifier = { 
		     name = diplo_faux_pas
			 duration = 3650
		}	 
		TEU = {
			set_country_flag = broken_by_polish
		}
		hidden_effect = {
		POL = {
			every_owned_province = {
				remove_claim = TEU
				remove_core = TEU
			}
		}
		every_known_country = {
			limit = {
				is_subject_of = POL
				}
				every_owned_province = {
					remove_claim = TEU
					remove_core = TEU
				}
			}  
		}
	}
     
	option = {
	    ai_chance = { factor = 5 }
		name = "flavor_pol.7222.c" #Continue fighting
		every_known_country = {
		    limit = {
				is_subject_of = POL
			}
            add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			}
			add_liberty_desire = 50
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -10 } 
		add_war_exhaustion = 5 
		hidden_effect = {
		every_known_country = {
			limit = {
				religion = catholic
				capital_scope = {
			        OR = {
				        superregion = germany_superregion
				        superregion = greater_austrian_circle_superregion
			        }
		        }
			}	
			add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			}
			set_country_flag = refused_peace_of_thorn
			}
		}
	}
}

#THE PRUSSIAN CONFEDERATION REVOLTS (Polish version)
country_event = {
	id = flavor_pol.751
	title = "flavor_teu.EVTNAME1"
	desc = "flavor_teu.EVTDESC1"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = TEU
		has_country_flag = pru_confederation_prepare
		NOT = { truce_with = POL }
		is_subject = no
		num_of_owned_provinces_with = {
		    value = 2
			area = west_prussia_area
		}
		exists = POL
		NOT = { exists = PLC }
		is_neighbor_of = POL
		NOT = { war_with = POL }
		NOT = { alliance_with = POL }
		POL = { is_subject = no }
		POL = { num_of_cities = 10 }
		num_of_cities = 5
	}
	
	mean_time_to_happen = {
		years = 2
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = pru_confederation_happened
			every_owned_province = {
				limit = {
					area = west_prussia_area 
					owned_by = TEU
				}
				cede_province = DNZ
				add_core = DNZ
			}
			if = {
				limit = {
					NOT = {
						exists = DNZ
					}
				}
				release = DNZ
				DNZ = {  
					Pol_ChangeGovRepublic = { Mandate=1 Stylings=1 ExtraPowers=1 Assembly=2 TermOfOffice=5 } 
					add_government_reform = Pol_Nobility2
				}
				DNZ = {
					capital_scope = {
						build_to_forcelimit = {
							infantry = 0.6
							cavalry = 0.3
						}
					}
					random_owned_province = {
						limit = {
							has_port = yes
						}
						build_to_forcelimit = {
							galley = 0.3
							light_ship = 0.3
							transport = 0.2
						}
					}
				}
			}
		}
	}
	
	option = { # Go to war
		name = "flavor_pol.751.a"
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = yes
					war_exhaustion = 10
				}
			}
			 
		}
		custom_tooltip = flavor_pol.751.tooltip
		hidden_effect = {
			POL = {
				country_event = { id = flavor_pol.752 }
			}
			POL = {
				create_guarantee = DNZ
			}
		}
	}
	option = { # Let them go
		name = "flavor_pol.751.b"
		ai_chance = { 
			factor = 100 
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = no
					NOT = { war_exhaustion = 10 }
				}
			}
		}
		Stab_Subtract1 = yes
		add_prestige = -20
	}
}

#THE PRUSSIAN CONFEDERATION REVOLTS (Commonwealth version)
country_event = {
	id = flavor_pol.7511
	title = "flavor_teu.EVTNAME1"
	desc = "flavor_teu.EVTDESC1"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = TEU
		has_country_flag = pru_confederation_prepare
		NOT = { truce_with = PLC }
		is_subject = no
		num_of_owned_provinces_with = {
		    value = 2
			area = west_prussia_area
		}
		exists = PLC
		is_neighbor_of = PLC
		NOT = { war_with = PLC }
		NOT = { alliance_with = POL }
		PLC = { is_subject = no }
		PLC = { num_of_cities = 10 }
		num_of_cities = 5
	}
	
	mean_time_to_happen = {
		years = 2
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = pru_confederation_happened
			every_owned_province = {
				limit = {
					area = west_prussia_area 
					owned_by = TEU
				}
				cede_province = DNZ
				add_core = DNZ
			}
			if = {
				limit = {
					NOT = {
						exists = DNZ
					}
				}
				release = DNZ
				DNZ = {  
					Pol_ChangeGovRepublic = { Mandate=1 Stylings=1 ExtraPowers=1 Assembly=2 TermOfOffice=5 } 
					add_government_reform = Pol_Nobility2
				}
				DNZ = {
					capital_scope = {
						build_to_forcelimit = {
							infantry = 0.6
							cavalry = 0.3
						}
					}
					random_owned_province = {
						limit = {
							has_port = yes
						}
						build_to_forcelimit = {
							galley = 0.3
							light_ship = 0.3
							transport = 0.2
						}
					}
				}
			}
		}
	}
	
	option = { # Go to war
		name = "flavor_pol.751.a"
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = yes
					war_exhaustion = 10
				}
			}
			 
		}
		custom_tooltip = flavor_pol.751.tooltip
		hidden_effect = {
			PLC = {
				country_event = { id = flavor_pol.752 }
			}
			PLC = {
				create_guarantee = DNZ
			}
		}
	}
	option = { # Let them go
		name = "flavor_pol.751.b"
		ai_chance = { 
			factor = 100 
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = no
					NOT = { war_exhaustion = 10 }
				}
			}
		}
		Stab_Subtract1 = yes
		add_prestige = -20
	}
}

#PRUSSIAN CONFEDERATION SEEKS POLISH SUPPORT
country_event = {
	id = flavor_pol.752
	title = "flavor_teu.EVTNAME2"
	desc = "flavor_teu.EVTDESC2"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
	
	fire_only_once = yes
	
	is_triggered_only = yes
	
	major = yes
	
	option = {
		name = "flavor_pol.752.a"
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = yes
					war_exhaustion = 10
				}
			}
		}
		set_country_flag = supported_prussian_confederation_flag
		add_opinion = {
			who = DNZ
			modifier = supported_prussian_confederation
		}
		DNZ = {
			add_opinion = {
				who = ROOT
				modifier = supported_prussian_confederation
			}
		}
		create_alliance = DNZ
		TEU = {
				country_event = { id = flavor_pol.754 }
		}
	}
	option = { # stay out of this
		name = "flavor_pol.752.b"
		ai_chance = { 
			factor = 100
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = no
					NOT = { war_exhaustion = 10 }
				}
			}
		}
		add_prestige = -10
		TEU = {
				country_event = { id = flavor_pol.754 }
		}
	}
}

###THE PRUSSIAN CONFEDERATION (beginning of the event chain)
country_event = {
	id = flavor_pol.753
	title = "flavor_teu.EVTNAME4"
	desc = "flavor_teu.EVTDESC4"
	picture = SEJM_eventPicture
	
	fire_only_once = yes
	major = yes
	
	trigger = {
		tag = TEU
		has_country_flag = broken_by_polish
		OR = {
		    NOT = { check_key = { lhs = Prov_BGLoy value = 50 } }
			NOT = { check_key = { lhs = Prov_NOLoy value = 50 } }
		}
		num_of_owned_provinces_with = {
		    value = 2
			area = west_prussia_area
		}
	}
	
	mean_time_to_happen = {
		years = 20
	}
	
	option = {
		name = "flavor_pol.753.a"
		set_country_flag = pru_confederation_prepare
	}
}

#PRUSSIAN-TEUTONIC WAR
country_event = {
	id = flavor_pol.754
	title = "flavor_pol.754.title"
	desc = "flavor_pol.754.desc"
	picture = SEJM_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
	
	option = {
		name = "flavor_pol.754.a"
		declare_war_with_cb = {
			who = DNZ
			casus_belli = cb_disloyal_vassal
		}
	}
}

#Vanilla flavor_teu files ported by Mepper to complete the event chain:

#THE PEACE OF THORN
country_event = {
	id = flavor_teu.3
	title = "flavor_teu.EVTNAME3"
	desc = "flavor_teu.EVTDESC3"
	picture = SEJM_eventPicture
	
	fire_only_once = yes
	
	is_triggered_only = yes
	
	option = {
		name = "flavor_teu.3.a"
		vassalize = DNZ
		if = {
			limit = {
				2398 = { #Chelmno
					owned_by = DNZ
					culture = polish
				}
			}
			2398 = {
				cede_province = ROOT
				add_core = ROOT
				remove_core = DNZ
			}
		}
		west_prussia_area = {
			limit = {
				NOT = { is_permanent_claim = ROOT }
				NOT = { is_core = ROOT	}
				NOT = { is_permanent_claim = DNZ }
				NOT = { is_core = DNZ }
			}
			add_permanent_claim = ROOT
		}
	}
}
	
#THE END OF THE TEUTONIC STATE
country_event = {
	id = flavor_teu.5
	title = flavor_teu.5.t
	desc = flavor_teu.5.d
	picture = SEJM_eventPicture
	
	trigger = {
		is_year = 1460
		NOT = { is_year = 1500 }
		tag = TEU
		NOT = { has_country_flag = pru_confederation_curtailed }
		has_country_flag = pru_confederation_flag
		#has_estate_privilege = estate_burghers_prussian_confederation
		is_subject = no
		is_at_war = no
		NOT = {
			exists = DNZ
		}
	}
	
	mean_time_to_happen = {
		years = 12
	}
	
	option = {
		name = flavor_teu.5.a
		clr_country_flag = pru_confederation_flag
		ChangeTagEffect = { scope=DNZ }
		Pol_ChangeGovRepublic = { Mandate=1 Stylings=1 ExtraPowers=1 Assembly=2 TermOfOffice=5 } 
		add_government_reform = Pol_Nobility2
		#remove_estate_privilege = estate_burghers_prussian_confederation
		Stab_Subtract1 = yes
		add_prestige = -25
		hidden_effect = {
			country_event = {
				id = ideagroups.9000
				days = 1
			}
		}
		custom_tooltip = swap_national_ideas
	}
}

### SUCCESSION IN THE DUCHY OF PRUSSIA ###

###LAST GRANDMASTER OF TEUTONIC ORDER?
country_event = {
	id = flavor_teu.6
	title = "flavor_teu.6.title"
	desc = "flavor_teu.6.desc"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
	fire_only_once = yes
	major = yes
	
	trigger = {
		tag = TEU
		num_of_cities = 4
		is_subject_other_than_tributary_trigger = yes
		religion = catholic
		is_religion_enabled = protestant
		overlord = {
		    NOT = {
			    culture_group = low_germanic
				culture_group = high_germanic
			}
		}
	}
	
	mean_time_to_happen = {
		months = 6
	}
	
	option = {
		name = "EXCELLENT"
		if = {
		    limit = {
			    BRA = {
				    exists = yes
					num_of_cities = 5
					is_free_or_tributary_trigger = yes
					dynasty = "von Hohenzollern"
				}
			}
			define_ruler = {
                name = "Albrecht"
                dynasty = "von Hohenzollern"
                adm = 3
                dip = 6
                mil = 1
                age = 21
            }
			else = {
			    define_ruler = {
                    name = "Albrecht"
                    adm = 3
                    dip = 6
                    mil = 1
                    age = 21
                }
			}
		}
		set_country_flag = teuton_secularization
	}
	after = {
	    add_ruler_personality = silver_tongue_personality #he was able to preserve prussian independence
		set_ruler_flag = potential_duke_of_prussia
	}
}

###INSANITY OF THE DUKE
country_event = {
	id = flavor_teu.7
	title = "flavor_teu.7.title"
	desc = "flavor_teu.7.desc"
	picture = COURT_eventPicture
	fire_only_once = yes
	major = yes
	
	trigger = {
		tag = PRU
		is_subject_other_than_tributary_trigger = yes
		has_country_flag = teuton_secularization
		NOT = { has_ruler_flag = potential_duke_of_prussia }
		NOT = { ruler_age = 35 }
		overlord = {
		    NOT = {
			    culture_group = low_germanic
				culture_group = high_germanic
			}
		}
	}
	
	mean_time_to_happen = {
		years = 5
	}
	
	option = {
		name = "flavor_teu.7.a"
		add_ruler_personality = mad_personality
	}
}

###SUCCESSION IN THE DUCHY OF PRUSSIA (Main event)
country_event = {
	id = flavor_teu.8
	title = "flavor_teu.8.title"
	desc = "flavor_teu.8.desc"
	picture = CONQUEST_eventPicture
	fire_only_once = yes
	major = yes
	
	trigger = {
		tag = PRU
		ai = yes
		is_subject_other_than_tributary_trigger = yes
		OR = {
		    ruler_has_personality = mad_personality
			is_female = yes
			AND = {
			    ruler_age = 50
				OR = { 
				    has_heir = no
					has_female_heir = yes
				}
			}
			AND = {
			    has_regency = yes
				has_female_heir = yes
			}
			AND = {
			    has_regency = yes
				NOT = { heir_claim = 50 }
			}
		}
		overlord = {
		    NOT = {
			    culture_group = low_germanic
				culture_group = high_germanic
			}
			OR = {
			    NOT = { stability = -1 }
				is_bankrupt = yes
				AND = {
				   is_at_war = yes
				   war_exhaustion = 8
				}
			}	
		}
		any_known_country = {
		    culture_group = low_germanic
			is_emperor = no
			government = monarchy
			is_part_of_hre = yes
			num_of_cities = 5
			is_free_or_tributary_trigger = yes
		}
	}
	
	mean_time_to_happen = {
		years = 5
	}
	
	immediate = {
	    if = {
		    limit = {
			    BRA = {
				    exists = yes
					government = monarchy
					is_emperor = no
					is_part_of_hre = yes
					num_of_cities = 5
					culture_group = low_germanic
					is_free_or_tributary_trigger = yes
				}
			}
			BRA = {
			    set_country_flag = heir_to_prussia
			}
			else = {
			    random_known_country = {
				    limit = {
					    culture_group = low_germanic
						is_emperor = no
						government = monarchy
						is_part_of_hre = yes
						num_of_cities = 5
						is_free_or_tributary_trigger = yes
					}
				    set_country_flag = heir_to_prussia	
				}
			}
		}
		overlord = {
		    set_country_flag = overlord_of_prussia
		}
	}
	
	option = {
		name = "flavor_teu.8.a"
        random_known_country = {
		    limit = {
			    has_country_flag = heir_to_prussia
			}
			country_event = { 
			    id = flavor_teu.9 
				days = 7
			}
		}
	}
}

###SUCCESSION IN THE DUCHY OF PRUSSIA (inheritor)
country_event = {
	id = flavor_teu.9
	title = "flavor_teu.9.title"
	desc = "flavor_teu.9.desc"
	picture = CONQUEST_eventPicture
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		num_of_cities = 5
		is_free_or_tributary_trigger = yes
		culture_group = low_germanic
	}
	
	option = {
		name = "flavor_teu.9.a"
		ai_chance = { factor = 99 }
		create_union = FROM
        random_known_country = {
		    limit = {
			    has_country_flag = overlord_of_prussia
			}
			country_event = { 
			    id = flavor_teu.11
				days = 7
			}
		}
		if = {
		    limit = {
			    any_country = {
                    is_emperor = yes
					ai = yes
					has_opinion = {
	                    who = ROOT
	                    value = 10
                    }
                }				
			}
			random_country = {
			    limit = { is_emperor = yes }
				create_guarantee = ROOT
				set_ai_attitude = {
                    attitude = attitude_friendly
                    who = ROOT
                    locked = yes
                }
			}
		}
	}
	option = {
		name = "flavor_teu.9.b"
		ai_chance = { factor = 1 }
        add_prestige = -5
	}
}

###SUCCESSION IN THE DUCHY OF PRUSSIA (overlord)
country_event = {
	id = flavor_teu.11
	title = "flavor_teu.11.title"
	desc = "flavor_teu.11.desc"
	picture = HUSSARS_eventPicture
	fire_only_once = yes
	is_triggered_only = yes
	
	option = {
		name = "flavor_teu.11.opt.a"
		ai_chance = { factor = 10 }
		declare_war_with_cb = {
            who = FROM
            casus_belli = cb_disloyal_vassal
        }
		add_country_modifier = { 
		     name = diplo_faux_pas
			 duration = 7300
		}	
	}
	option = {
		name = "flavor_teu.11.opt.b"
		ai_chance = { factor = 90 }
        add_prestige = -5
		create_subject = {
			subject_type = nominal_subject
			subject = FROM
		}
	}
}

#Treaty of Welawa-Bydgoszcz to be added

### COSSACK UPRISING ###	
#Ported from DeI Ludicrum submod by Piterdaw

###COSSACK CONVERSION
province_event = {
    id = flavor_pol.735
	title = "flavor_pol.735.title"
	desc = "flavor_pol.735.d"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	hidden = yes
	trigger = {
		is_year = 1500
		OR = {
			area = zaporizhia_area
			area = sloboda_ukraine_area
			area = lower_don_area
			area = azov_area
			area = east_dniepr_area
		    area = lower_don_area
            area = crimea_area 
			area = cherson_area
		}
		OR = {
			culture = crimean 
			culture = tartar
		}
		owner = {
			OR = {
				tag = POL
				tag = PLC
				tag = LIT
				religion = orthodox
			}
		}
		any_neighbor_province = {
			OR = {
				culture = ukrainian
				culture = ruthenian
				culture = russian
			}
		}
	}
	mean_time_to_happen = { years = 30 }
	option = {
		name = "flavor_pol.735.a"
		if = {
			limit = { area = zaporizhia_area }
			add_core = ZAZ
		}
		change_culture = ukrainian
		if = {
		    limit = { religion = sunni }
		    MN_RlgChange = { from = 19 to = 9 }
		}
		if = {
		    limit = { religion = catholic }
		    MN_RlgChange = { from = 1 to = 9 }
		}
		log = "FE-POL:[GetYear]:[Root.Owner.GetName]:[This.GetName] converted to Cossack culture:flavor_pol.735"
	}
}

##NALEWAJKO UPRISING
country_event = {
	id = flavor_pol.740
	title = "flavor_pol.740.title"
	desc = "flavor_pol.740.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
    fire_only_once = yes
	major = yes
	
	trigger = {
	    OR = {
			tag = PLC
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
		}
	    any_owned_province = {
		    culture = ukrainian
			area = zaporizhia_area
		}
        NOT = { stability = 2 }
        is_year = 1550
        NOT = { is_year = 1650 }
	}
	
	mean_time_to_happen = {
		years = 5
	}
	
	option = { #Put down the insurrection
        name = "flavor_pol.740.a"
		set_country_flag = nalewajko_uprising
        Stab_Subtract1 = yes
		log = "FE-POL:[GetYear]:[Root.GetName]:Nalevajko uprising of Cossacks started:flavor_pol.740"
		random_owned_province = {
			limit = {
				culture = ukrainian
			}
			spawn_rebels = {
				type = cossack_rebels
				leader = "Seweryn Nalewajko"
				size = 3
			}
		}
		random_owned_province = {
			limit = {
				culture = ukrainian
			}
			spawn_rebels = {
				type = cossack_rebels
				leader = "Hryhory Loboda"
				size = 2
			}
		}
	}
}

#END OF THE UPRISING
country_event = {
	id = flavor_pol.741
	title = "flavor_pol.741.title"
	desc = "flavor_pol.741.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	goto = peace_negotiations
    fire_only_once = yes
	
	trigger = {
	    has_country_flag = nalewajko_uprising
        NOT = { num_of_revolts = 1 }
		NOT = { has_spawned_rebels = cossack_rebels }
	}
	
	mean_time_to_happen = {
		years = 1
	}
	
	immediate = {
	    clr_country_flag = nalewajko_uprising
		hidden_effect = {
			random_owned_province = {
				limit = {
					culture = ruthenian
				}
				save_event_target_as = peace_negotiations
			}
		}
	}
    
	option = { #Reach an agreement with Cossacks
        name = "flavor_pol.741.a"
		ai_chance = { factor = 90 }
		log = "FE-POL:[GetYear]:[Root.GetName]:Nalevajko uprising ended by reaching an agreement with Cossacks:flavor_pol.741"
		log = "FE-POL:[GetYear]:[Root.GetName]:Cossacks were added to regular army and Sich became a vassal:flavor_pol.741"
		
		Stab_Add1 = yes
		add_country_modifier = {
			name = cossacks_in_regular_army 
			duration = -1
		}
		every_owned_province = {
			limit = {
			    OR = {
				    area = zaporizhia_area
				    area = cherson_area
				    area = crimea_area
				    area = azov_area
				}
			}
			cede_province = ZAZ
			add_core = ZAZ
		}
		create_subject = {
			subject_type = decentralized_vassal
			subject = ZAZ
		}
		hidden_effect = {
			ZAZ = {
				Pol_ChangeGovRepublic = { Mandate=3 Stylings=2 ExtraPowers=1 Assembly=2 TermOfOffice=1 } 
			}
		}
	}
	
	option = { #Crush them once and for all
        name = "flavor_pol.741.b"
		ai_chance = { factor = 10 }
		set_country_flag = angered_cossacks
		Stab_Subtract1 = yes
		log = "FE-POL:[GetYear]:[Root.GetName]:Nalevajko uprising ended by crushing the Cossacks:flavor_pol.741"
		random_owned_province = {
			limit = {
				culture = ukrainian
			}
			spawn_rebels = {
				type = cossack_rebels
				size = 2
			}
		}
		random_owned_province = {
			limit = {
				culture = ukrainian
			}
			spawn_rebels = {
				type = cossack_rebels
				size = 2
			}
		}
		every_owned_province = {
			limit = {
				OR = {
				    area = zaporizhia_area
				    area = cherson_area
				    area = crimea_area
				    area = azov_area
				}
			}
			add_province_modifier = {
				name = cossack_unrest 
				duration = 36500 #100 years
			} 
		}
	}
}
	
#UNREST ON SICH
country_event = {
	id = flavor_pol.742
	title = "flavor_pol.742.title"
	desc = "flavor_pol.742.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
    fire_only_once = yes
	
    is_triggered_only = yes #from chmielnicki_uprising disaster
	
	immediate = {
	    set_country_flag = chmielnicki_uprising
	}	
    
	option = { #Dire times ahead of us
        name = "flavor_pol.742.a"
        Stab_Subtract1 = yes
		remove_country_modifier = cossacks_in_regular_army 
		log = "FE-POL:[GetYear]:[Root.GetName]:Cossacks uprising disaster started:flavor_pol.742"
		log = "FE-POL:[GetYear]:[Root.GetName]:Cossacks removed from regular army:flavor_pol.742"
		log = "FE-POL:[GetYear]:[Root.GetName]:Cossacks unrest and liberty desire added:flavor_pol.742"
		create_subject = {
            subject_type = rebellious_decentralized_vassal
            subject = ZAZ
        }
        ZAZ = { add_liberty_desire = 100 }
        ZAZ = {
            add_opinion = {
				who = ROOT
				modifier = cossack_rebellion
			}
		}
        ROOT = {
            add_opinion = {
				who = ZAZ
				modifier = cossack_rebellion
			}
		}
		hidden_effect = {
            ZAZ = { country_event = { id = flavor_pol.743 } }
			country_event = { id = flavor_pol.744 days = 60  random = 20 }
		}
	}
}

#RISE OF THE NEW COSSACK HETMAN
country_event = {
	id = flavor_pol.743
	title = "flavor_pol.743.title"
	desc = "flavor_pol.743.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
    fire_only_once = yes
	
    is_triggered_only = yes
	
	immediate = {
	    set_country_flag = rebellious_hetman
		hidden_effect = {
		    Pol_ChangeGovRepublic = { ExtraPowers=2 }
		}
		if = {
		    limit = { 
			    is_year = 1620
                NOT = { is_year = 1657 }
			}
            set_country_flag = bohdan_chmielnicki
		}
	}	
    
	option = { #Long live our hetman!
        name = "flavor_pol.743.a"
        Stab_Add3 = yes
		if = {
		    limit = {
			    has_country_flag = bohdan_chmielnicki
			}
			log = "FE-POL:[GetYear]:[Root.GetName]:rebellious hetman is Bogdam Chmielnicki:flavor_pol.743"
            define_ruler = {
			    name = "Bohdan"
				dynasty = "Chmielnicki"
			    claim = 100
			    adm = 3
			    dip = 5
			    mil = 5
				max_random_adm = 5
			    min_age = 25
				max_age = 45
			    culture = ruthenian
			    religion = orthodox
		   }
		   define_ruler_to_general = {
                fire = 5
                shock = 5
                manuever = 5
                siege = 2
           }
           add_ruler_personality = brilliant_strategist_personality
		   add_ruler_personality = deceitful_personality
		   add_ruler_personality = drunkard_personality
		}
        else = {
            define_ruler = {
			    claim = 90
			    adm = 2
			    dip = 4
			    mil = 4
				max_random_adm = 4
				max_random_dip = 5
				max_random_mil = 5
			    age = 35
			    culture = ruthenian
			    religion = orthodox
		   }
		   define_ruler_to_general = {
                fire = 4
                shock = 4
                manuever = 4
                siege = 1
           }
           add_ruler_personality = martial_educator_personality
		}
        define_general = {
		    name = "Ivan Bohun"
            shock = 4
            fire = 4
            manuever = 6
            siege = 2
        }
        add_country_modifier = {
			name = chmielnicki_uprising
			duration = 7300 #20 years
		}
	}
}

#CHMIELNICKI UPRISING
country_event = {
	id = flavor_pol.744
	title = "flavor_pol.744.title"
	desc = "flavor_pol.744.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	major = yes
	
    trigger = {
	    has_country_flag = chmielnicki_uprising
	}	
	
	mean_time_to_happen = { months = 3 }
    
	fire_only_once = yes
	
	option = { #Crush those peasants!
        name = "flavor_pol.744.a"
		set_country_flag = chmielnicki_uprising_2
		log = "FE-POL:[GetYear]:[Root.GetName]:angry mob spawned:flavor_pol.744"
		every_owned_province = {
		    limit = {
			    OR = {
			        region = ruthenia_region
					region = crimea_region
					region = volga_region
					region = steppes_region
				}
				NOT = { area = west_dniepr_area }
			}
			spawn_rebels = {
				type = mob_rebels
				size = 1
			}
        }
		
        every_owned_province = {
		    limit = {
				area = west_dniepr_area
			}
			spawn_rebels = {
				type = mob_rebels
				size = 2
			}
        }
        
        if = {
		    limit = { 
			    is_year = 1630
				NOT = { is_year = 1651 } 
			}
			log = "FE-POL:[GetYear]:[Root.GetName]:Jeremi Wisniowiecki became general:flavor_pol.744"
			define_general = {
		        name = "Jeremi Wisniowiecki"
                shock = 5
                fire = 4
                manuever = 4
                siege = 3
            }
        }
	}
}

#PROVINCE DEFECTS TO COSSACKS
province_event = {
	id = flavor_pol.745
	title = "flavor_pol.745.title"
	desc = "flavor_pol.745.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
    hidden = yes
	
    trigger = {
	    owner = {
	        has_country_flag = chmielnicki_uprising
            NOT = { has_country_flag = agreement_of_pereyeslavl }
		}
        OR = {
            culture = ruthenian
            culture = ukrainian
			culture = russian
		}
		NOT = { area = red_ruthenia_area }
		NOT = { area = smolensk_area }
		NOT = { area = polesie_area }
		NOT = { area = black_ruthenia_area }
		NOT = { area = white_ruthenia_area }
        any_neighbor_province = {
            owned_by = ZAZ
		}
        controlled_by = REB
	}
	
	mean_time_to_happen = { months = 1 }
    
	option = { 
        name = "flavor_pol.745.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:[This.GetName] defected to Cossacks:flavor_pol.745"
       	cede_province = ZAZ
		add_core = ZAZ
        ZAZ = {
		    disband_rebels = mob_rebels
			disband_rebels = cossack_rebels
        }
	}
}

#NEGOTIATIONS OF AGREEMENT
country_event = {
	id = flavor_pol.746
	title = "flavor_pol.746.title"
	desc = "flavor_pol.746.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	fire_only_once = yes
	
    trigger = {
	    tag = ZAZ
		overlord = { has_country_flag = chmielnicki_uprising_2 }
        OR = {
            AND = { 
			    exists = MOS
                MOS = { is_subject = no }
				MOS = { total_development = 400 }
				NOT = { MOS = { alliance_with = POL } }
			    NOT = { MOS = { alliance_with = PLC } }
			}
			AND = { 
			    exists = RUS
				RUS = { is_subject = no }	
				RUS = { total_development = 400 }
				NOT = { RUS = { alliance_with = POL } }
			    NOT = { RUS = { alliance_with = PLC } }
			}
			AND = { 
			    exists = TUR
                TUR = { is_subject = no }
				TUR = { total_development = 600 }
				NOT = { TUR = { alliance_with = POL } }
			    NOT = { TUR = { alliance_with = PLC } }
			}
		}
	}	
	
	mean_time_to_happen = {
		years = 4
		modifier = {
			factor = 0.5
			is_at_war = yes
		}
	}
	
	immediate = {
	    if = {
		    limit = {
			    exists = MOS
                MOS = { is_subject = no }
				MOS = { total_development = 400 }
				NOT = { MOS = { alliance_with = POL } }
			    NOT = { MOS = { alliance_with = PLC } }
				OR = {
					NOT = { exists = RUS }
					AND = {
						exists = RUS
						MOS = { total_development = RUS }
					}
				}
			}
            set_country_flag = strong_muscovy
			log = "FE-POL:[GetYear]:[Root.GetName]:Muscovy recognised as potential overlord:flavor_pol.746"
		}
        if = {
		    limit = {
			    exists = RUS
				RUS = { is_subject = no }	
				RUS = { total_development = 400 }
				NOT = { RUS = { alliance_with = POL } }
			    NOT = { RUS = { alliance_with = PLC } }
				OR = {
					NOT = { exists = MOS }
					OR = {
						exists = MOS
						RUS = { total_development = MOS }
					}
				}
			}
            set_country_flag = strong_russia
			log = "FE-POL:[GetYear]:[Root.GetName]:Russia recognised as potential overlord:flavor_pol.746"
		}
	}
    
	option = { #Swore our allegiance to Muscovites
        name = "flavor_pol.746.a"
       	ai_chance = { factor = 70 }
        trigger = { 
            has_country_flag = strong_muscovy
			NOT = { MOS = { alliance_with = POL } }
			NOT = { MOS = { alliance_with = PLC } }
		}
        MOS = { country_event = { id = flavor_pol.747 days = 1 } }
        grant_independence = yes
		log = "FE-POL:[GetYear]:[Root.GetName]:swore allegiance to Muscovy:flavor_pol.746"
	}
	
	option = { #Swore our allegiance to Russians
        name = "flavor_pol.746.b"
       	ai_chance = { factor = 70 }
        trigger = { 
            has_country_flag = strong_russia
			NOT = { RUS = { alliance_with = POL } }
			NOT = { RUS = { alliance_with = PLC } }
		}
        RUS = { country_event = { id = flavor_pol.747 days = 1 } }
        grant_independence = yes
		log = "FE-POL:[GetYear]:[Root.GetName]:swore allegiance to Russia:flavor_pol.746"
	}
	
	option = { #Swore our allegiance to Sultan
        name = "flavor_pol.746.c"
       	ai_chance = { factor = 30 }
        trigger = { 
            exists = TUR 
			TUR = { total_development = 600 }
			NOT = { TUR = { alliance_with = POL } }
			NOT = { TUR = { alliance_with = PLC } }
		}
        TUR = { country_event = { id = flavor_pol.747 days = 1 } }
        grant_independence = yes
		log = "FE-POL:[GetYear]:[Root.GetName]:swore allegiance to the Turkish Empire:flavor_pol.746"
	}
}

#NEGOTIATIONS WITH COSSACKS
country_event = {
	id = flavor_pol.747
	title = "flavor_pol.747.title"
	desc = "flavor_pol.747.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	fire_only_once = yes
    is_triggered_only = yes
	
	immediate = {
	    set_country_flag = cossack_overlord
	}

	option = { #Welcome them with open arms
        name = "flavor_pol.747.a"
		create_subject = {
            subject_type = decentralized_vassal
            subject = ZAZ
        }
		add_country_modifier = {
			name = cossacks_in_regular_army 
			duration = -1
		}
        every_known_country = {
		    limit = { has_country_flag = chmielnicki_uprising_2 }
			country_event = { id = flavor_pol.748 } 
        }
	}
}

#COUNCIL OF PEREYESLAVL
country_event = {
	id = flavor_pol.748
	title = "flavor_pol.748.title"
	desc = "flavor_pol.748.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	fire_only_once = yes
    is_triggered_only = yes
	major = yes
	
	immediate = {
	    set_country_flag = agreement_of_pereyeslavl
	}

	option = { #Traitor, not a hetman!
        name = "flavor_pol.748.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:was forced to cede Cossack provinces by agreement of Pereyeslavl:flavor_pol.748"
		every_owned_province = {
		    limit = {
			    OR = {
				    region = ruthenia_region
					region = crimea_region
					region = volga_region
					region = steppes_region
				}
			}
			cede_province = ZAZ
			add_core = ZAZ
        }
		ZAZ = {
		    every_owned_province = { add_core = ROOT }
			Stab_Add1 = yes
        }
        ROOT = {
		    disband_rebels = mob_rebels
			disband_rebels = cossack_rebels
        }
	}
}

#UNION OF HADZIACZ
country_event = {
	id = flavor_pol.749
	title = "flavor_pol.749.title"
	desc = "flavor_pol.749.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	fire_only_once = yes
    major = yes
	
	trigger = {
	    has_country_flag = agreement_of_pereyeslavl
		government = monarchy
		OR = {
		    ZAZ = { war_exhaustion = 3 }
			ZAZ = { NOT = { stability = 0 } }
		}
	}
	
	mean_time_to_happen = { 
	    months = 6 
		modifier = {
			factor = 0.7
			ZAZ = { war_exhaustion = 4 }
		}
		modifier = {
			factor = 0.7
			ZAZ = { war_exhaustion = 5 }
		}
	}
	

	option = { #Make this union come true!
        name = "flavor_pol.749.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:signed Union of Hadziacz:flavor_pol.749"
		if = {
		    limit = { ZAZ = { war_with = ROOT } }
			white_peace = ZAZ
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -10 }
        ZAZ = { ChangeTagEffect = { scope=UKR } }
        create_subject = {
               subject_type = permanent_union
               subject = UKR
        }
		UKR = {
            add_opinion = {
				who = ROOT
				modifier = union_of_hadziacz
			}
		}
        ROOT = {
            add_opinion = {
				who = UKR
				modifier = union_of_hadziacz
			}
		}
		every_owned_province = {
		    limit = {
			    OR = {
				    region = ruthenia_region
					region = crimea_region
					region = volga_region
					region = steppes_region
				}
			}
			cede_province = UKR
		    add_core = UKR
        }
		UKR = { 
            Pol_ChangeGovMonarchy = { Succession=1 Assembly=2 } 
			add_government_reform = Pol_Nobility3
		}
        every_known_country = {
		    limit = { has_country_flag = cossack_overlord }
			remove_country_modifier = cossacks_in_regular_army 
            add_opinion = {
				who = ROOT
				modifier = cossack_rebellion
			}
			clr_country_flag = cossack_overlord
		}	
		hidden_effect = {
			UKR = { 
				add_accepted_culture = ukrainian
				add_accepted_culture = polish
				change_title_5 = yes
				if = {
					limit = {
						owns = 280 #Kyiv
						NOT = { capital = 280 }			
					}
					Effect_set_capital = { target= 280 }
					log = "FE-POL:[GetYear]:[UKR.GetName]:moved capital to [280.GetName]:flavor_pol.749"
				}
				else_if = {
					limit = {
						capital_scope = {
							NOT = { development = 5 }
							NOT = { province_id = 280 }
						}
						any_owned_province = {
							development = 7
						}
					}
					random_owned_province = {
						limit = {
							development = 7
						}
						save_event_target_as = potential_ruthenia_capital
					}
					Effect_set_capital = { target= event_target:potential_ruthenia_capital }
					log = "FE-POL:[GetYear]:[UKR.GetName]:moved capital to [UKR.Capital.GetName]:flavor_pol.749"
				}
            }
		}	
	}
	option = { #No mercy for traitors!
        name = "flavor_pol.749.b"
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 10 }
		log = "FE-POL:[GetYear]:[Root.GetName]:refused Union of Hadziacz:flavor_pol.749"
        add_prestige = 10
	}
	option = { #Give up ukrainian lands
        name = "flavor_pol.749.c"
		log = "FE-POL:[GetYear]:[Root.GetName]:refused Union of Hadziacz and gave up Ukraine:flavor_pol.749"
		if = {
		    limit = { ZAZ = { war_with = ROOT } }
			white_peace = ZAZ
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -20 }
        add_prestige = -20
		ZAZ = {
		    every_owned_province = {
			    remove_core = ROOT #TODO: remove claim, too?
			}
		}
        set_country_flag = gave_up_ukraine
	}
}

#END OF THE CHMIELNICKI UPRISING
country_event = {
	id = flavor_pol.750
	title = "flavor_pol.750.title"
	desc = "flavor_pol.750.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	fire_only_once = yes
    is_triggered_only = yes #from end of the disaster
	major = yes
	
	immediate = {
	    clr_country_flag = chmielnicki_uprising
        clr_country_flag = chmielnicki_uprising_2
        clr_country_flag = agreement_of_pereyeslavl
	}

	option = { #Peace at last!
        name = "flavor_pol.750.a"
        Stab_Add1 = yes	
	}
}

### VANILLA EVENTS ###

###NICOLAUS COPERNICUS
country_event = {
	id = flavor_pol.5100
	title = "flavor_pol.EVTNAME5100"
	desc = "flavor_pol.EVTDESC5100"
	picture = ADVISOR_eventPicture
	fire_only_once = yes
    major = yes
	
	trigger = {
		owns = 2398 	#Kulm/Torun province
		is_year = 1500
		NOT = { is_year = 1543 }
	}
	mean_time_to_happen = {
		years = 5
	}
	option = {
		name = "EXCELLENT"
		add_prestige = 10
		add_country_modifier = { 
		     name = astronomist_boost
			 duration = 3650
		}
	}
	option = {
		name = "EXCELLENTCMNISTER"
		define_advisor = {
			type = astronomist_BU
			name = "Mikolaj Kopernik"
			skill = 3
			discount = yes
			location = 2398
		}
		set_country_flag = copernicus
	}
}

###THE NIESZAWA PRIVILEGES - 'CONVENTIONES PARTICULARES'
country_event = {
	id = flavor_pol.3467
	title = "flavor_pol.EVTNAME3467"
	desc = "flavor_pol.EVTDESC3467"
	picture = LIBERUM_VETO_eventPicture
	major = yes
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		adm_tech = 23
		NOT = { adm_tech = 30 }
		NOT = { Rights_BUSer2Has = yes } #in case if Poland is able to reform its military
		NOT = { Rights_BUSer3Has = yes }
		NOT = { Rights_BUSer4Has = yes }
		NOT = { Privilege_HasGreater = { Privilege=NOServiceE Lvl=5 } } #in case if nobles are already privileged
		has_reform = Pol_Succession4
		faction_influence = {
            faction = FC_NO
            influence = 50
        }
		is_at_war = yes
		OR = {
		    NOT = { war_score = -10 }
			war_exhaustion = 5
			num_of_loans = 2
		}
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	immediate = { 
		hidden_effect = { 
			set_country_flag = pol_had_nieszawa_privileges_country_flag
			random_core_province = {
			    limit = { NOT = { has_province_flag = war_taxes } }
				set_province_flag = war_taxes
			}
			random_core_province = {
			    limit = { NOT = { has_province_flag = war_taxes } }
				set_province_flag = war_taxes
			}
			random_core_province = {
			    limit = { NOT = { has_province_flag = war_taxes } }
				set_province_flag = war_taxes
			}
			random_core_province = {
			    limit = { NOT = { has_province_flag = war_taxes } }
				set_province_flag = war_taxes
			}
			random_core_province = {
			    limit = { NOT = { has_province_flag = war_taxes } }
				set_province_flag = war_taxes
			}
		} 
	}
	option = {
		name = "flavor_pol.EVTOPTA3467" # Accept the Conventions
		ai_chance = {
			factor = 75
		}
		add_treasury = 200
		Privilege_NOServiceERaise = yes
	    every_owned_province = {
			limit = { has_province_flag = war_taxes }
			Public_ChangeClassWealthVal = { class= NO type = value inp=-40 }
			clr_province_flag = war_taxes
		}
	}
	option = {
		name = "flavor_pol.EVTOPTB3467" # Refuse to sign it and defy the Magnates
		ai_chance = {
			factor = 25
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=-20 }
		add_war_exhaustion = 10
		random_owned_province = {
			limit = {
				is_capital = no
				culture = polish
			}
			spawn_rebels = {
				type = warlord_rebels
				size = 3
			}
		}
	}
}

###THE STATUTE OF PIOTRKOW
country_event = {
	id = flavor_pol.3468
	title = "flavor_pol.EVTNAME3468"
	desc = "flavor_pol.EVTDESC3468"
	picture = COURT_eventPicture
	major = yes
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		NOT = { Rights_NOTen3Has = yes }
		has_reform = Pol_Succession4
		faction_influence = {
            faction = FC_NO
            influence = 40
        }
		is_at_war = yes
		OR = {
		    NOT = { war_score = -10 }
			war_exhaustion = 8
			num_of_loans = 3
		}
		had_country_flag = {
	        flag = pol_had_nieszawa_privileges_country_flag
	        days = 14600 #40 years
        }
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	immediate = { 
		hidden_effect = { 
			set_country_flag = pol_had_statute_of_piotrkow_country_flag
			random_core_province = {
			    limit = { NOT = { has_province_flag = war_taxes } }
				set_province_flag = war_taxes
			}
			random_core_province = {
			    limit = { NOT = { has_province_flag = war_taxes } }
				set_province_flag = war_taxes
			}
			random_core_province = {
			    limit = { NOT = { has_province_flag = war_taxes } }
				set_province_flag = war_taxes
			}
			random_core_province = {
			    limit = { NOT = { has_province_flag = war_taxes } }
				set_province_flag = war_taxes
			}
			random_core_province = {
			    limit = { NOT = { has_province_flag = war_taxes } }
				set_province_flag = war_taxes
			}
		} 
	}
	
	option = {
		name = "flavor_pol.EVTOPTA3468" # Enact
		ai_chance = {
			factor = 75
		}
		add_treasury = 100
		NO_Serfs = yes
	    custom_tooltip = NO_Serfs_effect
		hidden_effect = {
		    every_owned_province = {
			    limit = { has_province_flag = war_taxes }
				Public_ChangeClassWealthVal = { class= NO type = value inp=-20 }
			    clr_province_flag = war_taxes
			}
		}	
	}
	option = {
		name = "flavor_pol.EVTOPTB3468" # Refuse to enact
		ai_chance = {
			factor = 25
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=-10 }
		add_war_exhaustion = 5
		random_owned_province = {
			limit = {
				is_capital = no
				culture = polish
			}
			spawn_rebels = {
				type = warlord_rebels
				size = 2
			}
		}
	}
}

###THE POLISH INHERITANCE OF MAZOVIA
country_event = {
	id = flavor_pol.3473
	title = "flavor_pol.EVTNAME3473"
	desc = "flavor_pol.EVTDESC3473"
	picture = COURT_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		NOT = {
		   exists = MAZ
		}
        owns_core_province = 256		
	}
	
	option = {
		name = "flavor_pol.EVTOPTA3473" # Make it a personal royal fiefdom
		256 = { # Czersk
			add_or_extend_province_modifier_effect = { NAME = rural_development_efforts	DURATION = 3650 }
			custom_tooltip = rural_development_efforts_tt
			add_or_extend_province_modifier_effect = { NAME = urban_development_efforts	DURATION = 3650 }
			custom_tooltip = urban_development_efforts_tt
		}
	}
}

###THE JESUIT KING
country_event = {
	id = flavor_pol.3477
	title = "flavor_pol.EVTNAME3477"
	desc = "flavor_pol.EVTDESC3477"
	picture = COURT_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		check_variable = { which = jesuit_support value = 1 }
 		is_religion_enabled = protestant
		religion = catholic
		has_regency = no
		adm_tech = 40
	}
	
	mean_time_to_happen = {
		months = 200
	}
	
	option = {
		name = "flavor_pol.EVTOPTA3477" # Religious Freedom won the day
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = CL Amount = -10 }
		CL_FactionCrackdown = yes
		add_ruler_modifier = { 
			name = pol_religious_freedom
		}
		hidden_effect = {
			change_variable = { which = jesuit_support value = -1 }
		}
	}
	option = {
		name = "flavor_pol.EVTOPTB3477" # The Catholic Faith are the First among Equals
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = CL Amount = -5 }
        Stab_Add50Percent = yes		
	}
	option = {
		name = "flavor_pol.EVTOPTC3477" # Hail the Jesuit King!
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = CL Amount = 10 }
		CL_FactionBoost = yes
		add_ruler_modifier = { 
			name = pol_jesuit_king 
		}
		hidden_effect = {
			change_variable = { which = jesuit_support value = 1 }
		}
	}
}

###THE PACTA CONVENTA AND THE HENRYKIAN ARTICLES
country_event = {
	id = flavor_pol.3480
	title = "flavor_pol.EVTNAME3480"
	desc = "flavor_pol.EVTDESC3480"
	picture = REFORM_eventPicture
	major = yes
	fire_only_once = yes
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		has_reform = Pol_Succession4
		faction_influence = {
            faction = FC_NO
            influence = 30
        }
		NOT = { Privilege_HasGreater = { Privilege=NOHierarchy Lvl=3 } } #in case if nobles are already privileged
		NOT = { dynasty = "Jagiellon" }
	    NOT = { dynasty = "Piast" }
	    NOT = { dynasty = "Gediminai"}
	}
	
	mean_time_to_happen = {
		months = 1
	}
	
	option = {
		name = "flavor_pol.EVTOPTA3480" # There is nothing we can do my King
		ai_chance = {
			factor = 75
		}
		Stab_Add50Percent = yes
        Privilege_NOHierarchyRaise = yes
	}
	option = {
		name = "flavor_pol.EVTOPTB3467" # Refuse to enact
		ai_chance = {
			factor = 25
		}
		trigger = {
		    NOT = {
			    faction_influence = {
                    faction = FC_NO
                    influence = 50
                }
			}
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=-25 }
		Stab_Subtract2 = yes
		random_owned_province = {
			limit = {
				is_capital = no
				culture = polish
			}
			spawn_rebels = {
				type = warlord_rebels
				size = 3
			}
		}
		random_owned_province = {
			limit = {
				is_capital = no
				culture = polish
			}
			spawn_rebels = {
				type = warlord_rebels
				size = 2
			}
		}
	}
}

###THE SOBIESKIAN ARMY REFORMS
country_event = {
	id = flavor_pol.3485
	title = "flavor_pol.EVTNAME3485"
	desc = "flavor_pol.EVTDESC3485"
	picture = REFORM_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		mil_tech = 47
		num_of_cities = 35
		MIL = 4
		government = monarchy
		NOT = { ruler_age = 40 }
	}
	
	mean_time_to_happen = {
		years = 2
	}
	
	immediate = {
	    set_country_flag = sobieskian_reforms
	}
	
	option = {
		name = "flavor_pol.EVTOPTA3485" # Make a strict Army Reform only
		if = {
		    limit = {
		        MIL = 4
			    NOT = { MIL = 5 }
		    }
		    add_army_tradition = 10
		    add_mil_power = 100
		}
		if = {
		    limit = {
		        MIL = 5
			    NOT = { MIL = 6 }
		    }
		    add_army_tradition = 20
		    add_mil_power = 200
		}
		if = {
		    limit = {
		        MIL = 6
		    }
		    add_army_tradition = 30
		    add_mil_power = 300
		}
		if = {
		    limit = { NOT = { ruler_has_personality = tactical_genius_personality } }
		    add_ruler_personality = tactical_genius_personality
        }
	}
	option = {
		name = "flavor_pol.EVTOPTB3485" # Reform Army and undermine the power of the Sejm
		trigger = {
			faction_influence = {
                faction = FC_NO
                influence = 40
            }
			ADM = 4
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=-10 }
		NO_FactionCrackdown = yes
		
		if = {
		    limit = {
		        MIL = 4
			    NOT = { MIL = 5 }
		    }
		    add_army_tradition = 10
		    add_mil_power = 100
		}
		if = {
		    limit = {
		        MIL = 5
			    NOT = { MIL = 6 }
		    }
		    add_army_tradition = 20
		    add_mil_power = 200
		}
		if = {
		    limit = {
		        MIL = 6
		    }
		    add_army_tradition = 30
		    add_mil_power = 300
		}
		if = {
		    limit = { NOT = { ruler_has_personality = tactical_genius_personality } }
		    add_ruler_personality = tactical_genius_personality
        }
	}
}

###ENDING THE STAGNATION
country_event = {
	id = flavor_pol.3497
	title = "flavor_pol.EVTNAME3497"
	desc = "flavor_pol.EVTDESC3497"
	picture = REFORM_eventPicture
	
	fire_only_once = yes
	major = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		has_reform = Pol_Succession4
		has_country_flag = sobieskian_reforms
		any_country = {
		    OR = {
			    is_rival = ROOT
				is_enemy = ROOT
			}
			is_great_power = yes
			ROOT = {
			    has_won_war_against = {
	                who = PREV
	                max_years_since = 5
                }
			}
		}
	}
	
	mean_time_to_happen = {
		months = 12
	}
	
	option = {
		name = "flavor_pol.EVTOPTA3497" # No, it's too problematic to change the situation
		Stab_Add1 = yes
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=25 }
	}
	option = {
		name = "flavor_pol.EVTOPTB3497" # Let us change this depressive situation
		Pol_ChangeRelationsStateTooltip = { NO=yes type=value val=-25 }
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -25 }
		
		random_owned_province = {
		    limit = {
			    is_capital = no
				continent = europe
				is_in_capital_area = yes
			}
			spawn_rebels = {
					type = warlord_rebels
					size = 3
			}
		}
		random_owned_province = {
		    limit = {
			    is_capital = no
				continent = europe
			}
			spawn_rebels = {
					type = warlord_rebels
					size = 2
			}
		}
		random_owned_province = {
		    limit = {
			    is_capital = no
				continent = europe
			}
			spawn_rebels = {
					type = warlord_rebels
					size = 2
			}
		}
		
		hidden_effect = {
		    Pol_ChangeGovMonarchy = { Succession=1 }
        }
        hidden_effect = {
			set_variable = {
				which = vivente_rege
				value = 0
			}
		}
		custom_tooltip = flavor_pol.610.tooltip.c
	}
}

###MERKURIUSZ POLSKI ORDYNARYJNY
country_event = {
	id = flavor_pol.5101
	title = "flavor_pol.EVTNAME3"
	desc = "flavor_pol.EVTDESC3"
	picture = REFORM_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		has_institution = Scientific_Method
		owns_core_province = 262 #Krakow
	}
	
	mean_time_to_happen = {
		months = 100
	}
	
	option = {
		name = "flavor_pol.EVTOPTA3" # Sponsor the newspaper
		add_treasury = -50
		add_country_modifier = {
			name = pol_merkuriusz_polski_ordynaryjny
			duration = 7300
		}
		hidden_effect = {
		    262 = {
				Public_ChangeClassWealthVal = { class= BG type = value inp=50 }
			}
		}	
	}
	option = {
		name = "flavor_pol.EVTOPTB3" # Allow it
		add_country_modifier = {
			name = pol_merkuriusz_polski_ordynaryjny
			duration = 3650
		}
	}
	option = {
		name = "flavor_pol.EVTOPTC3" # Ban it
		trigger = { is_lesser_in_union = no }
		Stab_Add50Percent = yes
	}
}

###JAN BROZEK
country_event = {
	id = flavor_pol.5102
	title = "flavor_pol.EVTNAME5"
	desc = "flavor_pol.EVTDESC5"
	picture = ADVISOR_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		is_year = 1605
		NOT = { is_year = 1652 }
		owns_core_province = 262 #Krakow
		262 = {
		    OR = {
			    has_province_modifier = LN_Minor
				has_province_modifier = LN_Important
				has_province_modifier = LN_Major
			}
		}
	}
	
	mean_time_to_happen = {
		months = 120
	}
	
	option = {
		name = "flavor_pol.EVTOPTA5" # Hire him as advisor
		add_treasury = -25
		define_advisor = {
			type = natural_scientist_BG
			name = "Jan Brozek"
			culture = polish
			discount = yes
			location = 262
			skill = 2
		}
		hidden_effect = {
		    262 = {
				Public_ChangeClassWealthVal = { class= BG type = value inp=25 }
			}
		}
	}
	option = {
		name = "flavor_pol.EVTOPTB5" # Ignore him
		add_prestige = -1
	}
}

###MICHAL SEDZIWOJ
country_event = {
	id = flavor_pol.5103
	title = "flavor_pol.EVTNAME6"
	desc = "flavor_pol.EVTDESC6"
	picture = ADVISOR_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		is_year = 1600
		NOT = { is_year = 1636 }
		owns_core_province = 262 #Krakow
		262 = {
		    OR = {
			    has_province_modifier = LN_Minor
				has_province_modifier = LN_Important
				has_province_modifier = LN_Major
			}
		}
	}
	
	mean_time_to_happen = {
		months = 120
	}
	
	option = {
		name = "flavor_pol.EVTOPTA5" # Hire him as advisor
		add_treasury = -25
		define_advisor = {
			type = natural_scientist_NO
			name = "Michal Sedziwoj"
			culture = polish
			discount = yes
			location = 262
			skill = 2
		}
		hidden_effect = {
		    262 = {
				Public_ChangeClassWealthVal = { class= NO type = value inp=25 }
			}
		}
	}
	option = {
		name = "flavor_pol.EVTOPTB5" # Ignore him
		add_prestige = -1
	}
}

### COLLEGIUM HOSIANUM
country_event = {
	id = flavor_pol.5104
	title = flavor_pol.14.t
	desc = flavor_pol.14.d

	picture = UNIVERSITY_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		owns_core_province = 1391 #Ermland
		check_variable = { which = jesuit_support value = 1 }
		is_religion_enabled = protestant
		religion = catholic
	}
	
	mean_time_to_happen = {
		months = 45
	}
	
	option = {
		name = flavor_pol.14.a #Great!
		CL_FactionBoost = yes
		1391 = {
			add_province_modifier = {
				name = "pol_collegium_hosianum"
				duration = -1
			}
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = CL Amount = 25 }
		}
		hidden_effect = {
			change_variable = { which = jesuit_support value = 1 }
		}
	}
	option = {
		name = "OPT.NO2"
		add_country_modifier = {
			name = edict_of_tolerance
			duration = 3650
		}
		1391 = {
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = CL Amount = -25 }
		}
	}
}

###THE RADZIWILL BIBLE & THE REFORMATION IN POLAND
country_event = {
	id = flavor_pol.5105
	title = flavor_pol.15.t
	desc = flavor_pol.15.d

	picture = BIG_BOOK_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		religion = catholic
		is_religion_enabled = reformed
		owns = 3762 #Brestie
	}
	
	mean_time_to_happen = {
		years = 25
	}
	
	option = { #We must burn this abomination
		name = flavor_pol.15.a
		add_papal_influence = 10
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = CL Amount = 10 }
		add_country_modifier = {
				name = "religious_intolerance"
				duration = 3650
 		}
	}
	
	option = { #Interesting...
		name = flavor_pol.15.b
		add_papal_influence = -20
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = CL Amount = -20 }
		add_country_modifier = {
			name = edict_of_tolerance
			duration = 3650
		}
	}
}

###THE FATE OF THE COLLEGIUM HOSIANUM
country_event = {
	id = flavor_pol.5106
	title = flavor_pol.16.t
	desc = flavor_pol.16.d

	picture = UNIVERSITY_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		any_owned_province = {
			has_province_modifier = pol_collegium_hosianum
		}
		NOT = { religion = catholic }
	}
	
	mean_time_to_happen = {
		months = 45
	}
	
	option = {
		name = flavor_pol.16.a #Suspend the College
		1391 = {
			remove_province_modifier = pol_collegium_hosianum
		}
		if = {
		    limit = {
			    1391 = {
				    religion = catholic
				}
			}
			1391 = {
			    Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = CL Amount = -25 }
			}
		}
	}
}

### VARIOUS NEW FLAVOUR EVENTS ####

###PAWEL WLODKOWIC
country_event = {
	id = flavor_pol.5107
	title = "flavor_pol.5107.title"
	desc = "flavor_pol.5107.desc"
	picture = ADVISOR_eventPicture
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		religion = catholic
		is_year = 1411
		NOT = { is_year = 1435 }
		owns_core_province = 262 #Krakow
		262 = {
		    OR = {
			    has_province_modifier = LN_Minor
				has_province_modifier = LN_Important
				has_province_modifier = LN_Major
			}
		}
	}
	
	mean_time_to_happen = {
		years = 3
	}
	
	option = {
		name = "flavor_pol.EVTOPTA5"
		add_country_modifier = {
			name = "tolerant_society"
			duration = 1825
		}
		define_advisor = {
			type = theologian_CL
			name = "Pawel Wlodkowic"
			skill = 3
			discount = yes
			location = 262
		}
	}
	option = {
		name = "flavor_pol.EVTOPTB5" # Ignore him
		add_prestige = -1
	}
}

###ZBIGNIEW OLESNICKI
country_event = {
	id = flavor_pol.5108
	title = "flavor_pol.5108.title"
	desc = "flavor_pol.5108.desc"
	picture = ADVISOR_eventPicture
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		religion = catholic
		is_year = 1415
		NOT = { is_year = 1455 }
		owns_core_province = 262 #Krakow
		any_core_province = {
		    area = malopolska_area
		    has_cardinal = yes
		}
	}
	
	mean_time_to_happen = {
		years = 8
	}
	
	option = {
		name = "EXCELLENTCMNISTER"
		define_advisor = {
			type = cardinal_CL
			name = "Zbigniew Olesnicki"
			skill = 3
			discount = yes
			location = 262
		}
	}
}

###PIOTR SKARGA
country_event = {
	id = flavor_pol.5109
	title = "flavor_pol.5109.title"
	desc = "flavor_pol.5109.desc"
	picture = ADVISOR_eventPicture
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		religion = catholic
		is_religion_enabled = protestant
		check_variable = { which = jesuit_support value = 1 }
		is_year = 1571
		NOT = { is_year = 1612 }
		owns_core_province = 262 #Krakow
		262 = {
		    OR = {
			    has_province_modifier = LN_Minor
				has_province_modifier = LN_Important
				has_province_modifier = LN_Major
			}
		}
	}
	
	mean_time_to_happen = {
		years = 3
	}
	
	option = {
		name = "EXCELLENTCMNISTER"
		define_advisor = {
			type = inquisitor_CL
			name = "Piotr Skarga"
			skill = 3
			discount = yes
			location = 262
		}
	}
}

###JAN ZAMOYSKI
country_event = {
	id = flavor_pol.5110
	title = "flavor_pol.5110.title"
	desc = "flavor_pol.5110.desc"
	picture = LIBERUM_VETO_eventPicture
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		is_year = 1563
		NOT = { is_year = 1605 }
		owns_core_province = 259 #Lublin
	}
	
	mean_time_to_happen = {
		years = 3
	}
	
	option = {
		name = "EXCELLENTCMNISTER"
		define_advisor = {
			type = statesman_NO
			name = "Jan Zamoyski"
			skill = 3
			discount = yes
			location = 259
		}
	}
}

###ZAWISZA THE BLACK
country_event = {
	id = flavor_pol.5111
	title = "flavor_pol.5111.title"
	desc = "flavor_pol.5111.desc"
	picture = CONQUEST_eventPicture
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		is_year = 1395
		NOT = { is_year = 1428 }
		owns_core_province = 1279 #Kielce
	}
	
	mean_time_to_happen = {
		years = 5
	}
	
	option = {
		name = "EXCELLENT"
		define_general = {
			name = "Zawisza Czarny z Garbowa"
			fire = 2
			shock = 5
			manuever = 2
			siege = 1
			trait = born_to_the_saddle_personality
		}
	}
}

###JAN KAROL CHODKIEWICZ
country_event = {
	id = flavor_pol.5112
	title = "flavor_pol.5112.title"
	desc = "flavor_pol.5112.desc"
	picture = CONQUEST_eventPicture
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		is_year = 1596
		NOT = { is_year = 1621 }
		owns_core_province = 272 #Vilnius
	}
	
	mean_time_to_happen = {
		years = 5
	}
	
	option = {
		name = "EXCELLENT"
		define_general = {
			name = "Jan Karol Chodkiewicz"
			fire = 3
			shock = 5
			manuever = 5
			siege = 3
			trait = born_to_the_saddle_personality
		}
	}
}

###STANISLAW ZOLKIEWSKI
country_event = {
	id = flavor_pol.5113
	title = "flavor_pol.5113.title"
	desc = "flavor_pol.5113.desc"
	picture = CONQUEST_eventPicture
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		is_year = 1578
		NOT = { is_year = 1620 }
		owns_core_province = 260 #Lvivshchyna
	}
	
	mean_time_to_happen = {
		years = 10
	}
	
	option = {
		name = "EXCELLENT"
		define_general = {
			name = "Stanislaw Zolkiewski"
			fire = 2
			shock = 4
			manuever = 4
			siege = 2
			trait = inspirational_leader_general_personality
		}
	}
}

###STANISLAW KONIECPOLSKI
country_event = {
	id = flavor_pol.5114
	title = "flavor_pol.5114.title"
	desc = "flavor_pol.5114.desc"
	picture = CONQUEST_eventPicture
	fire_only_once = yes
	
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
			tag = PLC
		}
		is_year = 1608
		NOT = { is_year = 1646 }
		owns_core_province = 2832 #Czestochowa
	}
	
	mean_time_to_happen = {
		years = 10
	}
	
	option = {
		name = "EXCELLENT"
		define_general = {
			name = "Stanislaw Koniecpolski"
			fire = 4
			shock = 5
			manuever = 4
			siege = 3
			trait = hardy_warrior_personality
		}
	}
}

### MISSION EVENTS ###

#THE COMMONWEALTH NAVY
country_event = {
	id = flavor_pol.1
	title = "flavor_pol.EVTNAME1"
	desc = "flavor_pol.EVTDESC1"
	picture = NAVAL_MILITARY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
		
	option = {
		name = "flavor_pol.EVTOPTA1" # Build a Great Navy
		add_prestige = 10
		add_navy_tradition = 5
		add_dip_power = 50
		add_treasury = -100

		random_owned_province = {
			limit = { has_port = yes }
			heavy_ship = ROOT
		}
		random_owned_province = {
			limit = { has_port = yes }
			heavy_ship = ROOT
		}
		random_owned_province = {
			limit = { has_port = yes }
			heavy_ship = ROOT
		}
	}
	option = {
		name = "flavor_pol.EVTOPTB1" # Abandon the plans
		add_prestige = -5
	}
}

### LITHUANIAN CIVIL WAR ###

###TRAKAI GOES TO WAR
country_event = {
	id = flavor_pol.724
	title = "flavor_pol.724.title"
	desc = "flavor_pol.724.desc"
	picture = SIEGE_eventPicture
    major = yes
    trigger = { 
        tag = TRK
		is_subject_of = LIT
		is_lesser_in_union = no
		is_at_war = no
		LIT = { 
		    junior_union_with = POL 
			NOT = { dip_tech = 25 }
		}
        POL = {
            has_country_flag = 1_union_krewo
        }		
    }

    fire_only_once = yes
	
    mean_time_to_happen = {
		years = 20
		modifier = {
			factor = 0.5
			NOT = { has_opinion = { who = LIT value = 50 } }
		}
		modifier = {
			factor = 0.5
			NOT = { has_opinion = { who = LIT value = 100 } }
		}
		modifier = {
			factor = 0.5
			NOT = { has_opinion = { who = LIT value = 200 } }
		}
	}
    
	option = { #Fight alone
        ai_chance = { factor = 5 }
        name = "flavor_pol.724.a" 
	    LIT = { country_event = { id = flavor_pol.727 days = 10 } }
		grant_independence = yes
		grant_independence_effect = yes
	} 	
	
	option = { #Ask Teutons for Help
        ai_chance = { factor = 90 }
		name = "flavor_pol.724.b" 
		trigger = {
		    TEU = {
			    exists = yes
				is_free_or_tributary_trigger = yes
			    NOT = { has_country_flag = broken_by_polish }
				num_of_cities = 5
				is_at_war = no
			}
		}
	    LIT = { country_event = { id = flavor_pol.727 days = 10 } }
		TEU = { country_event = { id = flavor_pol.725 } }
		grant_independence = yes
	}
	
	option = { #Compromise with Grand Duke
        ai_chance = { factor = 5 }
        name = "flavor_pol.724.c" 
		set_country_flag = lithuanian_civil_war_peace
		POL = { country_event = { id = flavor_pol.728 days = 10 } }
	} 
}

###HELP FROM TEUTONIC KNIGHTS
country_event = {
	id = flavor_pol.725
	title = "flavor_pol.725.title"
	desc = "flavor_pol.725.desc"
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes #from flavor_pol.724
    fire_only_once = yes

	option = { #Demand territorial concessions
        ai_chance = { factor = 90 }
        name = "flavor_pol.725.a" 
		trigger = { FROM = { owns = 1265 } }
		FROM = { country_event = { id = flavor_pol.726 } }	
	} 
	
	option = { #Help them anyway
        ai_chance = { factor = 10 }
        name = "flavor_pol.725.b"
		create_alliance = FROM
		FROM = {
		    add_opinion = {
				who = ROOT
				modifier = supported_our_cause
		    }
		}
        set_ai_attitude = {
            attitude = attitude_friendly
            who = TRK
        }
		add_trust = {
            who = TRK
            value = 50
            mutual = yes
        }
		add_opinion = {
			who = TRK
			modifier = alliance_with_trakai
		}		
	}	
	
	option = { #Remain neutral
        ai_chance = { factor = 0 }
		name = "flavor_pol.726.c" 
	}

}

###TEUTONS DEMAND SAMOGITIA
country_event = {
	id = flavor_pol.726
	title = "flavor_pol.726.title"
	desc = "flavor_pol.726.desc"
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes
    fire_only_once = yes

	option = { #Agree
        ai_chance = { factor = 90 }
        name = "flavor_pol.726.a"
        set_global_flag = treaty_of_salynas
		create_alliance = FROM
        TEU = {
            set_ai_attitude = {
            attitude = attitude_friendly
            who = TRK
            } 
		    add_trust = {
            who = TRK
            value = 50
            mutual = yes
            }
            add_opinion = {
				who = TRK
				modifier = alliance_with_trakai
		    }
            set_country_flag = promised_samogitia			
	    } 
	}	
	option = { #Refuse
        ai_chance = { factor = 10 }
        name = "flavor_pol.726.b" 
	}	 
}

##LITHUANIAN CIVIL WAR
country_event = {
	id = flavor_pol.727
	title = "flavor_pol.727.title"
	desc = "flavor_pol.727.desc"
	picture = SIEGE_eventPicture
    major = yes
	is_triggered_only = yes
    fire_only_once = yes
   
	option = { #Then war it is!
        name = "flavor_pol.727.a" 
		declare_war_with_cb = {
			who = TRK
			casus_belli = cb_disloyal_vassal
		}
        POL = { set_country_flag = lithuanian_civil_war }
        TRK = { set_country_flag = lithuanian_civil_war }	
	}	
}

##THE OSTROW AGREEMENT (Victory of the Polish king)
country_event = {
	id = flavor_pol.728
	title = "flavor_pol.728.title"
	desc = "flavor_pol.728.desc"
	picture = BATTLE_eventPicture
    major = yes
    fire_only_once = yes
    
	trigger = {
	    tag = POL
		OR = {
		    TRK = { has_country_flag = lithuanian_civil_war_peace }
			AND = {
	            has_country_flag = lithuanian_civil_war
		        war_score_against = {
	                who = TRK
	                value = 40
                }
			}
		}
	}
    
	mean_time_to_happen = { days = 30 }
	
	immediate = {
		white_peace = TRK
		set_global_flag = ostrow_agreement
		hidden_effect = {
		    every_country = {
		        limit = { 
			        is_subject_of = LIT
					OR = {
				        is_subject_of_type = appanage_subject
						is_subject_of_type = personal_union
					}
			    }
			    set_country_flag = lithuanian_appanage
		    }
		}
    }
	
	option = { #Peace at last!
        name = "flavor_pol.728.a"
		add_prestige = 20
		TRK = {
            inherit = LIT
		    change_tag = LIT
		}
        create_subject = {
			subject_type = decentralized_vassal
			subject = LIT
		}
		LIT = {
            add_liberty_desire = -100
			set_ruler_flag = grand_duke_of_lithuania
			if = {
		        limit = {
                    OR = {
			            has_country_modifier = title_5
			            has_country_modifier = title_6
			        } 
		        }
		        change_title_4 = yes
	        }
		}
		POL = { clr_country_flag = lithuanian_civil_war }
        LIT = { clr_country_flag = lithuanian_civil_war }	
    }
    after = {
	    every_country = {
		    limit = { 
			    has_country_flag = lithuanian_appanage 
				ai = yes
			}
		    clr_country_flag = lithuanian_appanage
			LIT = {
			    inherit = PREV
			}
		}
		LIT = {
			add_country_modifier = {
			    name = "grand_duchy_of_lithuania"
			    duration = -1
		    }
		}
    }	
}

##THE OSTROW AGREEMENT (Victory of the duke of Trakai)
country_event = {
	id = flavor_pol.729
	title = "flavor_pol.729.title"
	desc = "flavor_pol.729.desc"
	picture = BATTLE_eventPicture
    major = yes
    fire_only_once = yes
    
	trigger = {
	    tag = TRK
	    has_country_flag = lithuanian_civil_war
		war_score_against = {
	        who = POL
	        value = 40
        }
	}
    
	mean_time_to_happen = { days = 30 }
	
	immediate = {
		white_peace = POL
		set_global_flag = ostrow_agreement
		hidden_effect = {
		    every_country = {
		        limit = { 
			        is_subject_of = LIT
				    is_subject_of_type = appanage_subject
			    }
			    set_country_flag = lithuanian_appanage
		    }
		}
    }
	
	option = { #Peace at last!
        name = "flavor_pol.729.a"
		add_prestige = 20
		LIT  = {
		    break_union = POL
		}		
        inherit = LIT
		change_tag = LIT
        LIT = { clr_country_flag = lithuanian_civil_war }		
		POL = {
		    clr_country_flag = lithuanian_civil_war
		    add_casus_belli = {
				target = LIT
				type = cb_restore_personal_union
				months = 240
			}
		}
    }
    after = {
	    every_country = {
		    limit = { has_country_flag = lithuanian_appanage }
		    clr_country_flag = lithuanian_appanage
			ROOT = {
			    create_subject = {
			        subject_type = appanage_subject
			        subject = PREV
		        }
			}
		}
    }	
}

###TREATY OF SALYNAS (main event}
country_event = {
	id = flavor_pol.730
	title = "flavor_pol.730.title"
	desc = "flavor_pol.730.desc"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
    fire_only_once = yes
    
	trigger = {
	    tag = LIT
	    has_global_flag = treaty_of_salynas
		has_global_flag = ostrow_agreement
		is_at_war = no
	}
    
	mean_time_to_happen = { months = 6 }
	
	immediate = {
	    clr_global_flag = treaty_of_salynas
	}
	
	option = {
        name = "flavor_pol.730.a"
		every_province = {
		    limit = {
			    owned_by = ROOT
				is_core = TEU
			}
			cede_province = TEU
		}
		1265 = { #Samogitia
            cede_province = TEU
		}
	    1280 = { #Sudovia
            cede_province = TEU
		}
		3397 = { #Kaunas
            cede_province = TEU
		}
		add_truce_with = TEU
		TEU = { add_truce_with = ROOT }
		if = {
            limit = { is_subject_of = POL }
			POL = { add_truce_with = TEU }
            TEU = { add_truce_with = POL }			
        }
		TEU = { country_event = { id = flavor_pol.731 days = 1 } }
        if = {
            limit = { is_subject_of = POL }
			POL = { country_event = { id = flavor_pol.731 days = 1 } }	
        }		
    }	
}

###TREATY OF SALYNAS (informative event}
country_event = {
	id = flavor_pol.731
	title = "flavor_pol.731.title"
	desc = "flavor_pol.731.desc"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
    is_triggered_only = yes #from flavor_pol.730
    fire_only_once = yes

	option = {
        name = "flavor_pol.731.a"		
    }	
}

###GRAND DUCHY OF LITHUANIA RETURNED TO THE KING OF POLAND
country_event = {
	id = flavor_pol.732
	title = "flavor_pol.732.title"
	desc = "flavor_pol.732.desc"
	picture = CONQUEST_eventPicture
    
	trigger = {
	    tag = POL
		has_global_flag = ostrow_agreement
	    LIT = { 
			is_subject_of = POL
			OR = {
			    is_subject_of_type = decentralized_vassal
				is_subject_of_type = rebellious_decentralized_vassal
			}
			NOT = { has_ruler_flag = grand_duke_of_lithuania }
		}
	}
	
	mean_time_to_happen = { days = 1 }
	
	option = {
        name = "flavor_pol.732.a"
        create_subject = {
			subject_type = permanent_union
			subject = LIT
		}
		hidden_effect = {
            LIT = {
			    remove_country_modifier = grand_duchy_of_lithuania
		    }
        }		
    }	
}

###SVITRIGAILA ASKS FOR OUR HELP
country_event = {
	id = flavor_pol.760
	title = "flavor_pol.760.title"
	desc = "flavor_pol.760.desc"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
    fire_only_once  = yes
	
	trigger = {
	    tag = TEU
		NOT = { is_year = 1452 } #death of Svitrigaila
		has_global_flag = ostrow_agreement
	    LIT = { 
			is_subject_of = POL 
			is_subject_of_type = decentralized_vassal
			NOT = { stability = 3 }
			NOT = { war_with = ROOT }
			is_neighbor_of = ROOT
			any_owned_province = {
			    region = lithuania_region
			}
		}
	}
	
	mean_time_to_happen = { years = 10 }
	
	option = { #Help him
        name = "flavor_pol.760.a"	
        set_global_flag = svitrigaila_received_help
		add_treasury = -50
        LIT = { country_event = { id = flavor_pol.761 days = 30 } }		
    }
    option = { #Refuse
        name = "flavor_pol.760.b"
        LIT = { country_event = { id = flavor_pol.761 days = 30 } }				
    }		
}

###SVITRIGAILA'S REBELLION
country_event = {
	id = flavor_pol.761
	title = "flavor_pol.761.title"
	desc = "flavor_pol.761.desc"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
    is_triggered_only = yes #from flavor.pol.733
	fire_only_once  = yes
	
	trigger = {
	    tag = LIT
		is_subject_of = POL
        any_owned_province = {
		    region = lithuania_region
		}		
	}
	
	option = {
        name = "flavor_pol.761.a"	
        if = {
		    limit =  {
			    has_global_flag = svitrigaila_received_help
			}
			random_owned_province = {
			    limit = {
				    region = lithuania_region
				}
				spawn_rebels = {
				    type = pretender_rebels
				    size = 3
				    leader = "Svitrigaila Gediminai"
				    leader_dynasty = "Gediminai"
					friend = TEU
					should_take_capital = yes
					win = yes
			    }
			}
			clr_global_flag = svitrigaila_received_help
		}
		else = {
			random_owned_province = {
			    limit = {
				    region = lithuania_region
				}
				spawn_rebels = {
				    type = pretender_rebels
				    size = 2
				    leader = "Svitrigaila Gediminai"
				    leader_dynasty = "Gediminai"
					should_take_capital = yes
					win = yes
			    }
			}
		}
		hidden_effect = {
            POL = { country_event = { id = flavor_pol.762 days = 1 } }
        }		
    }
    after = {
        set_country_flag = svitrigaila_rebellion 
    }	
}

###SVITRIGAILA'S REBELLION (INFORMATIVE EVENT)
country_event = {
	id = flavor_pol.762
	title = "flavor_pol.761.title"
	desc = "flavor_pol.761.desc"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
    is_triggered_only = yes #from flavor.pol.734
	fire_only_once  = yes
	
	option = {
        name = "flavor_pol.761.a"
    }	
}

###END OF SVITRIGAILA'S REBELLION
country_event = {
	id = flavor_pol.763
	title = "flavor_pol.763.title"
	desc = "flavor_pol.763.desc"
	picture = IMPALED_SOLDIERS_eventPicture
	fire_only_once  = yes

	trigger = {
	    tag = POL
	    LIT = { 
			is_subject_of = POL
            has_country_flag = svitrigaila_rebellion			
			NOT = { has_ruler = "Svitrigaila" }
			NOT = { num_of_rebel_armies = 1 }
			NOT = { num_of_rebel_controlled_provinces = 1 }
		}
	}
	
	immediate = {
	    LIT = { clr_country_flag = svitrigaila_rebellion }
	}
	
	option = { #Pardon him
        name = "flavor_pol.763.a"
		add_legitimacy = 5
		add_prestige = -10
		LIT = {
		    Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=10 }
			add_liberty_desire = -10
			set_country_flag = pardoned_svitrigaila
		}
    }
    option = { #Execute him
        name = "flavor_pol.763.b"
		add_legitimacy = -10
		add_prestige = 5
		LIT = {
		    Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker=NO Amount=-20 }
			add_liberty_desire = 20
		}
    }	
}

###SECOND SVITRIGAILA'S REBELLION
country_event = {
	id = flavor_pol.764
	title = "flavor_pol.764.title"
	desc = "flavor_pol.764.desc"
	picture = IMPALED_SOLDIERS_eventPicture
	fire_only_once  = yes
    
	trigger = {
	    tag = LIT
		NOT = { is_year = 1452 } #death of Svitrigaila
		NOT = { stability = 3 }
		has_country_flag = pardoned_svitrigaila
		is_subject_of = POL 
		OR = {
			is_subject_of_type = permanent_union 
			is_subject_of_type = permanent_union_limited
		}
		any_owned_province = {
			OR = {
			    region = ruthenia_region
				region = belarus_region
			}
		}
		POL = {
		    has_country_flag = 2_union_horodlo
		}
	}
	
	mean_time_to_happen = { years = 2 }
	
	option = {
        name = "flavor_pol.764.a"	
        random_owned_province = {
			    limit = {
				    OR = {
			            region = ruthenia_region
				        region = belarus_region
			        }
				}
				spawn_rebels = {
				    type = pretender_rebels
				    size = 2
				    leader = "Svitrigaila Gediminai"
				    leader_dynasty = "Gediminai"
					win = yes
			    }
	    }
		hidden_effect = {
            POL = { country_event = { id = flavor_pol.765 days = 1 } }
        }		
    }
    after = {
        set_country_flag = second_svitrigaila_rebellion 
    }		
}

###SECOND SVITRIGAILA'S REBELLION (INFORMATIVE EVENT)
country_event = {
	id = flavor_pol.765
	title = "flavor_pol.764.title"
	desc = "flavor_pol.764.desc"
	picture = IMPALED_SOLDIERS_eventPicture
    is_triggered_only = yes #from flavor.pol.737
	fire_only_once  = yes
	
	option = {
        name = "flavor_pol.764.a"
    }	
}

###END OF SECOND SVITRIGAILA'S REBELLION
country_event = {
	id = flavor_pol.766
	title = "flavor_pol.766.title"
	desc = "flavor_pol.766.desc"
	picture = IMPALED_SOLDIERS_eventPicture
	fire_only_once  = yes

	trigger = {
	    tag = POL
	    LIT = { 
			is_subject_of = POL
            has_country_flag = second_svitrigaila_rebellion			
			NOT = { has_ruler = "Svitrigaila" }
			NOT = { num_of_rebel_armies = 1 }
			NOT = { num_of_rebel_controlled_provinces = 1 }
		}
	}
	
	immediate = {
	    LIT = { clr_country_flag = second_svitrigaila_rebellion }
	}
	
	option = { #Choose Sigismund Kestutatis as a Grand Duke
        name = "flavor_pol.766.a"
		add_prestige = 10
		hidden_effect = {
		    break_union = LIT
		}
		create_subject = {
			subject_type = decentralized_vassal
			subject = LIT
		}
		LIT = {
		    define_ruler = {
                name = "Sigismund Kestutatis"
                dynasty = "Gediminai"
                adm = 3
                dip = 4
                mil = 4
                age = 50
                claim = 95
            }
            add_liberty_desire = -100
			set_ruler_flag = grand_duke_of_lithuania
			if = {
		        limit = {
                    OR = {
			            has_country_modifier = title_5
			            has_country_modifier = title_6
			        } 
		        }
		        change_title_4 = yes
	        }
		}
    }
    after = {
		LIT = {
			add_country_modifier = {
			    name = "grand_duchy_of_lithuania"
			    duration = -1
		    }
		}
    }	  	
}

###ELECTION IN LITHUANIA
country_event = {
	id = flavor_pol.767
	title = "flavor_pol.767.title"
	desc = "flavor_pol.767.desc"
	picture = LIBERUM_VETO_eventPicture
	fire_only_once  = yes
	is_triggered_only = yes #on_monarch_death

	trigger = {
	    tag = POL
		has_regency = no
	    LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}		
		}
		has_country_flag = 4_union_krakow
		NOT = {
			exists = PLC
		}
	}
	
	option = {
        name = "OPT.SOBEIT"
		add_legitimacy = 10
		hidden_effect = {
		    break_union = LIT
		}
		create_subject = {
			subject_type = decentralized_vassal
			subject = LIT
		}
		if = {
		    limit = { NOT = { has_ruler = "Aleksander" } }
			LIT = {
			    define_ruler = { 
			        name = "Aleksander"
                    dynasty = ROOT
				    culture = ROOT
				    religion = ROOT
                    age = 16
				    male = yes
                    claim = 95
                }
			}
		}
		else = {
		    LIT = {
			    define_ruler = { 
			        name = "Jan Olbracht"
                    dynasty = ROOT
				    culture = ROOT
				    religion = ROOT
                    age = 16
				    male = yes
                    claim = 95
                }
			}
		}
		LIT = {
            add_liberty_desire = -100
			set_ruler_flag = grand_duke_of_lithuania
			if = {
		        limit = {
                    OR = {
			            has_country_modifier = title_5
			            has_country_modifier = title_6
			        } 
		        }
		        change_title_4 = yes
	        }
		}
    }
    after = {
		LIT = {
			add_country_modifier = {
			    name = "grand_duchy_of_lithuania"
			    duration = -1
		    }
		}
    }	  	
}

###TURN TRAKAI INTO APPANAGE (HIDDEN EVENT IN CASE IF LIT CIVIL WAR DIDN'T HAPPEN)
country_event = {
	id = flavor_pol.768
	title = "flavor_pol.768.title"
	desc = "flavor_pol.768.desc"
	picture = IMPALED_SOLDIERS_eventPicture
	fire_only_once  = yes
	hidden = yes
    
	trigger = {
	    tag = LIT
		dip_tech = 25 #around year 1450
		TRK = {
		    exists = yes
			is_subject_of = ROOT
			is_subject_of_type = decentralized_vassal
		}
	}
	
	mean_time_to_happen = { days = 1 }
	
	option = {
        name = "flavor_pol.768.a"
        create_subject = {
				subject_type = appanage_subject
				subject = TRK
		}
	}	
}