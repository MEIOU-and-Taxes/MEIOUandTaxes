namespace = mec_vassals

# Vassal Reversion Events #

country_event = { # $Tag$ Reverts to the Crown, insp., Burgundy and France
	id = mec_vassals.1
	title = "mec_vassals_1_title"
	desc = "mec_vassals_1_desc"
	picture = GOOD_WITH_MONARCH_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = mec_vassals.1.a
		if = {
			limit = {
				FROM = {
					is_overseas_subject = yes
				}
			}
			log = "MEC-Vassals:[GetYear]:[Root.GetName]:inherits their overseas fief [From.GetName]:mec_vassals.1"
			create_subject = {
				subject_type = overseas_fief
				subject = FROM
			}
		}
		else = {
			log = "MEC-Vassals:[GetYear]:[Root.GetName]:got their appanage ([From.GetName]) into PU:mec_vassals.1"
			create_subject = {
				subject_type = personal_union
				subject = FROM
			}
			if = {
				limit = {
					FROM = {
						tag = ANJ
					}
				}
				FRA = {
					country_event = {
						id = flavor_anj.3 
					}
				}
			}
		}
		reverse_add_opinion = {
			who = FROM
			modifier = union_appanage
		}
		ai_chance = {
			factor = 2
			modifier = {
				factor = 2
				ruler_has_personality = greedy_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = selfish_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = proud_personality
			}
			modifier = {
				factor = 2
				check_key = { lhs = Prov_BUPow value = 30 }
			}
			modifier = {
				factor = 2
				check_key = { lhs = Prov_BUPow value = 45 }
			}
			modifier = {
				factor = 2
				check_key = { lhs = Prov_BUPow value = 55 }
			}
		}
	}
	option = {
		name = mec_vassals.1.b
		log = "MEC-Vassals:[GetYear]:[Root.GetName]:continued treating [From.GetName] as appanage, refused PU:mec_vassals.1"

		FROM = {
			set_country_flag = Had_Heir
			define_ruler = {
				dynasty = PREV
				culture = PREV
				religion = PREV
			}
			define_heir = {
				dynasty = PREV
				culture = PREV
				religion = PREV
			}
		}
		reverse_add_opinion = {
			who = FROM
			modifier = continued_appanage
		}
		ai_chance = {
			factor = 0.5
			modifier = {
				factor = 2
				ruler_has_personality = weak_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = modest_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = kind_hearted_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = benevolent_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = generous_personality
			}
			modifier = {
				factor = 2
				OR = {
					personal_union  = 1
					personal_union_limited  = 1
				}
				FROM = { total_development	= 30 } #it is safe to get them into PU, as annexation will be swift
			}
			modifier = {
				factor = 2
				OR = {
					personal_union  = 2
					personal_union_limited  = 2
				}				
				FROM = { total_development	= 30 } #it is safe to get them into PU, as annexation will be swift
			}			
		}
	}
}

# Realm Collapse #

country_event = { # Dissolution of the Realm, insp Serbia c. 1371
	id = mec_vassals.2
	title = "mec_vassals_2_title"
	desc = "mec_vassals_2_desc"
	picture = BORDER_TENSION_eventPicture
	
	is_triggered_only = yes
	major = yes
	
	option = {
		name = mec_vassals.2.a
		every_subject_country = {
			limit = {
				OR = {
					is_subject_of_type = decentralized_vassal
					is_subject_of_type = rebellious_decentralized_vassal
				}
			}
			log = "MEC-Vassals:[GetYear]:[Root.GetName]:granted independence to its decentralized vassal, [This.GetName]:mec_vassals.2"
			grant_independence_effect = yes
			hidden_effect = {
				every_owned_province = {
					limit = {
						is_core = THIS
					}
					add_claim = ROOT
				}
			}
		}
		add_prestige = -40
		Stab_Add1 = yes
		if = {
			limit = {
				OR = {
					has_country_modifier = title_4
					has_country_modifier = title_5
					has_country_modifier = title_6
				}
			}
			change_title_3 = yes
		}
				
		ai_chance = {
			factor = 50
			modifier = {
				factor = 2
				ruler_has_personality = weak_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = modest_personality
			}
			#modifier = {
			#	factor = 2
			#	ruler_has_personality = coward
			#}
			modifier = {
				factor = 1.5
				ruler_has_personality = lazy_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = careful_personality
			}
			modifier = {
				factor = 5
				is_bankrupt = yes
			}
			modifier = {
				factor = 1.5
				num_of_loans = 3
			}
			modifier = {
				factor = 1.5
				num_of_loans = 5
			}
			modifier = {
				factor = 1.5
				num_of_loans = 7
			}
			modifier = {
				factor = 1.5
				war_exhaustion = 5
			}
			modifier = {
				factor = 1.5
				war_exhaustion = 10
			}
			modifier = {
				factor = 1.1
				is_at_war = yes
			}
			modifier = {
				factor = 1.5
				NOT = { manpower_percentage = 0.1 }
			}
			modifier = {
				factor = 1.5
				NOT = { manpower_percentage = 0.2 }
			}
			modifier = {
				factor = 1.5
				NOT = { manpower_percentage = 0.3 }
			}
		}
	}
	option = {
		name = mec_vassals.2.b
		log = "MEC-Vassals:[GetYear]:[Root.GetName]:refused to give independence to its decentralized vassals, sent ultimatum:mec_vassals.2"

		every_subject_country = {
			limit = {
				OR = {
					is_subject_of_type = rebellious_decentralized_vassal
					is_subject_of_type = decentralized_vassal
				}
			}
			hidden_effect = {
				grant_independence_effect = yes
			}
			country_event = {
				id = mec_vassals.3
			}
		}
		
		add_legitimacy = 20
		
		convert_ruler_to_general = yes
		
		ai_chance = {
			factor = 50
			
			modifier = {
				factor = 2
				ruler_has_personality = valorous_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = proud_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = aggressive_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = vengeful_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = reckless_personality
			}
		}
	}
}

country_event = { # An Ultimatum
	id = mec_vassals.3
	title = "mec_vassals_3_title"
	desc = "mec_vassals_3_desc"
	picture = DIPLOMACY_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			add_opinion = {
				modifier = illegitimate_overlord
				who = FROM
			}
			export_to_key = { lhs = Vassal_Tmp0 value = total_development }
			export_to_key = { lhs = Vassal_Tmp1 value = total_development who = FROM }
			divide_key = { lhs = Vassal_Tmp0 which = Vassal_Tmp1 }
		}
	}
	
	option = {
		name = mec_vassals.3.a
			add_prestige = -10
			FROM = {
				log = "MEC-Vassals:[GetYear]:[Root.GetName]:was subjected back to the decentralized vassal of [From.GetName] status:mec_vassals.3"
				create_subject = {
					subject = ROOT
					subject_type = decentralized_vassal
				}
			}
			hidden_effect = {				
				set_key = { lhs = Vassal_Tmp0 value = 0 }
				set_key = { lhs = Vassal_Tmp1 value = 0 }
			}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				ruler_has_personality = weak_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = modest_personality
			}
			#modifier = {
			##	factor = 2
			#	ruler_has_personality = coward
			#}
			modifier = {
				factor = 1.5
				ruler_has_personality = lazy_personality
			}
			modifier = {
				factor = 1.5
				ruler_has_personality = careful_personality
			}
			modifier = {
				factor = 5
				is_bankrupt = yes
			}
			modifier = {
				factor = 1.5
				num_of_loans = 3
			}
			modifier = {
				factor = 1.5
				num_of_loans = 5
			}
			modifier = {
				factor = 1.5
				num_of_loans = 7
			}
			modifier = {
				factor = 1.5
				war_exhaustion = 5
			}
			modifier = {
				factor = 1.5
				war_exhaustion = 10
			}
			modifier = {
				factor = 1.1
				is_at_war = yes
			}
			modifier = {
				factor = 1.5
				NOT = { manpower_percentage = 0.1 }
			}
			modifier = {
				factor = 1.5
				NOT = { manpower_percentage = 0.2 }
			}
			modifier = {
				factor = 1.5
				NOT = { manpower_percentage = 0.3 }
			}
		}
	}
	option = {
		name = mec_vassals.3.b
		hidden_effect = {
			every_owned_province = {
				limit = {
					is_core = THIS
				}
				add_claim = FROM
			}
			set_key = { lhs = Vassal_Tmp0 value = 0 }
			set_key = { lhs = Vassal_Tmp1 value = 0 }
		}
		log = "MEC-Vassals:[GetYear]:[Root.GetName]:was attacked by [From.GetName] after rejecting to become theirs vassals:mec_vassals.3"

		FROM = {
			declare_war_with_cb = {
				casus_belli = cb_annex
				who = PREV
			}
		}
			
		ai_chance = {
			factor = 75
			modifier = {
				factor = 2
				has_opinion = {
					value = 150
					who = FROM
				}
			}
			modifier = {
				factor = 2
				check_key = { lhs = Vassal_Tmp0 value = 0.33 }
			}
			modifier = {
				factor = 2
				ruler_has_personality = greedy_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = malevolent_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = selfish_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = proud_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = aggressive_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = vengeful_personality
			}
			modifier = {
				factor = 2
				ruler_has_personality = reckless_personality
			}
			modifier = {
				factor = 2
				any_owned_province = {
					any_neighbor_province = {
						NOT = {
							owned_by = FROM
						}
					}
				}
			}
		}					
	}
}



country_event = { # Releasing $Tag$
	id = mec_vassals.5
	title = "mec_vassals_5_title"
	desc = "mec_vassals_5_desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = mec_vassals.5.a
		trigger = {
			subject_centralisation_trigger = no
			government = monarchy
		}
		log = "MEC-Vassals:[GetYear]:[Root.GetName]:created an appanage from [From.GetName]:mec_vassals.5"
		create_subject = {
			subject_type = appanage_subject
			subject = FROM
		}
		FROM = { 
			define_ruler = {
				dynasty = ROOT
			}
		}
		add_absolutism = -10
		ai_chance = {
			factor = 0
		}
	}
	option = {
		name = mec_vassals.5.b
		trigger = {
			subject_centralisation_trigger = no
		}
		log = "MEC-Vassals:[GetYear]:[Root.GetName]:created feudatory from [From.GetName]:mec_vassals.5"
		FROM = { hidden_effect = { set_key = { lhs = Vassal_Type value = 10 } } }
		create_subject = {
			subject_type = daimyo_vassal
			subject = FROM
		}
		add_absolutism = -10
		ai_chance = {
			factor = 0
		}
	}
	option = {
		name = mec_vassals.5.c
		trigger = {
			OR = {
				NOT = {
					has_reform = Pol_Structure3
					#is_key_equal = { lhs = Pol_Structure value = 4 }
				}
                has_country_flag = centralised_japan
			}
		}
		log = "MEC-Vassals:[GetYear]:[Root.GetName]:created division from [From.GetName]:mec_vassals.5"
		create_subject = {
			subject_type = decentralized_vassal
			subject = FROM
		}
		add_absolutism = -10
		ai_chance = {
			factor = 0
		}
	}
	option = {
		name = mec_vassals.5.d
		trigger = {
			OR = {
				NOT = { culture_group = japanese_g }
				FROM = { NOT = { culture_group = japanese_g } }
				AND = {
					subject_centralisation_trigger = yes
					has_reform = Pol_Structure3
					#is_key_equal = { lhs = Pol_Structure value = 4 }
				}
                has_country_flag = centralised_japan
			}
		}
		create_subject = {
			subject_type = custom_vassal
			subject = FROM
		}
		ai_chance = {
			factor = 1
		}
	}
	
	after = {
		FROM = {
			subject_transition_effect = yes
			vassal_type_tracking_effect = yes
		}
	}
}

### AI only event to call subjects into war
country_event = { # Feudatories and Appanages chose whether to fight, I hated writing this whole event chain so much
	id = mec_vassals.6
	title = "mec_vassals_6_title"
	desc = "mec_vassals_6_desc"
	picture = LAND_MILITARY_eventPicture
	
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			save_global_event_target_as = subject_cta_overlord
			
			set_key = { lhs = Diplo_Tmp0 value = 0 }

			Get_Country_Of_Type = { 
				inp = Diplo_Tmp0 
				mode = save_global_event_target_as 
				loop = every_subject_country
				autonomous_vassals = yes
			}
			
			Setup_Subject_Call_to_Arms = yes

			every_subject_country = {
				limit = {
					OR = {
						is_subject_of_type = appanage_subject
						is_subject_of_type = daimyo_vassal
						is_subject_of_type = personal_union_limited
						is_subject_of_type = temporary_union_limited
						is_subject_of_type = permanent_union_limited
					}
				}

				save_event_target_as = subject_cta_subject

				if = {
					limit = {
						OR = {
							is_subject_of_type = appanage_subject
							is_subject_of_type = daimyo_vassal
							is_subject_of_type = personal_union_limited
							is_subject_of_type = temporary_union_limited
							is_subject_of_type = permanent_union_limited
						}
					}
					ROOT = {
						Recalculate_Subject_Call_to_Arms = {
							subject_cta_scp1 = event_target:subject_cta_overlord
							subject_cta_scp2 = event_target:subject_cta_subject
							base_val = -20
						}
						Save_AI_Reasons_ToScope = { scp = event_target:subject_cta_subject }
					}
				}
				else = {
					ROOT = {
						Recalculate_Subject_Call_to_Arms = {
							subject_cta_scp1 = event_target:subject_cta_overlord
							subject_cta_scp2 = event_target:subject_cta_subject
							base_val = 0
						}
						Save_AI_Reasons_ToScope = { scp = event_target:subject_cta_subject }
					}
				}				

				if = {
					limit = { check_key = { lhs = AI_Reasons_Outcome value = 0.001 } }

					set_country_flag = subject_cta_positive
				}
				else = {
					set_country_flag = subject_cta_negative
				}
			}
		}
	}

	option = { ## call all positive reactions
		name = "mec_vassals.6.a"
		
		every_subject_country = {
			limit = {
				has_country_flag = subject_cta_positive
			}
			save_event_target_as = subject_cta_subject

			event_target:subject_cta_overlord = {
				Subject_Call_to_Arms_Execute = {
					scp_overlord = event_target:subject_cta_overlord
					scp_subject = event_target:subject_cta_subject
				}
			}
		}

		ai_chance = {
			factor = 10
			modifier = {
				factor = 10
				OR = {
					tag = FRA
					tag = ENG
				}
				has_global_flag = hundred_years_war
			}
			modifier = {
				factor = 5
				is_in_war = {
					defender_leader = ROOT
				}
			}
		}
	}
	option = { ## call all subjects regardless of reaction
		name = "mec_vassals.6.b"		

		every_subject_country = {
			limit = {
				OR = {
					has_country_flag = subject_cta_positive
					has_country_flag = subject_cta_negative
				}
				is_at_war = yes
			}
			save_event_target_as = subject_cta_subject

			event_target:subject_cta_overlord = {
				Subject_Call_to_Arms_Execute = {
					scp_overlord = event_target:subject_cta_overlord
					scp_subject = event_target:subject_cta_subject
				}
			}
		}

		ai_chance = { factor = 0 }
	}
	
	option = {
		name = "CTA_Subject_0"
		trigger = { 
			check_key = { lhs = Diplo_Tmp0 value = 1 }
		}
		event_target:Diplo_Country_0 = { custom_tooltip = AI_Reasons_Display_CTP }
		ai_chance = { factor = 0 }
	}
	option = {
		name = "CTA_Subject_1"
		trigger = { 
			check_key = { lhs = Diplo_Tmp0 value = 2 }
		}
		event_target:Diplo_Country_1 = { custom_tooltip = AI_Reasons_Display_CTP }
		ai_chance = { factor = 0 }
	}
	option = {
		name = "CTA_Subject_2"
		trigger = { 
			check_key = { lhs = Diplo_Tmp0 value = 3 }
		}
		event_target:Diplo_Country_2 = { custom_tooltip = AI_Reasons_Display_CTP }
		ai_chance = { factor = 0 }
	}	
	option = {
		name = "CTA_Subject_3"
		trigger = { 
			check_key = { lhs = Diplo_Tmp0 value = 4 }
		}
		event_target:Diplo_Country_3 = { custom_tooltip = AI_Reasons_Display_CTP }
		ai_chance = { factor = 0 }
	}	
	option = {
		name = "CTA_Subject_4"
		trigger = { 
			check_key = { lhs = Diplo_Tmp0 value = 5 }
		}
		event_target:Diplo_Country_4 = { custom_tooltip = AI_Reasons_Display_CTP }
		
		ai_chance = { factor = 0 }
	}	
	option = {
		name = "CTA_Subject_5"
		trigger = { 
			check_key = { lhs = Diplo_Tmp0 value = 6 }
		}
		event_target:Diplo_Country_5 = { custom_tooltip = AI_Reasons_Display_CTP }
		
		ai_chance = { factor = 0 }
	}	
	option = {
		name = "CTA_Subject_6"
		trigger = { 
			check_key = { lhs = Diplo_Tmp0 value = 7 }
		}
		event_target:Diplo_Country_6 = { custom_tooltip = AI_Reasons_Display_CTP }
		
		ai_chance = { factor = 0 }
	}
	option = {
		name = "CTA_Subject_7"
		trigger = { 
			check_key = { lhs = Diplo_Tmp0 value = 8 }
		}
		event_target:Diplo_Country_7 = { custom_tooltip = AI_Reasons_Display_CTP }
		
		ai_chance = { factor = 0 }
	}
	option = {
		name = "CTA_Subject_8"
		trigger = { 
			check_key = { lhs = Diplo_Tmp0 value = 9 }
		}
		event_target:Diplo_Country_8 = { custom_tooltip = AI_Reasons_Display_CTP }
		
		ai_chance = { factor = 0 }
	}
	option = {
		name = "CTA_Subject_9"
		trigger = { 
			check_key = { lhs = Diplo_Tmp0 value = 10 }
		}
		event_target:Diplo_Country_9 = { custom_tooltip = AI_Reasons_Display_CTP }
		
		ai_chance = { factor = 0 }
	}

	option = {		#Don't call upon any vassal
		name = mec_vassals.6.c
		ai_chance = {
			factor = 0
		}
	}
	after = {
		Clean_Countries_Of_Type = { gbl_event_target = yes }
		clr_country_flag = subject_cta_attacker
		clr_country_flag = subject_cta_defender
		Clr_AI_Reasons = yes
		every_subject_country = {
			Clr_AI_Reasons = yes
			clr_country_flag = subject_cta_positive
			clr_country_flag = subject_cta_negative
		}
	}
}




country_event = {
	id = mec_vassals.8
	title = "mec_vassals_8_title"
	desc = "mec_vassals_8_desc"
	picture = aionly_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	trigger = {
	}
	
	immediate = {
		every_country = {
			limit = {
				any_subject_country = {
					OR = {
						is_subject_of_type = vassal
						is_subject_of_type = custom_vassal
						is_subject_of_type = personal_union
						is_subject_of_type = personal_union_limited
					}
				}
			}
			country_event = { id = mec_vassals.9 days = 1 }
		}
	}
	
	option = {
		name = mec_vassals.8.a
				
		ai_chance = {
			factor = 1 
		}
	}
}

#ROOT = Overlord
country_event = {
	id = mec_vassals.9
	title = "mec_vassals_9_title"
	desc = "mec_vassals_9_desc"
	picture = aionly_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	trigger = {
	}
	
	immediate = {
		every_subject_country = {
			limit = {
				OR = {
					is_subject_of_type = vassal
					is_subject_of_type = custom_vassal
					is_subject_of_type = personal_union
					is_subject_of_type = personal_union_limited
				}
			}
			if = { limit = {
					OR = {
						is_subject_of_type = vassal
						is_subject_of_type = custom_vassal
					}
					NOT = { subject_integrated_trigger = yes }
				}	
				calc_integration_progress = { type = vassal }
				check_integration_progress = yes
			}
			else_if = { limit = { 
					OR = {
						is_subject_of_type = personal_union 
						is_subject_of_type = personal_union_limited
					}
					NOT = { subject_integrated_trigger = yes }					
				}
				calc_integration_progress = { type = personal_union }
				check_integration_progress = yes
			}
		}
	}
	
	option = {
		name = mec_vassals.8.a
				
		ai_chance = {
			factor = 1 
		}		
	}
}
country_event = {
	id = mec_vassals.10
	title = no_localisation
	desc = no_localisation
	picture = aionly_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	immediate = {
		subject_transition_effect = yes
	}
	
	option = {
		name = no_localisation
	}
}
#Notification events for subject status change
country_event = {
	id = mec_vassals.11
	title = "mec_vassals.11.title"
	desc = "mec_vassals.11.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.VERYWELL"
	}
}
country_event = {
	id = mec_vassals.12
	title = "mec_vassals.12.title"
	desc = "mec_vassals.12.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.DAMN"
		hidden_effect = { if = { limit = { has_saved_event_target = subject_notify_name_et } clear_global_event_target = subject_notify_name_et } }
	}
}
country_event = {
	id = mec_vassals.13
	title = "mec_vassals.13.title"
	desc = "mec_vassals.13.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.DULYNOTED2"
	}
}
country_event = {
	id = mec_vassals.14
	title = "mec_vassals.14.title"
	desc = "mec_vassals.14.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.VERYWELL"
		hidden_effect = { if = { limit = { has_saved_event_target = subject_notify_name_et } clear_global_event_target = subject_notify_name_et } }
	}
}
country_event = {
	id = mec_vassals.15
	title = "mec_vassals.15.title"
	desc = "mec_vassals.15.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.VERYWELL"
	}
}
country_event = {
	id = mec_vassals.16
	title = "mec_vassals.16.title"
	desc = "mec_vassals.16.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.GOOD2"	# "Very good!"
		hidden_effect = { if = { limit = { has_saved_event_target = subject_notify_name_et } clear_global_event_target = subject_notify_name_et } }
	}
}
country_event = {
	id = mec_vassals.17
	title = "mec_vassals.17.title"
	desc = "mec_vassals.17.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.DULYNOTED2"
	}
}
country_event = {
	id = mec_vassals.18
	title = "mec_vassals.18.title"
	desc = "mec_vassals.18.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.VERYWELL"
		hidden_effect = { if = { limit = { has_saved_event_target = subject_notify_name_et } clear_global_event_target = subject_notify_name_et } }
	}
}
country_event = {
	id = mec_vassals.19
	title = "mec_vassals.19.title"
	desc = "mec_vassals.19.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.DULYNOTED2"
	}
}
country_event = {
	id = mec_vassals.20
	title = "mec_vassals.20.title"
	desc = "mec_vassals.20.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.VERYWELL"
	}
}
country_event = {
	id = mec_vassals.21
	title = "mec_vassals.21.title"
	desc = "mec_vassals.21.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.DAMN"
		log = "MEC-Vassals:[GetYear]:[Root.GetName]:switched from their special status to regular PU with [Root.Overlord.GetName]:mec_vassals.21"
	}
}
country_event = {
	id = mec_vassals.22
	title = "mec_vassals.22.title"
	desc = "mec_vassals.22.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.VERYWELL"
	}
}
country_event = {
	id = mec_vassals.23
	title = "mec_vassals.21.title"
	desc = "mec_vassals.23.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.DAMN"
		log = "MEC-Vassals:[GetYear]:[Root.GetName]:switched from their special status to regular PU with [Root.Overlord.GetName]:mec_vassals.21"
	}
}
country_event = {
	id = mec_vassals.24
	title = "mec_vassals.22.title"
	desc = "mec_vassals.24.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	option = {
		name = "OPT.VERYWELL"
	}
}

country_event = {
	id = mec_vassals.25
	title = "mec_vassals.25.title"

	desc = {
		trigger = {
			FROM = {
				OR = {
					has_regency = yes
					has_consort_regency = yes
				}
			}
		}
		desc = mec_vassals.25.desc_regency
	}
	desc = {
		trigger = {
			FROM = {
				NOT = { has_regency = yes }
				NOT = { has_consort_regency = yes }
			}		
		}
		desc = mec_vassals.25.desc
	}

	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes
	
	trigger = {
		FROM = {
			exists = yes #to prevent situation where event is trigerred by a country that is inherited during same day, such that overlord gets event targetting themselves, not their subject
			#note: if this is not working properly, add an intermediary event, with one-day delay so situation clears up
		}
	}

	option = {
		name = "mec_vassals.25.opta"
		add_treasury = -100
		FROM = {
			capital_scope = {
				Public_ChangeClassWealthVal = { class= NO type = value inp=100 }
			}
		}
		create_subject = {
			subject_type = personal_union
			subject = FROM
		}
		log = "MEC-Vassals:[GetYear]:[Root.GetName]:paid 100 ducats to [From.GetAdjective] noblity to get [From.GetName] into PU instead of feudatory status:mec_vassals.25"
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					num_of_loans = 2
					is_bankrupt = yes
				}
			}
		}
	}
	# option = {
	# 	name = "mec_vassals.25.optb"
	# 	add_treasury = -100
	# 	FROM = {
	# 		capital_scope = {
	# 			Public_ChangeClassWealthVal = { class= NO type = value inp=100 }
	# 		}
	# 	}
	# 	create_subject = {
	# 		subject_type = appanage_subject
	# 		subject = FROM
	# 	}
	# 	ai_chance = {
	# 		factor = 1
	# 		modifier = {
	# 			factor = 0
	# 			OR = {
	# 				num_of_loans = 2
	# 				is_bankrupt = yes
	# 			}
	# 		}
	# 	}
	# }
	option = {
		name = "mec_vassals.25.optc"
		create_subject = {
			subject_type = daimyo_vassal
			subject = FROM
		}
		log = "MEC-Vassals:[GetYear]:[Root.GetName]:rejected to pay 100 ducats to [From.GetAdjective] noblity to get [From.GetName] into PU instead of feudatory status:mec_vassals.25"
		ai_chance = {
			factor = 1
		}
	}
}

#Chain of events triggered by the decisions for dependency change
country_event = {
	id = mec_vassals.26
	title = "mec_vassals.26.title"
	desc = "mec_vassals.26.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.ACCEPTPETITION" #Agree
		ai_chance = {
			factor = 50
			modifier = {
				DIP = 4
				factor = 1.5
			}
			modifier = {
				NOT = { DIP = 2 }
				factor = 0.5
			}
			modifier = {
				OR = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR 
				}
				factor = 1.5
			}
			modifier = {
				NOT = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR
				}
				factor = 0.5
			}
		}
		event_target:dep_overlord = {
			if = {
				limit = {
					OR = {
						DIP = 4
						advisor = statesman_BG
						advisor = statesman_BU
						advisor = statesman_CL
						advisor = statesman_NO
						advisor = statesman_TR
					}
				}
				random_list = {
					10 = { country_event = { id = mec_vassals.27 } FROM = { country_event = { id = mec_vassals.28 } } }
					90 = { country_event = { id = mec_vassals.29 } }
				}
			}
			else_if = {
				limit = {
					DIP = 3
				}
				random_list = {
					50 = { country_event = { id = mec_vassals.27 } FROM = { country_event = { id = mec_vassals.28 } } }
					50 = { country_event = { id = mec_vassals.29 } }
				}
			}
			else = {
				random_list = {
					90 = { country_event = { id = mec_vassals.27 } FROM = { country_event = { id = mec_vassals.28 } } }
					10 = { country_event = { id = mec_vassals.29 } }
				}
			}
		}
	}

	option = {
		name = "OPT.REJECTPETITION" #Deny
		ai_chance = {
			factor = 50
			modifier = {
				DIP = 4
				factor = 0.5
			}
			modifier = {
				NOT = { DIP = 2 }
				factor = 1.5
			}
			modifier = {
				OR = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR 
				}
				factor = 0.5
			}
			modifier = {
				NOT = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR
				}
				factor = 1.5
			}
		}
		event_target:dep_petitioner = { country_event = { id = mec_vassals.36 } }
		event_target:dep_overlord = { country_event = { id = mec_vassals.37 } }
	}
}

country_event = {
	id = mec_vassals.27
	title = "mec_vassals.27.title"
	desc = "mec_vassals.27.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.DAMN" #Damn
	}
}

country_event = {
	id = mec_vassals.28
	title = "mec_vassals.28.title"
	desc = "mec_vassals.28.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.GREAT"
		overlord = {
			if = {
				limit = {
					is_non_sovereign_subject_trigger = yes
				}
				free_vassal = ROOT
				dependency_lost_color_effect = yes
				overlord = {
					create_vassal = ROOT
				}
			}
		}
	}
}

country_event = {
	id = mec_vassals.29
	title = "mec_vassals.29.title"
	desc = "mec_vassals.29.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "mec_vassals.29.opta" #Offer autonomy
		trigger = {
			event_target:dep_petitioner = { is_subject_of_type = decentralized_vassal }
		}
		ai_chance = {
			factor = 50
			modifier = {
				DIP = 4
				factor = 1.5
			}
			modifier = {
				NOT = { DIP = 2 }
				factor = 0.5
			}
			modifier = {
				OR = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR 
				}
				factor = 1.5
			}
			modifier = {
				NOT = {
					OR = {
						advisor = statesman_BG 
						advisor = statesman_BU 
						advisor = statesman_CL 
						advisor = statesman_NO 
						advisor = statesman_TR
					}
				}
				factor = 0.5
			}
		}
		add_treasury = -100
		add_prestige = 10
		event_target:dep_petitioner = { country_event = { id = mec_vassals.30 } }
		event_target:dep_suzerain = { country_event = { id = mec_vassals.31 } }
	}
	option = {
		name = "mec_vassals.29.optb" #Offer gold
		ai_chance = {
			factor = 50
			modifier = {
				DIP = 4
				factor = 1.5
			}
			modifier = {
				NOT = { DIP = 2 }
				factor = 0.5
			}
			modifier = {
				OR = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR 
				}
				factor = 1.5
			}
			modifier = {
				NOT = {
					OR = {
						advisor = statesman_BG 
						advisor = statesman_BU 
						advisor = statesman_CL 
						advisor = statesman_NO 
						advisor = statesman_TR
					}
				}
				factor = 0.5
			}
		}
		add_treasury = -150
		add_prestige = 10
		event_target:dep_petitioner = { country_event = { id = mec_vassals.32 } }
		event_target:dep_suzerain = { country_event = { id = mec_vassals.33 } }
	}
	option = {
		name = OPT.ACCEPT3
		ai_chance = {
			factor = 25
			modifier = {
				DIP = 4
				factor = 0.5
			}
			modifier = {
				NOT = { DIP = 2 }
				factor = 1.5
			}
			modifier = {
				OR = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR 
				}
				factor = 0.5
			}
			modifier = {
				NOT = {
					OR = {
						advisor = statesman_BG 
						advisor = statesman_BU 
						advisor = statesman_CL 
						advisor = statesman_NO 
						advisor = statesman_TR
					}
				}
				factor = 1.5
			}
		}
		add_prestige = -5
		event_target:dep_petitioner = { country_event = { id = mec_vassals.34 } }
		event_target:dep_suzerain = { country_event = { id = mec_vassals.35 } }

	}
	after = {
		clear_global_event_target = dep_petitioner
		clear_global_event_target = dep_overlord
		clear_global_event_target = dep_suzerain
	}
}

country_event = {
	id = mec_vassals.30
	title = "mec_vassals.30.title"
	desc = "mec_vassals.30.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		FROM = {
			create_subject = {
				subject_type = daimyo_vassal
				subject = ROOT
			}
		}
	}
}

country_event = {
	id = mec_vassals.31
	title = "mec_vassals.31.title"
	desc = "mec_vassals.31.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		add_treasury = 100
	}
}

country_event = {
	id = mec_vassals.32
	title = "mec_vassals.32.title"
	desc = "mec_vassals.32.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		add_treasury = 50
	}
}

country_event = {
	id = mec_vassals.33
	title = "mec_vassals.33.title"
	desc = "mec_vassals.33.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		add_treasury = 100
	}
}

country_event = {
	id = mec_vassals.34
	title = "mec_vassals.34.title"
	desc = "mec_vassals.34.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
	}
}

country_event = {
	id = mec_vassals.35
	title = "mec_vassals.35.title"
	desc = "mec_vassals.35.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		overlord = {
			if = {
				limit = {
					is_non_sovereign_subject_trigger = yes
				}
				free_vassal = ROOT
				dependency_lost_color_effect = yes
				overlord = {
					create_vassal = ROOT
				}
			}
		}
	}
}

country_event = {
	id = mec_vassals.36
	title = "mec_vassals.36.title"
	desc = "mec_vassals.36.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.DAMN"
	}
}

country_event = {
	id = mec_vassals.37
	title = "mec_vassals.37.title"
	desc = "mec_vassals.37.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		add_prestige = 5
		add_legitimacy = 15
	}
}

country_event = {
	id = mec_vassals.41
	title = "mec_vassals.41.title"
	desc = "mec_vassals.41.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.ACCEPTPETITION"
		ai_chance = {
			factor = 50
			modifier = {
				DIP = 4
				factor = 1.5
			}
			modifier = {
				NOT = { DIP = 2 }
				factor = 0.5
			}
			modifier = {
				OR = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR 
				}
				factor = 1.5
			}
			modifier = {
				NOT = {
					OR = {
						advisor = statesman_BG 
						advisor = statesman_BU 
						advisor = statesman_CL 
						advisor = statesman_NO 
						advisor = statesman_TR
					}
				}
				factor = 0.5
			}
		}
		event_target:hre_overlord = {
			if = {
				limit = {
					OR = {
						DIP = 4
						OR = {
							advisor = statesman_BG
							advisor = statesman_BU
							advisor = statesman_CL
							advisor = statesman_NO
							advisor = statesman_TR
						}
					}
				}
				random_list = {
					10 = { country_event = { id = mec_vassals.42 } FROM = { country_event = { id = mec_vassals.43 } } }
					90 = { country_event = { id = mec_vassals.44 } }
				}
			}
			else_if = {
				limit = {
					DIP = 3
				}
				random_list = {
					50 = { country_event = { id = mec_vassals.42 } FROM = { country_event = { id = mec_vassals.43 } } }
					50 = { country_event = { id = mec_vassals.44 } }
				}
			}
			else = {
				random_list = {
					90 = { country_event = { id = mec_vassals.42 } FROM = { country_event = { id = mec_vassals.43 } } }
					10 = { country_event = { id = mec_vassals.44 } }
				}
			}
		}
	}

	option = {
		name = "OPT.REJECTPETITION"
		ai_chance = {
			factor = 50
			modifier = {
				DIP = 4
				factor = 0.5
			}
			modifier = {
				NOT = { DIP = 2 }
				factor = 1.5
			}
			modifier = {
				OR = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR 
				}
				factor = 0.5
			}
			modifier = {
				NOT = {
					OR = {
						advisor = statesman_BG 
						advisor = statesman_BU 
						advisor = statesman_CL 
						advisor = statesman_NO 
						advisor = statesman_TR
					}
				}
				factor = 1.5
			}
		}
		event_target:hre_petitioner = { country_event = { id = mec_vassals.51 } }
		event_target:hre_overlord = { country_event = { id = mec_vassals.52 } }
	}
}

country_event = {
	id = mec_vassals.42
	title = "mec_vassals.42.title"
	desc = "mec_vassals.42.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.DAMN" #Damn
	}
}

country_event = {
	id = mec_vassals.43
	title = "mec_vassals.43.title"
	desc = "mec_vassals.43.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.GREAT" #Great
		overlord = {
			if = {
				limit = {
					is_non_sovereign_subject_trigger = yes
				}
				free_vassal = ROOT
			}
		}
		dependency_lost_color_effect = yes
	}
}

country_event = {
	id = mec_vassals.44
	title = "mec_vassals.44.title"
	desc = "mec_vassals.44.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "mec_vassals.44.opta" #Offer autonomy
		trigger = {
			event_target:hre_petitioner = { is_subject_of_type = decentralized_vassal }
		}
		ai_chance = {
			factor = 50
			modifier = {
				DIP = 4
				factor = 1.5
			}
			modifier = {
				NOT = { DIP = 2 }
				factor = 0.5
			}
			modifier = {
				OR = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR 
				}
				factor = 1.5
			}
			modifier = {
				NOT = {
					OR = {
						advisor = statesman_BG 
						advisor = statesman_BU 
						advisor = statesman_CL 
						advisor = statesman_NO 
						advisor = statesman_TR
					}
				}
				factor = 0.5
			}
		}
		add_treasury = -50
		add_prestige = 10
		event_target:hre_petitioner = { country_event = { id = mec_vassals.30 } }
		event_target:hre_suzerain = { country_event = { id = mec_vassals.31 } }
	}
	option = {
		name = "mec_vassals.44.opta" #Offer gold
		ai_chance = {
			factor = 50
			modifier = {
				DIP = 4
				factor = 1.5
			}
			modifier = {
				NOT = { DIP = 2 }
				factor = 0.5
			}
			modifier = {
				OR = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR 
				}
				factor = 1.5
			}
			modifier = {
				NOT = {
					OR = {
						advisor = statesman_BG 
						advisor = statesman_BU 
						advisor = statesman_CL 
						advisor = statesman_NO 
						advisor = statesman_TR
					}
				}
				factor = 0.5
			}
		}
		add_treasury = -75
		add_prestige = 10
		event_target:hre_petitioner = { country_event = { id = mec_vassals.32 } }
		event_target:hre_suzerain = { country_event = { id = mec_vassals.33 } }
	}
	option = {
		name = "mec_vassals.44.optb" #Accept it
		ai_chance = {
			factor = 25
			modifier = {
				DIP = 4
				factor = 0.5
			}
			modifier = {
				NOT = { DIP = 2 }
				factor = 1.5
			}
			modifier = {
				OR = {
					advisor = statesman_BG 
					advisor = statesman_BU 
					advisor = statesman_CL 
					advisor = statesman_NO 
					advisor = statesman_TR 
				}
				factor = 0.5
			}
			modifier = {
				NOT = {
					OR = {
						advisor = statesman_BG 
						advisor = statesman_BU 
						advisor = statesman_CL 
						advisor = statesman_NO 
						advisor = statesman_TR
					}
				}
				factor = 1.5
			}
		}
		add_prestige = -5
		event_target:hre_petitioner = { country_event = { id = mec_vassals.34 } }
		event_target:hre_suzerain = { country_event = { id = mec_vassals.35 } }

	}
	after = {
		clear_global_event_target = hre_petitioner
		clear_global_event_target = hre_overlord
		clear_global_event_target = hre_suzerain
	}
}

country_event = {
	id = mec_vassals.45
	title = "mec_vassals.45.title"
	desc = "mec_vassals.45.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		FROM = {
			create_subject = {
				subject_type = daimyo_vassal
				subject = ROOT
			}
		}
	}
}

country_event = {
	id = mec_vassals.46
	title = "mec_vassals.46.title"
	desc = "mec_vassals.46.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		add_treasury = 50
	}
}

country_event = {
	id = mec_vassals.47
	title = "mec_vassals.47.title"
	desc = "mec_vassals.47.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		add_treasury = 25
	}
}

country_event = {
	id = mec_vassals.48
	title = "mec_vassals.48.title"
	desc = "mec_vassals.48.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		add_treasury = 50
	}
}

country_event = {
	id = mec_vassals.49
	title = "mec_vassals.49.title"
	desc = "mec_vassals.49.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
	}
}

country_event = {
	id = mec_vassals.50
	title = "mec_vassals.50.title"
	desc = "mec_vassals.50.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		overlord = {
			if = {
				limit = {
					is_vassal_trigger = yes
				}
				free_vassal = ROOT
			}
		}
		dependency_lost_color_effect = yes
	}
}

country_event = {
	id = mec_vassals.51
	title = "mec_vassals.51.title"
	desc = "mec_vassals.51.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.DAMN"
	}
}

country_event = {
	id = mec_vassals.52
	title = "mec_vassals.52.title"
	desc = "mec_vassals.52.desc"
	picture = OVERLORDVASSAL_eventPicture
	
	is_triggered_only = yes

	option = {
		name = "OPT.VERYWELL"
		add_prestige = 5
		add_legitimacy = 15
	}
}
country_event = {
	id = mec_vassals.53
	title = no_localisation
	desc = no_localisation
	picture = aionly_eventPicture
	
	is_triggered_only = yes
	hidden = yes
	
	immediate = {
		if = {
			limit = {
				has_country_flag = biannual
			}
			every_country = {
				limit = {
					is_subject = yes
					isValidCountry = yes
				}
				country_event = {
					id = mec_vassals.10
				}
			}
		}
	}
	
	option = {
		name = no_localisation
	}
}
