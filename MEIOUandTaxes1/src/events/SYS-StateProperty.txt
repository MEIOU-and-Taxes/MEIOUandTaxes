namespace = SYS_StateProperty

### Concept for Estates Acquiring State Property
# If Capacity is got overshot, the first event will trigger to find a province
# which has large amounts of state property
# Afterwards depending on who is most powerful in that province
# that estate will try to buy the State Property for cash

# 001 Locate province with large amounts of State Property
# 002 Evaluate which estate should buy and check if it can buy, else set flag
# 003 Event for Tag with choice to accept offer



country_event = {
	id = SYS_StateProperty.001
	title = "no_localisation"
	desc = "no_localisation"
	picture = CITY_DEVELOPMENT_eventPicture
	
	is_triggered_only = yes
	
	#trigger = {
	#	has_country_flag = StatePropertyBurden
	#}
	
	immediate = {
		#calculate best province
			random_owned_province = {
				limit = {
					check_key = { lhs = BU_Agriculture value = 5 }
				}
				save_event_target_as = StatePropertyBuyOut
				
				set_key = { lhs = BuyOutValue which = BU_Agriculture }
				multiply_key = { lhs = BuyOutValue value = 3 }
				ROOT = { set_key = { lhs = BuyOutValue which = PREV } }
			}
			
	}
	#Nobility
	option = {
		name = "no_localisation"
		trigger = {
			event_target:StatePropertyBuyOut = {
				check_key = { lhs = NO_Wealth which = BuyOutValue }
			}
		}
#		hidden_effect = {
			event_target:StatePropertyBuyOut = {
				change_key = { lhs = NO_Agriculture which = BU_Agriculture }
				set_key = { lhs = BU_Agriculture value = 0 }
				
				subtract_key = { lhs = NO_Wealth which = BuyOutValue }
			}
			set_var_from_key = { var = ducat_gain key = BuyOutValue }
			old_scaled_ducat_gained_country = yes

#		}
		ai_chance = {
			factor = 100
		}
		
	}
	#Clergy
	option = {
		name = "no_localisation"
		trigger = {
			event_target:StatePropertyBuyOut = {
				check_key = { lhs = NO_Wealth which = BuyOutValue }
			}
		}
#		hidden_effect = {
			event_target:StatePropertyBuyOut = {
				change_key = { lhs = NO_Agriculture which = BU_Agriculture }
				set_key = { lhs = BU_Agriculture value = 0 }
				
				subtract_key = { lhs = NO_Wealth which = BuyOutValue }
			}
			set_var_from_key = { var = ducat_gain key = BuyOutValue }
			old_scaled_ducat_gained_country = yes

#		}
		ai_chance = {
			factor = 100
		}
		
	}
	#Burgher
	option = {
		name = "no_localisation"
		trigger = {
			event_target:StatePropertyBuyOut = {
				check_key = { lhs = NO_Wealth which = BuyOutValue }
			}
		}
#		hidden_effect = {
			event_target:StatePropertyBuyOut = {
				change_key = { lhs = NO_Agriculture which = BU_Agriculture }
				set_key = { lhs = BU_Agriculture value = 0 }
				
				subtract_key = { lhs = NO_Wealth which = BuyOutValue }
			}
			set_var_from_key = { var = ducat_gain key = BuyOutValue }
			old_scaled_ducat_gained_country = yes

#		}
		ai_chance = {
			factor = 100
		}
		
	}
	#Commoners
	option = {
		name = "no_localisation"
		trigger = {
			event_target:StatePropertyBuyOut = {
				check_key = { lhs = NO_Wealth which = BuyOutValue }
			}
		}
#		hidden_effect = {
			event_target:StatePropertyBuyOut = {
				change_key = { lhs = NO_Agriculture which = BU_Agriculture }
				set_key = { lhs = BU_Agriculture value = 0 }
				
				subtract_key = { lhs = NO_Wealth which = BuyOutValue }
			}
			set_var_from_key = { var = ducat_gain key = BuyOutValue }
			old_scaled_ducat_gained_country = yes

#		}
		ai_chance = {
			factor = 100
		}
		
	}
}
