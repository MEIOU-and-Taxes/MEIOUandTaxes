
#Setting up base religious aspects
SetCatholicAspects = {
	set_key = { lhs = aspect_01 value = 1 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 1 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 1 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	if = { limit = { has_country_modifier = wc_aspect_03_2_em } remove_country_modifier = wc_aspect_03_2_em add_country_modifier = { name = wc_aspect_03_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_03_3_em } remove_country_modifier = wc_aspect_03_3_em add_country_modifier = { name = wc_aspect_03_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_04 value = 1 } #Bible in Latin						(3: Vernacular)
	if = { limit = { has_country_modifier = wc_aspect_04_3_em } remove_country_modifier = wc_aspect_04_3_em add_country_modifier = { name = wc_aspect_04_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_05 value = 1 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 1 } #Transubstantiation					(3: Condemned)
	if = {
		limit = { NOT = { has_country_flag = indulgence_condemnation } }
		set_key = { lhs = aspect_07 value = 1 } #Indulgences							(3: Condemned)
		if = { limit = { has_country_modifier = wc_aspect_07_2_em } remove_country_modifier = wc_aspect_07_2_em add_country_modifier = { name = wc_aspect_07_1_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_07_3_em } remove_country_modifier = wc_aspect_07_3_em add_country_modifier = { name = wc_aspect_07_1_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_08 value = 1 } #Saint-accepted prayers			(3: Idolatry)
	if = { limit = { has_country_modifier = wc_aspect_08_3_em } remove_country_modifier = wc_aspect_08_3_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = usury_authorisation } }
		set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_09_1_em } remove_country_modifier = wc_aspect_09_1_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_09_3_em } remove_country_modifier = wc_aspect_09_3_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_10_1_em } } add_country_modifier = { name = wc_aspect_10_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_11 value = 1 } #Clerical Celibacy					(3: Married Priests)
	if = {
		limit = { NOT = { has_country_flag = register_regulation } }
		set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
		if = { limit = { has_country_modifier = wc_aspect_12_3_em } remove_country_modifier = wc_aspect_12_3_em }
	}
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_13_1_em } } add_country_modifier = { name = wc_aspect_13_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = simony_condemnation } }
		set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_14_1_em } remove_country_modifier = wc_aspect_14_1_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_14_3_em } remove_country_modifier = wc_aspect_14_3_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	if = {
		limit = { NOT = { has_country_flag = absenteism_condemnation } }
		set_key = { lhs = aspect_16 value = 1 } #Absenteism							(3: Condemned)
		if = { limit = { has_country_modifier = wc_aspect_16_3_em } remove_country_modifier = wc_aspect_16_3_em add_country_modifier = { name = wc_aspect_16_1_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_17 value = 1 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 1 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 2 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
	set_key = { lhs = aspect_20 value = 2 } #Spirituality						(1: Mysticism, 2: Contemplationism, 3: Rationality)
	set_key = { lhs = aspect_21 value = 3 } #Dyophytism
	set_key = { lhs = aspect_22 value = 3 } #Procession of the Holy Spirit from the Son
	set_key = { lhs = aspect_23 value = 1 } #Theotokos
	set_key = { lhs = aspect_24 value = 1 } #Monastic Orders
}

SetWaldensianAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 3 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	if = { limit = { has_country_modifier = wc_aspect_03_1_em } remove_country_modifier = wc_aspect_03_1_em add_country_modifier = { name = wc_aspect_03_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_03_2_em } remove_country_modifier = wc_aspect_03_2_em add_country_modifier = { name = wc_aspect_03_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	if = { limit = { has_country_modifier = wc_aspect_04_1_em } remove_country_modifier = wc_aspect_04_1_em add_country_modifier = { name = wc_aspect_04_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_05 value = 1 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 2 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	if = {
		limit = { NOT = { has_country_flag = indulgence_condemnation } }
		set_key = { lhs = aspect_07 value = 1 } #Indulgences							(3: Condemned)
		if = { limit = { has_country_modifier = wc_aspect_07_2_em } remove_country_modifier = wc_aspect_07_2_em add_country_modifier = { name = wc_aspect_07_1_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_07_3_em } remove_country_modifier = wc_aspect_07_3_em add_country_modifier = { name = wc_aspect_07_1_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_08 value = 1 } #Saint Veneration
	if = { limit = { has_country_modifier = wc_aspect_08_3_em } remove_country_modifier = wc_aspect_08_3_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_08_2_em } remove_country_modifier = wc_aspect_08_2_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = usury_authorisation } }
		set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_09_1_em } remove_country_modifier = wc_aspect_09_1_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_09_3_em } remove_country_modifier = wc_aspect_09_3_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_10_1_em } } add_country_modifier = { name = wc_aspect_10_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_11 value = 1 } #Clerical Celibacy					(3: Married Priests)
	if = {
		limit = { NOT = { has_country_flag = register_regulation } }
		set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
		if = { limit = { has_country_modifier = wc_aspect_12_3_em } remove_country_modifier = wc_aspect_12_3_em }
	}
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_13_1_em } } add_country_modifier = { name = wc_aspect_13_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = simony_condemnation } }
		set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_14_1_em } remove_country_modifier = wc_aspect_14_1_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_14_3_em } remove_country_modifier = wc_aspect_14_3_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	if = {
		limit = { NOT = { has_country_flag = absenteism_condemnation } }
		set_key = { lhs = aspect_16 value = 1 } #Absenteism							(3: Condemned)
		if = { limit = { has_country_modifier = wc_aspect_16_3_em } remove_country_modifier = wc_aspect_16_3_em add_country_modifier = { name = wc_aspect_16_1_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 2 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
	set_key = { lhs = aspect_20 value = 2 } #Spirituality						(1: Mysticism, 2: Contemplationism, 3: Rationality)
	set_key = { lhs = aspect_21 value = 3 } #Dyophytism
	set_key = { lhs = aspect_22 value = 3 } #Procession of the Holy Spirit from the Son
	set_key = { lhs = aspect_23 value = 1 } #Theotokos
	set_key = { lhs = aspect_24 value = 5 } #Rejection of Monasticism
}

SetLollardCompromiseAspects = {
	set_key = { lhs = aspect_01 value = 1 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 1 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 1 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	if = { limit = { has_country_modifier = wc_aspect_03_2_em } remove_country_modifier = wc_aspect_03_2_em add_country_modifier = { name = wc_aspect_03_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_03_3_em } remove_country_modifier = wc_aspect_03_3_em add_country_modifier = { name = wc_aspect_03_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	if = { limit = { has_country_modifier = wc_aspect_04_1_em } remove_country_modifier = wc_aspect_04_1_em add_country_modifier = { name = wc_aspect_04_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_05 value = 1 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 1 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	if = {
		limit = { NOT = { has_country_flag = indulgence_condemnation } }
		set_key = { lhs = aspect_07 value = 1 } #Indulgences							(3: Condemned)
		if = { limit = { has_country_modifier = wc_aspect_07_2_em } remove_country_modifier = wc_aspect_07_2_em add_country_modifier = { name = wc_aspect_07_1_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_07_3_em } remove_country_modifier = wc_aspect_07_3_em add_country_modifier = { name = wc_aspect_07_1_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_08 value = 1 } #Saint Veneration
	if = { limit = { has_country_modifier = wc_aspect_08_3_em } remove_country_modifier = wc_aspect_08_3_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_08_2_em } remove_country_modifier = wc_aspect_08_2_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = usury_authorisation } }
		set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_09_1_em } remove_country_modifier = wc_aspect_09_1_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_09_3_em } remove_country_modifier = wc_aspect_09_3_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_10_1_em } } add_country_modifier = { name = wc_aspect_10_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_11 value = 1 } #Clerical Celibacy					(3: Married Priests)
	if = {
		limit = { NOT = { has_country_flag = register_regulation } }
		set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
		if = { limit = { has_country_modifier = wc_aspect_12_3_em } remove_country_modifier = wc_aspect_12_3_em }
	}
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_13_1_em } } add_country_modifier = { name = wc_aspect_13_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = simony_condemnation } }
		set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_14_1_em } remove_country_modifier = wc_aspect_14_1_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_14_3_em } remove_country_modifier = wc_aspect_14_3_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	if = {
		limit = { NOT = { has_country_flag = absenteism_condemnation } }
		set_key = { lhs = aspect_16 value = 1 } #Absenteism							(3: Condemned)
		if = { limit = { has_country_modifier = wc_aspect_16_3_em } remove_country_modifier = wc_aspect_16_3_em add_country_modifier = { name = wc_aspect_16_1_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_17 value = 2 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 1 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
	set_key = { lhs = aspect_20 value = 2 } #Spirituality						(1: Mysticism, 2: Contemplationism, 3: Rationality)
	set_key = { lhs = aspect_21 value = 3 } #Dyophytism
	set_key = { lhs = aspect_22 value = 3 } #Procession of the Holy Spirit from the Son
	set_key = { lhs = aspect_23 value = 1 } #Theotokos
	set_key = { lhs = aspect_24 value = 5 } #Rejection of Monasticism
}

SetLollardAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 3 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	if = { limit = { has_country_modifier = wc_aspect_03_1_em } remove_country_modifier = wc_aspect_03_1_em add_country_modifier = { name = wc_aspect_03_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_03_2_em } remove_country_modifier = wc_aspect_03_2_em add_country_modifier = { name = wc_aspect_03_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	if = { limit = { has_country_modifier = wc_aspect_04_1_em } remove_country_modifier = wc_aspect_04_1_em add_country_modifier = { name = wc_aspect_04_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 2 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	if = {
		limit = { NOT = { has_country_flag = indulgence_condemnation } }
		set_key = { lhs = aspect_07 value = 1 } #Indulgences							(3: Condemned)
		if = { limit = { has_country_modifier = wc_aspect_07_2_em } remove_country_modifier = wc_aspect_07_2_em add_country_modifier = { name = wc_aspect_07_1_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_07_3_em } remove_country_modifier = wc_aspect_07_3_em add_country_modifier = { name = wc_aspect_07_1_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_08 value = 1 } #Saint Veneration
	if = { limit = { has_country_modifier = wc_aspect_08_3_em } remove_country_modifier = wc_aspect_08_3_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_08_2_em } remove_country_modifier = wc_aspect_08_2_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = usury_authorisation } }
		set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_09_1_em } remove_country_modifier = wc_aspect_09_1_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_09_3_em } remove_country_modifier = wc_aspect_09_3_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_10_1_em } } add_country_modifier = { name = wc_aspect_10_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_11 value = 3 } #Clerical Celibacy					(3: Married Priests)
	if = {
		limit = { NOT = { has_country_flag = register_regulation } }
		set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
		if = { limit = { has_country_modifier = wc_aspect_12_3_em } remove_country_modifier = wc_aspect_12_3_em }
	}
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_13_1_em } } add_country_modifier = { name = wc_aspect_13_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = simony_condemnation } }
		set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_14_1_em } remove_country_modifier = wc_aspect_14_1_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_14_3_em } remove_country_modifier = wc_aspect_14_3_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	if = {
		limit = { NOT = { has_country_flag = absenteism_condemnation } }
		set_key = { lhs = aspect_16 value = 1 } #Absenteism							(3: Condemned)
		if = { limit = { has_country_modifier = wc_aspect_16_3_em } remove_country_modifier = wc_aspect_16_3_em add_country_modifier = { name = wc_aspect_16_1_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 2 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
	set_key = { lhs = aspect_20 value = 2 } #Spirituality						(1: Mysticism, 2: Contemplationism, 3: Rationality)
	set_key = { lhs = aspect_21 value = 3 } #Dyophytism
	set_key = { lhs = aspect_22 value = 3 } #Procession of the Holy Spirit from the Son
	set_key = { lhs = aspect_23 value = 1 } #Theotokos
	set_key = { lhs = aspect_24 value = 5 } #Rejection of Monasticism
}

SetHussiteCompromiseAspects = {
	set_key = { lhs = aspect_01 value = 1 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 1 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	if = { limit = { has_country_modifier = wc_aspect_03_2_em } remove_country_modifier = wc_aspect_03_2_em add_country_modifier = { name = wc_aspect_03_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_03_3_em } remove_country_modifier = wc_aspect_03_3_em add_country_modifier = { name = wc_aspect_03_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	if = { limit = { has_country_modifier = wc_aspect_04_1_em } remove_country_modifier = wc_aspect_04_1_em add_country_modifier = { name = wc_aspect_04_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_05 value = 2 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 1 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	if = {
		limit = { NOT = { has_country_flag = indulgence_condemnation } }
		set_key = { lhs = aspect_07 value = 2 } #Indulgences							(3: Condemned)
		if = { limit = { has_country_modifier = wc_aspect_07_1_em } remove_country_modifier = wc_aspect_07_1_em add_country_modifier = { name = wc_aspect_07_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_07_3_em } remove_country_modifier = wc_aspect_07_3_em add_country_modifier = { name = wc_aspect_07_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_08 value = 1 } #Saint Veneration
	if = { limit = { has_country_modifier = wc_aspect_08_3_em } remove_country_modifier = wc_aspect_08_3_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_08_2_em } remove_country_modifier = wc_aspect_08_2_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = usury_authorisation } }
		set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_09_1_em } remove_country_modifier = wc_aspect_09_1_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_09_3_em } remove_country_modifier = wc_aspect_09_3_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_10_1_em } } add_country_modifier = { name = wc_aspect_10_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_11 value = 1 } #Clerical Celibacy					(3: Married Priests)
	if = {
		limit = { NOT = { has_country_flag = register_regulation } }
		set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
		if = { limit = { has_country_modifier = wc_aspect_12_3_em } remove_country_modifier = wc_aspect_12_3_em }
	}
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_13_1_em } } add_country_modifier = { name = wc_aspect_13_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = simony_condemnation } }
		set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_14_1_em } remove_country_modifier = wc_aspect_14_1_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_14_3_em } remove_country_modifier = wc_aspect_14_3_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	if = {
		limit = { NOT = { has_country_flag = absenteism_condemnation } }
		set_key = { lhs = aspect_16 value = 1 } #Absenteism							(3: Condemned)
		if = { limit = { has_country_modifier = wc_aspect_16_3_em } remove_country_modifier = wc_aspect_16_3_em add_country_modifier = { name = wc_aspect_16_1_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_17 value = 2 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 1 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
	set_key = { lhs = aspect_20 value = 2 } #Spirituality						(1: Mysticism, 2: Contemplationism, 3: Rationality)
	set_key = { lhs = aspect_21 value = 3 } #Dyophytism
	set_key = { lhs = aspect_22 value = 3 } #Procession of the Holy Spirit from the Son
	set_key = { lhs = aspect_23 value = 1 } #Theotokos
	set_key = { lhs = aspect_24 value = 5 } #Rejection of Monasticism
}

SetHussiteAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 3 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	if = { limit = { has_country_modifier = wc_aspect_03_1_em } remove_country_modifier = wc_aspect_03_1_em add_country_modifier = { name = wc_aspect_03_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_03_2_em } remove_country_modifier = wc_aspect_03_2_em add_country_modifier = { name = wc_aspect_03_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	if = { limit = { has_country_modifier = wc_aspect_04_1_em } remove_country_modifier = wc_aspect_04_1_em add_country_modifier = { name = wc_aspect_04_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 2 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 3 } #Indulgences							(3: Condemned)
	if = { limit = { has_country_modifier = wc_aspect_07_1_em } remove_country_modifier = wc_aspect_07_1_em add_country_modifier = { name = wc_aspect_07_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_07_2_em } remove_country_modifier = wc_aspect_07_2_em add_country_modifier = { name = wc_aspect_07_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_08 value = 1 } #Saint Veneration
	if = { limit = { has_country_modifier = wc_aspect_08_3_em } remove_country_modifier = wc_aspect_08_3_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_08_2_em } remove_country_modifier = wc_aspect_08_2_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = usury_authorisation } }
		set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_09_1_em } remove_country_modifier = wc_aspect_09_1_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_09_3_em } remove_country_modifier = wc_aspect_09_3_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_10_1_em } } add_country_modifier = { name = wc_aspect_10_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_11 value = 3 } #Clerical Celibacy					(3: Married Priests)
	if = {
		limit = { NOT = { has_country_flag = register_regulation } }
		set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
		if = { limit = { has_country_modifier = wc_aspect_12_3_em } remove_country_modifier = wc_aspect_12_3_em }
	}
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_13_1_em } } add_country_modifier = { name = wc_aspect_13_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_14 value = 1 } #Simony Condemned					(3: Authorised)
	if = { limit = { has_country_modifier = wc_aspect_14_2_em } remove_country_modifier = wc_aspect_14_2_em }
	else_if = { limit = { has_country_modifier = wc_aspect_14_3_em } remove_country_modifier = wc_aspect_14_3_em }
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 3 } #Absenteism							(3: Condemned)
	if = { limit = { has_country_modifier = wc_aspect_16_1_em } remove_country_modifier = wc_aspect_16_1_em add_country_modifier = { name = wc_aspect_16_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 2 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
	set_key = { lhs = aspect_20 value = 2 } #Spirituality						(1: Mysticism, 2: Contemplationism, 3: Rationality)
	set_key = { lhs = aspect_21 value = 3 } #Dyophytism
	set_key = { lhs = aspect_22 value = 3 } #Procession of the Holy Spirit from the Son
	set_key = { lhs = aspect_23 value = 1 } #Theotokos
	set_key = { lhs = aspect_24 value = 5 } #Rejection of Monasticism
}

SetProtestantCompromiseAspects = {
	set_key = { lhs = aspect_01 value = 2 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 1 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	if = { limit = { has_country_modifier = wc_aspect_03_2_em } remove_country_modifier = wc_aspect_03_2_em add_country_modifier = { name = wc_aspect_03_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_03_3_em } remove_country_modifier = wc_aspect_03_3_em add_country_modifier = { name = wc_aspect_03_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	if = { limit = { has_country_modifier = wc_aspect_04_1_em } remove_country_modifier = wc_aspect_04_1_em add_country_modifier = { name = wc_aspect_04_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 1 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	if = {
		limit = { NOT = { has_country_flag = indulgence_condemnation } }
		set_key = { lhs = aspect_07 value = 2 } #Indulgences							(3: Condemned)
		if = { limit = { has_country_modifier = wc_aspect_07_1_em } remove_country_modifier = wc_aspect_07_1_em add_country_modifier = { name = wc_aspect_07_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_07_3_em } remove_country_modifier = wc_aspect_07_3_em add_country_modifier = { name = wc_aspect_07_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_08 value = 1 } #Saint Veneration
	if = { limit = { has_country_modifier = wc_aspect_08_3_em } remove_country_modifier = wc_aspect_08_3_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_08_2_em } remove_country_modifier = wc_aspect_08_2_em add_country_modifier = { name = wc_aspect_08_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = usury_authorisation } }
		set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_09_1_em } remove_country_modifier = wc_aspect_09_1_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_09_3_em } remove_country_modifier = wc_aspect_09_3_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_10 value = 1 } #Divorce Forbidden					(3: Legalised)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_10_1_em } } add_country_modifier = { name = wc_aspect_10_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_11 value = 1 } #Clerical Celibacy					(3: Married Priests)
	if = {
		limit = { NOT = { has_country_flag = register_regulation } }
		set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
		if = { limit = { has_country_modifier = wc_aspect_12_3_em } remove_country_modifier = wc_aspect_12_3_em }
	}
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_13_1_em } } add_country_modifier = { name = wc_aspect_13_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = simony_condemnation } }
		set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_14_1_em } remove_country_modifier = wc_aspect_14_1_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_14_3_em } remove_country_modifier = wc_aspect_14_3_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 3 } #Absenteism							(3: Condemned)
	if = { limit = { has_country_modifier = wc_aspect_16_1_em } remove_country_modifier = wc_aspect_16_1_em add_country_modifier = { name = wc_aspect_16_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 2 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
	set_key = { lhs = aspect_20 value = 2 } #Spirituality						(1: Mysticism, 2: Contemplationism, 3: Rationality)
	set_key = { lhs = aspect_21 value = 3 } #Dyophytism
	set_key = { lhs = aspect_22 value = 3 } #Procession of the Holy Spirit from the Son
	set_key = { lhs = aspect_23 value = 1 } #Theotokos
	set_key = { lhs = aspect_24 value = 2 } #Coenobitic Monasticism
}

SetProtestantAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 3 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	if = { limit = { has_country_modifier = wc_aspect_03_1_em } remove_country_modifier = wc_aspect_03_1_em add_country_modifier = { name = wc_aspect_03_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_03_2_em } remove_country_modifier = wc_aspect_03_2_em add_country_modifier = { name = wc_aspect_03_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	if = { limit = { has_country_modifier = wc_aspect_04_1_em } remove_country_modifier = wc_aspect_04_1_em add_country_modifier = { name = wc_aspect_04_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 2 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 3 } #Indulgences							(3: Condemned)
	if = { limit = { has_country_modifier = wc_aspect_07_1_em } remove_country_modifier = wc_aspect_07_1_em add_country_modifier = { name = wc_aspect_07_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_07_2_em } remove_country_modifier = wc_aspect_07_2_em add_country_modifier = { name = wc_aspect_07_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_08 value = 2 } #Saint Commemoration
	if = { limit = { has_country_modifier = wc_aspect_08_1_em } remove_country_modifier = wc_aspect_08_1_em add_country_modifier = { name = wc_aspect_08_2_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_08_3_em } remove_country_modifier = wc_aspect_08_3_em add_country_modifier = { name = wc_aspect_08_2_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_09 value = 3 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	if = { limit = { has_country_modifier = wc_aspect_09_1_em } remove_country_modifier = wc_aspect_09_1_em add_country_modifier = { name = wc_aspect_09_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_09_2_em } remove_country_modifier = wc_aspect_09_2_em add_country_modifier = { name = wc_aspect_09_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_10 value = 3 } #Divorce Forbidden					(3: Legalised)
	if = { limit = { has_country_modifier = wc_aspect_10_1_em } remove_country_modifier = wc_aspect_10_1_em }
	set_key = { lhs = aspect_11 value = 3 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 3 } #Non-Regulated Parish Registers	(3: Regulated)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_12_3_em } } add_country_modifier = { name = wc_aspect_12_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_13_1_em } } add_country_modifier = { name = wc_aspect_13_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_14 value = 1 } #Simony Condemned					(3: Authorised)
	if = { limit = { has_country_modifier = wc_aspect_14_2_em } remove_country_modifier = wc_aspect_14_2_em }
	else_if = { limit = { has_country_modifier = wc_aspect_14_3_em } remove_country_modifier = wc_aspect_14_3_em }
	set_key = { lhs = aspect_15 value = 1 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 3 } #Absenteism							(3: Condemned)
	if = { limit = { has_country_modifier = wc_aspect_16_1_em } remove_country_modifier = wc_aspect_16_1_em add_country_modifier = { name = wc_aspect_16_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 3 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
	set_key = { lhs = aspect_20 value = 3 } #Spirituality						(1: Mysticism, 2: Contemplationism, 3: Rationality)
	set_key = { lhs = aspect_21 value = 3 } #Dyophytism
	set_key = { lhs = aspect_22 value = 3 } #Procession of the Holy Spirit from the Son
	set_key = { lhs = aspect_23 value = 1 } #Theotokos
	set_key = { lhs = aspect_24 value = 2 } #Coenobitic Monasticism
}

SetReformedCompromiseAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 1 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	if = { limit = { has_country_modifier = wc_aspect_03_2_em } remove_country_modifier = wc_aspect_03_2_em add_country_modifier = { name = wc_aspect_03_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_03_3_em } remove_country_modifier = wc_aspect_03_3_em add_country_modifier = { name = wc_aspect_03_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	if = { limit = { has_country_modifier = wc_aspect_04_1_em } remove_country_modifier = wc_aspect_04_1_em add_country_modifier = { name = wc_aspect_04_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 1 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 3 } #Indulgences							(3: Condemned)
	if = { limit = { has_country_modifier = wc_aspect_07_1_em } remove_country_modifier = wc_aspect_07_1_em add_country_modifier = { name = wc_aspect_07_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_07_2_em } remove_country_modifier = wc_aspect_07_2_em add_country_modifier = { name = wc_aspect_07_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_08 value = 2 } #Saint Veneration
	if = { limit = { has_country_modifier = wc_aspect_08_1_em } remove_country_modifier = wc_aspect_08_1_em add_country_modifier = { name = wc_aspect_08_2_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_08_3_em } remove_country_modifier = wc_aspect_08_3_em add_country_modifier = { name = wc_aspect_08_2_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = usury_authorisation } }
		set_key = { lhs = aspect_09 value = 2 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_09_1_em } remove_country_modifier = wc_aspect_09_1_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_09_3_em } remove_country_modifier = wc_aspect_09_3_em add_country_modifier = { name = wc_aspect_09_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_10 value = 3 } #Divorce Forbidden					(3: Legalised)
	if = { limit = { has_country_modifier = wc_aspect_10_1_em } remove_country_modifier = wc_aspect_10_1_em }
	set_key = { lhs = aspect_11 value = 3 } #Clerical Celibacy					(3: Married Priests)
	if = {
		limit = { NOT = { has_country_flag = register_regulation } }
		set_key = { lhs = aspect_12 value = 1 } #Non-Regulated Parish Registers	(3: Regulated)
		if = { limit = { has_country_modifier = wc_aspect_12_3_em } remove_country_modifier = wc_aspect_12_3_em }
	}
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_13_1_em } } add_country_modifier = { name = wc_aspect_13_1_em duration = -1 hidden = yes } }
	if = {
		limit = { NOT = { has_country_flag = simony_condemnation } }
		set_key = { lhs = aspect_14 value = 2 } #Simony Condemned					(3: Authorised)
		if = { limit = { has_country_modifier = wc_aspect_14_1_em } remove_country_modifier = wc_aspect_14_1_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
		else_if = { limit = { has_country_modifier = wc_aspect_14_3_em } remove_country_modifier = wc_aspect_14_3_em add_country_modifier = { name = wc_aspect_14_2_em duration = -1 hidden = yes } }
	}
	set_key = { lhs = aspect_15 value = 2 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 3 } #Absenteism							(3: Condemned)
	if = { limit = { has_country_modifier = wc_aspect_16_1_em } remove_country_modifier = wc_aspect_16_1_em add_country_modifier = { name = wc_aspect_16_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 2 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
	set_key = { lhs = aspect_20 value = 2 } #Spirituality						(1: Mysticism, 2: Contemplationism, 3: Rationality)
	set_key = { lhs = aspect_21 value = 3 } #Dyophytism
	set_key = { lhs = aspect_22 value = 3 } #Procession of the Holy Spirit from the Son
	set_key = { lhs = aspect_23 value = 1 } #Theotokos
	set_key = { lhs = aspect_24 value = 5 } #Rejection of Monasticism
}

SetReformedAspects = {
	set_key = { lhs = aspect_01 value = 3 } #Ordained Priesthood				(3: Universal)
	set_key = { lhs = aspect_02 value = 3 } #Existence of Purgatory			(3: Denial)
	set_key = { lhs = aspect_03 value = 2 } #Baptism and Communion				(2: Adult Baptism, 3: No Baptism)
	if = { limit = { has_country_modifier = wc_aspect_03_1_em } remove_country_modifier = wc_aspect_03_1_em add_country_modifier = { name = wc_aspect_03_2_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_03_3_em } remove_country_modifier = wc_aspect_03_3_em add_country_modifier = { name = wc_aspect_03_2_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_04 value = 3 } #Bible in Latin						(3: Vernacular)
	if = { limit = { has_country_modifier = wc_aspect_04_1_em } remove_country_modifier = wc_aspect_04_1_em add_country_modifier = { name = wc_aspect_04_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_05 value = 3 } #Temporal power to Clergy			(3: Spiritual power only)
	set_key = { lhs = aspect_06 value = 3 } #Transubstantiation					(2: Consubstantiation, 3: Condemned)
	set_key = { lhs = aspect_07 value = 3 } #Indulgences							(3: Condemned)
	if = { limit = { has_country_modifier = wc_aspect_07_1_em } remove_country_modifier = wc_aspect_07_1_em add_country_modifier = { name = wc_aspect_07_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_07_2_em } remove_country_modifier = wc_aspect_07_2_em add_country_modifier = { name = wc_aspect_07_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_08 value = 3 } #Saint-accepted prayers			(3: Idolatry)
	if = { limit = { has_country_modifier = wc_aspect_08_1_em } remove_country_modifier = wc_aspect_08_1_em add_country_modifier = { name = wc_aspect_08_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_08_2_em } remove_country_modifier = wc_aspect_08_2_em add_country_modifier = { name = wc_aspect_08_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_09 value = 3 } #Usury Prohibited					(2: Blind eye, 3: Authorised)
	if = { limit = { has_country_modifier = wc_aspect_09_1_em } remove_country_modifier = wc_aspect_09_1_em add_country_modifier = { name = wc_aspect_09_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_09_2_em } remove_country_modifier = wc_aspect_09_2_em add_country_modifier = { name = wc_aspect_09_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_10 value = 3 } #Divorce Forbidden					(3: Legalised)
	if = { limit = { has_country_modifier = wc_aspect_10_1_em } remove_country_modifier = wc_aspect_10_1_em }
	set_key = { lhs = aspect_11 value = 3 } #Clerical Celibacy					(3: Married Priests)
	set_key = { lhs = aspect_12 value = 3 } #Non-Regulated Parish Registers	(3: Regulated)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_12_3_em } } add_country_modifier = { name = wc_aspect_12_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_13 value = 1 } #Creed through Church				(3: Individual Creed)
	if = { limit = { NOT = { has_country_modifier = wc_aspect_13_1_em } } add_country_modifier = { name = wc_aspect_13_1_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_14 value = 1 } #Simony Condemned					(3: Authorised)
	if = { limit = { has_country_modifier = wc_aspect_14_2_em } remove_country_modifier = wc_aspect_14_2_em }
	else_if = { limit = { has_country_modifier = wc_aspect_14_3_em } remove_country_modifier = wc_aspect_14_3_em }
	set_key = { lhs = aspect_15 value = 3 } #Trinitarian							(3: Denial)
	set_key = { lhs = aspect_16 value = 3 } #Absenteism							(3: Condemned)
	if = { limit = { has_country_modifier = wc_aspect_16_1_em } remove_country_modifier = wc_aspect_16_1_em add_country_modifier = { name = wc_aspect_16_3_em duration = -1 hidden = yes } }
	set_key = { lhs = aspect_17 value = 3 } #Clergy Wealth						(3: Clergy Poverty)
	set_key = { lhs = aspect_18 value = 3 } #Papal Primacy						(2: Primus Inter Pares,3: No Primacy)
	set_key = { lhs = aspect_19 value = 3 } #Holy Communion to the Laity		(1: Restricted, 2: one form, 3: two forms)
	set_key = { lhs = aspect_20 value = 3 } #Spirituality						(1: Mysticism, 2: Contemplationism, 3: Rationality)
	set_key = { lhs = aspect_21 value = 3 } #Dyophytism
	set_key = { lhs = aspect_22 value = 3 } #Procession of the Holy Spirit from the Son
	set_key = { lhs = aspect_23 value = 1 } #Theotokos
	set_key = { lhs = aspect_24 value = 5 } #Rejection of Monasticism
}

#Calculates number of bishops for each area for Councils
NumOfBishops = {
	if = {
		limit = { tag = FRA }
		2359 = { set_key = { lhs = FRAbishops value = 1 } }
	}
	else_if = {
		limit = { tag = ENG }
		2359 = { set_key = { lhs = ENGbishops value = 1 } }
	}
	else_if = {
		limit = { tag = CAS }
		2359 = { set_key = { lhs = CASbishops value = 1 } }
	}
	else_if = {
		limit = { tag = HUN }
		2359 = { set_key = { lhs = HUNbishops value = 1 } }
	}
	else_if = {
		limit = { OR = { tag = DEN tag = DAN tag = NOR tag = SWE tag = KAL } }
		2359 = { set_key = { lhs = SCAbishops value = 1 } }
	}
	else_if = {
		limit = { tag = BOH }
		2359 = { set_key = { lhs = AUSbishops value = 1 } }
	}
	else_if = {
		limit = { tag = POL }
		2359 = { set_key = { lhs = POLbishops value = 1 } }
	}
	else_if = {
		limit = { tag = MLO }
		2359 = { set_key = { lhs = MLObishops value = 1 } }
	}
	else_if = {
		limit = { OR = { tag = TUS tag = NAP } }
		2359 = { set_key = { lhs = TUSbishops value = 1 } }
	}
	else_if = {
		limit = { OR = { tag = NAP tag = KNP tag = SIC } }
		2359 = { set_key = { lhs = KNPbishops value = 1 } }
	}
	if = {
		limit = { is_emperor = yes }
		2359 = { set_key = { lhs = GERbishops value = 1 } }
	}
}

#Bishops vote in Council according to the ruler and per superregion/region
CastingVote = {
	hidden_effect = {
		2359 = {
			export_to_key = {
				lhs = DG_CountCardinals
				value = trigger_value:num_of_cardinals
				who = ROOT
			}	
			change_key = {
				lhs = VoteCount$Ballot$
				which = DG_CountCardinals
			}
			set_key = { lhs = DG_CountCardinals value = 0 }
		}
	}
}

#Calculating the result of the vote in the Council
TallyingVotes = {
	2359 = { 
		# Assessing winning option
		set_key = { lhs = VoteCountT value = 0 }
		change_key = { lhs = VoteCountT which = VoteCount1 }
		change_key = { lhs = VoteCountT which = VoteCount2 }
		change_key = { lhs = VoteCountT which = VoteCount3 }
		change_key = { lhs = VoteCountT which = VoteCount4 }
		set_key = { lhs = DG_Tmp1 which = VoteCount1 }
		set_key = { lhs = VoteCountW value = 1 }
		if = {
			limit = { check_key = { lhs = VoteCount2 which = DG_Tmp1 } }
			set_key = { lhs = DG_Tmp1 which = VoteCount2 }
			set_key = { lhs = VoteCountW value = 2 }
		}
		if = {
			limit = { check_key = { lhs = VoteCount3 which = DG_Tmp1 } }
			set_key = { lhs = DG_Tmp1 which = VoteCount3 }
			set_key = { lhs = VoteCountW value = 3 }
		}
		if = {
			limit = { check_key = { lhs = VoteCount4 which = DG_Tmp1 } }
			set_key = { lhs = DG_Tmp1 which = VoteCount4 }
			set_key = { lhs = VoteCountW value = 4 }
		}
		# if = {
		# 	limit = { check_key = { lhs = VoteCount5 which = DG_Tmp1 } }
		# 	set_key = { lhs = DG_Tmp1 which = VoteCount5 }
		# 	set_key = { lhs = VoteCountW value = 5 }
		# }
		set_key = { lhs = DG_Tmp1 value = 0 }
	}
}

#Calculates number of Cardinals for each area, for the Conclave
NumOfCardinals = {
	if = {
		limit = { tag = FRA }
		if = {
			limit = { religion = catholic }
			every_province = {
				limit = { superregion = france_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				PAP = { change_key = { lhs = FRAbishops value = 1 } }
			}
		}
		else_if = {
			limit = { religion = avignonist }
			every_province = {
				limit = { superregion = france_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				AVI = { change_key = { lhs = FRAbishops value = 1 } }
			}
		}
	}
	else_if = {
		limit = { tag = ENG }
		if = {
			limit = { religion = catholic }
			every_province = {
				limit = { superregion = british_isles_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				PAP = { change_key = { lhs = ENGbishops value = 1 } }
			}
		}
		else_if = {
			limit = { religion = avignonist }
			every_province = {
				limit = { superregion = british_isles_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				AVI = { change_key = { lhs = ENGbishops value = 1 } }
			}
		}
	}
	else_if = {
		limit = { tag = CAS }
		if = {
			limit = { religion = catholic }
			every_province = {
				limit = { superregion = iberia_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				PAP = { change_key = { lhs = CASbishops value = 1 } }
			}
		}
		else_if = {
			limit = { religion = avignonist }
			every_province = {
				limit = { superregion = iberia_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				AVI = { change_key = { lhs = CASbishops value = 1 } }
			}
		}
	}
	else_if = {
		limit = { tag = HUN }
		if = {
			limit = { religion = catholic }
			every_province = {
				limit = { superregion = balkan_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				PAP = { change_key = { lhs = HUNbishops value = 1 } }
			}
		}
		else_if = {
			limit = { religion = avignonist }
			every_province = {
				limit = { superregion = balkan_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				AVI = { change_key = { lhs = HUNbishops value = 1 } }
			}
		}
	}
	else_if = {
		limit = { OR = { tag = DEN tag = DAN tag = NOR tag = SWE tag = KAL } }
		if = {
			limit = { religion = catholic }
			every_province = {
				limit = { superregion = scandinavian_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				PAP = { change_key = { lhs = SCAbishops value = 1 } }
			}
		}
		else_if = {
			limit = { religion = avignonist }
			every_province = {
				limit = { superregion = scandinavian_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				AVI = { change_key = { lhs = SCAbishops value = 1 } }
			}
		}
	}
	else_if = {
		limit = { tag = BOH }
		if = {
			limit = { religion = catholic }
			every_province = {
				limit = { region = bohemia_region OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				PAP = { change_key = { lhs = AUSbishops value = 1 } }
			}
		}
		else_if = {
			limit = { religion = avignonist }
			every_province = {
				limit = { region = bohemia_region OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				AVI = { change_key = { lhs = AUSbishops value = 1 } }
			}
		}
	}
	else_if = {
		limit = { tag = POL }
		if = {
			limit = { religion = catholic }
			every_province = {
				limit = { superregion = commonwealth_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				PAP = { change_key = { lhs = AUSbishops value = 1 } }
			}
		}
		else_if = {
			limit = { religion = avignonist }
			every_province = {
				limit = { superregion = commonwealth_superregion OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				AVI = { change_key = { lhs = AUSbishops value = 1 } }
			}
		}
	}
	else_if = {
		limit = { tag = MLO }
		if = {
			limit = { religion = catholic }
			every_province = {
				limit = { OR = { region = west_italy_region region = east_italy_region } OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				PAP = { change_key = { lhs = MLObishops value = 1 } }
			}
		}
		else_if = {
			limit = { religion = avignonist }
			every_province = {
				limit = { OR = { region = west_italy_region region = east_italy_region } OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				AVI = { change_key = { lhs = MLObishops value = 1 } }
			}
		}
	}
	else_if = {
		limit = { OR = { tag = FIR tag = TUS } }
		if = {
			limit = { religion = catholic }
			every_province = {
				limit = { region = central_italy_region OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				PAP = { change_key = { lhs = TUSbishops value = 1 } }
			}
		}
		else_if = {
			limit = { religion = avignonist }
			every_province = {
				limit = { region = central_italy_region OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				AVI = { change_key = { lhs = TUSbishops value = 1 } }
			}
		}
	}
	else_if = {
		limit = { OR = { tag = NAP tag = KNP tag = SIC } }
		if = {
			limit = { religion = catholic }
			every_province = {
				limit = { OR = { region = naples_region region = sicily_region } OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				PAP = { change_key = { lhs = KNPbishops value = 1 } }
			}
		}
		else_if = {
			limit = { religion = avignonist }
			every_province = {
				limit = { OR = { region = naples_region region = sicily_region } OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				AVI = { change_key = { lhs = KNPbishops value = 1 } }
			}
		}
	}
	if = {
		limit = { is_emperor = yes }
		if = {
			limit = { religion = catholic }
			every_province = {
				limit = { OR = { superregion = germany_superregion AND = { superregion = greater_austrian_circle_superregion OR = { NOT = { exists = BOH } NOT = { region = bohemia_region } } } }   OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				PAP = { change_key = { lhs = GERbishops value = 1 } }
			}
		}
		else_if = {
			limit = { religion = avignonist }
			every_province = {
				limit = { OR = { superregion = germany_superregion AND = { superregion = greater_austrian_circle_superregion OR = { NOT = { exists = BOH } NOT = { region = bohemia_region } } } }   OR = { has_province_flag = MN_Archbishopric has_cardinal = yes } }
				AVI = { change_key = { lhs = GERbishops value = 1 } }
			}
		}
	}
}

#Cardinals voting in the Conclave
CastingBallot = {
	if = {
		limit = { 
			religion = catholic 
		}
		PAP = {
			export_to_key = {
				lhs = DG_CountCardinals
				value = trigger_value:num_of_cardinals
				who = ROOT
			}	
			change_key = {
				lhs = VoteCount$Ballot$
				which = DG_CountCardinals
			}
			set_key = { lhs = DG_CountCardinals value = 0 }

		}
	}
	if = {
		limit = { 
			religion = avignonist 
		}
		AVI = {
			export_to_key = {
				lhs = DG_CountCardinals
				value = trigger_value:num_of_cardinals
				who = ROOT
			}	
			change_key = {
				lhs = VoteCount$Ballot$
				which = DG_CountCardinals
			}
			set_key = { lhs = DG_CountCardinals value = 0 }
		}
	}
}

#Tallying the votes in the Conclave
ConclaveVotes = {
	set_key = { lhs = VoteCountT value = 0 }
	change_key = { lhs = VoteCountT which = VoteCount1 }
	change_key = { lhs = VoteCountT which = VoteCount2 }
	change_key = { lhs = VoteCountT which = VoteCount3 }
	change_key = { lhs = VoteCountT which = VoteCount4 }
	# Number of bishops turned to proportion
	# divide_key   = { lhs = VoteCount1 which = VoteCountT }
	# multiply_key = { lhs = VoteCount1 value = 100 }
	# divide_key   = { lhs = VoteCount2 which = VoteCountT }
	# multiply_key = { lhs = VoteCount2 value = 100 }
	# divide_key   = { lhs = VoteCount3 which = VoteCountT }
	# multiply_key = { lhs = VoteCount3 value = 100 }
	# divide_key   = { lhs = VoteCount4 which = VoteCountT }
	# multiply_key = { lhs = VoteCount4 value = 100 }
	# divide_key   = { lhs = VoteCount5 which = VoteCountT }
	# multiply_key = { lhs = VoteCount5 value = 100 }
	# If 50% haven't voted, vote considered as inconclusive
	# set_key      = { lhs = DG_Tmp1    which = VoteCount1 }
	# change_key   = { lhs = DG_Tmp1    which = VoteCount2 }
	# change_key   = { lhs = DG_Tmp1    which = VoteCount3 }
	# change_key   = { lhs = DG_Tmp1    which = VoteCount4 }
	# change_key   = { lhs = DG_Tmp1    which = VoteCount5 }
	# divide_key   = { lhs = DG_Tmp1    which = VoteCountT }
	# multiply_key = { lhs = DG_Tmp1    value = 100 }
	# if = {
	# 	limit = {
	# 		has_global_flag = DG_Ongoing_Schism_Council 
	# 		NOT = { check_key = { lhs = DG_Tmp1 value = 50 } } 
	# 	}
	# 	set_country_flag = DG_Inconclusive_Vote
	# }
	# Assessing winning option
		set_key = { lhs = DG_Tmp1 which = VoteCount1 }
		set_key = { lhs = VoteCountW value = 1 }
		if = {
			limit = { is_key_equal = { lhs = VoteCount2 which = DG_Tmp1 } }
			set_country_flag = Inconclusive_Vote
		}
		else_if = {
			limit = { check_key = { lhs = VoteCount2 which = DG_Tmp1 } }
			set_key = { lhs = DG_Tmp1 which = VoteCount2 }
			set_key = { lhs = VoteCountW value = 2 }
			clr_country_flag = Inconclusive_Vote
		}
		if = {
			limit = { is_key_equal = { lhs = VoteCount3 which = DG_Tmp1 } }
			set_country_flag = Inconclusive_Vote
		}
		else_if = {
			limit = { check_key = { lhs = VoteCount3 which = DG_Tmp1 } }
			set_key = { lhs = DG_Tmp1 which = VoteCount3 }
			set_key = { lhs = VoteCountW value = 3 }
			clr_country_flag = Inconclusive_Vote
		}
		if = {
			limit = { is_key_equal = { lhs = VoteCount4 which = DG_Tmp1 } }
			set_country_flag = Inconclusive_Vote
		}
		else_if = {
			limit = { check_key = { lhs = VoteCount4 which = DG_Tmp1 } }
			set_key = { lhs = DG_Tmp1 which = VoteCount4 }
			set_key = { lhs = VoteCountW value = 4 }
			clr_country_flag = Inconclusive_Vote
		}
		# if = {
		# 	limit = { is_key_equal = { lhs = VoteCount5 which = DG_Tmp1 } }
		# 	set_province_flag = Inconclusive_Vote
		# }
		# else_if = {
		# 	limit = { check_key = { lhs = VoteCount5 which = DG_Tmp1 } }
		# 	set_key = { lhs = DG_Tmp1 which = VoteCount5 }
		# 	set_key = { lhs = VoteCountW value = 5 }
		# 	clr_province_flag = Inconclusive_Vote
		# }
		if = {
			limit = {
				has_country_flag = Inconclusive_Vote
				has_global_flag = DG_Ongoing_Schism_Council
			}
			set_global_flag = DG_Inconclusive_Vote
			set_key = { lhs = VoteCountW value = 0 }
			clr_country_flag = Inconclusive_Vote
		}
		set_key = { lhs = DG_Tmp1    value = 0 }
}

Cast_Vote_HRE = {
	event_target:DG_Augsburg_Diet = {
		change_key = {
			lhs = VoteCount$Ballot$
			value = 1
		}
	}
}

Tally_Vote_HRE = {
	set_key = { lhs = VoteCountT value = 0 }
	change_key = { lhs = VoteCountT which = VoteCount1 }
	change_key = { lhs = VoteCountT which = VoteCount2 }
	change_key = { lhs = VoteCountT which = VoteCount3 }
	change_key = { lhs = VoteCountT which = VoteCount4 }
	change_key = { lhs = VoteCountT which = VoteCount5 }
	set_key = { lhs = VoteCountM which = VoteCountT }
	if = {		#A majority of 50% is needed in the 3rd League War
		limit = {
			has_global_flag = DG_Third_League_War
		}
		multiply_key = { lhs = VoteCountM value = 0.5 }
	}
	else_if = {	#A majority of 66% is needed in the 2nd League War
		limit = {
			has_global_flag = DG_Second_League_War
		}
		multiply_key = { lhs = VoteCountM value = 0.66 }
	}
	else_if = {  #A majority of 75% is needed in the 1st League War 
		limit = {
			has_global_flag = DG_First_League_War
		}
		multiply_key = { lhs = VoteCountM value = 0.75 }
	}

			
	set_key = { lhs = DG_Tmp1 which = VoteCount1 }
	set_key = { lhs = VoteCountW value = 1 }
	if = {
		limit = { check_key = { lhs = VoteCount1 which = VoteCountM } }
		set_province_flag = Decisive_Vote
	}
	if = {
		limit = { is_key_equal = { lhs = VoteCount2 which = DG_Tmp1 } }
		set_province_flag = Inconclusive_Vote
	}
	else_if = {
		limit = { check_key = { lhs = VoteCount2 which = DG_Tmp1 } }
		set_key = { lhs = DG_Tmp1 which = VoteCount2 }
		set_key = { lhs = VoteCountW value = 2 }
		clr_province_flag = Inconclusive_Vote
		if = {
			limit = { check_key = { lhs = VoteCount2 which = VoteCountM } }
			set_province_flag = Decisive_Vote
		}
	}
	if = {
		limit = { is_key_equal = { lhs = VoteCount3 which = DG_Tmp1 } }
		set_province_flag = Inconclusive_Vote
	}
	else_if = {
		limit = { check_key = { lhs = VoteCount3 which = DG_Tmp1 } }
		set_key = { lhs = DG_Tmp1 which = VoteCount3 }
		set_key = { lhs = VoteCountW value = 3 }
		clr_province_flag = Inconclusive_Vote
		if = {
			limit = { check_key = { lhs = VoteCount3 which = VoteCountM } }
			set_province_flag = Decisive_Vote
		}
	}
	if = {
		limit = { is_key_equal = { lhs = VoteCount4 which = DG_Tmp1 } }
		set_province_flag = Inconclusive_Vote
	}
	else_if = {
		limit = { check_key = { lhs = VoteCount4 which = DG_Tmp1 } }
		set_key = { lhs = DG_Tmp1 which = VoteCount4 }
		set_key = { lhs = VoteCountW value = 4 }
		clr_province_flag = Inconclusive_Vote
		if = {
			limit = { check_key = { lhs = VoteCount4 which = VoteCountM } }
			set_province_flag = Decisive_Vote
		}
	}
	if = {
		limit = { is_key_equal = { lhs = VoteCount5 which = DG_Tmp1 } }
		set_province_flag = Inconclusive_Vote
	}
	else_if = {
		limit = { check_key = { lhs = VoteCount5 which = DG_Tmp1 } }
		set_key = { lhs = DG_Tmp1 which = VoteCount5 }
		set_key = { lhs = VoteCountW value = 5 }
		clr_province_flag = Inconclusive_Vote
		if = {
			limit = { check_key = { lhs = VoteCount5 which = VoteCountM } }
			set_province_flag = Decisive_Vote
		}
	}
}

indulgence_condemnation_se = {
	set_country_flag = indulgence_condemnation
	set_key = { lhs = aspect_07 value = 3 }
	if = { limit = { has_country_modifier = wc_aspect_07_1_em } remove_country_modifier = wc_aspect_07_1_em add_country_modifier = { name = wc_aspect_07_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_07_2_em } remove_country_modifier = wc_aspect_07_2_em add_country_modifier = { name = wc_aspect_07_3_em duration = -1 hidden = yes } }
}

usury_authorisation_se = {
	set_country_flag = usury_authorisation
	set_key = { lhs = aspect_09 value = 3 }
	if = { limit = { has_country_modifier = wc_aspect_09_1_em } remove_country_modifier = wc_aspect_09_1_em add_country_modifier = { name = wc_aspect_09_3_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_09_2_em } remove_country_modifier = wc_aspect_09_2_em add_country_modifier = { name = wc_aspect_09_3_em duration = -1 hidden = yes } }
}

register_regulation_se = {
	set_country_flag = register_regulation
	set_key = { lhs = aspect_12 value = 3 }
	if = { limit = { NOT = { has_country_modifier = wc_aspect_12_3_em } } add_country_modifier = { name = wc_aspect_12_3_em duration = -1 hidden = yes } }
}

simony_condemnation_se = {
	set_country_flag = simony_condemnation
	set_key = { lhs = aspect_14 value = 1 }
	if = { limit = { has_country_modifier = wc_aspect_14_2_em } remove_country_modifier = wc_aspect_14_2_em add_country_modifier = { name = wc_aspect_14_1_em duration = -1 hidden = yes } }
	else_if = { limit = { has_country_modifier = wc_aspect_14_3_em } remove_country_modifier = wc_aspect_14_3_em add_country_modifier = { name = wc_aspect_14_1_em duration = -1 hidden = yes } }
}

absenteism_condemnation_se = {
	set_country_flag = absenteism_condemnation
	set_key = { lhs = aspect_16 value = 3 }
	if = { limit = { has_country_modifier = wc_aspect_16_1_em } remove_country_modifier = wc_aspect_16_1_em add_country_modifier = { name = wc_aspect_16_3_em duration = -1 hidden = yes } }
}

absenteism_authorisation_se = {
	set_country_flag = absenteism_authorisation
	set_key = { lhs = aspect_16 value = 1 }
	if = { limit = { has_country_modifier = wc_aspect_16_3_em } remove_country_modifier = wc_aspect_16_3_em add_country_modifier = { name = wc_aspect_16_1_em duration = -1 hidden = yes } }
}

#Changing religious aspects
ReformingAspect = {
	change_key = { lhs = aspect_$typea$ value = $valuea$ }
	if = {
		limit = {
			NOT = { check_key = { lhs = aspect_$typea$ value = 1 } }
		}
		set_key = { lhs = aspect_$typea$ value = 1 }
	}
	else_if = {
		limit = {
			check_key = { lhs = aspect_$typea$ value = 4 }
		}
		set_key = { lhs = aspect_$typea$ value = 3 }
	}
}

#Effect to remove a cardinal
RemoveCardinal = {
	remove_cardinal = yes
	hidden_effect = {
		AAA = { change_key = { lhs = MN_Curia_Cur value = -1 } }
		#Triggers potential replacing of cardinal in same country
		#if = {
		#	limit = { owner = { has_country_flag = papacy_notification } }
		#	province_event = { id = DG_Papacy.004 }
		#}
	}
}

#Effect to add a cardinal with his lifespan
AddCardinal = {
	if = {
		limit = { 
			OR = {
				AND = {
					religion = catholic
					owner = { religion = catholic }
				}
				AND = {
					religion = avignonist
					owner = { religion = avignonist }
				}
			}
			has_cardinal = no 
			NOT = {
				AAA = {
					check_key = { lhs = MN_Curia_Cur value = 50 }		#Maximum of 49 Cardinals 
				}
			}
		}
		add_cardinal = yes
		hidden_effect = {
			owner = { add_papal_influence = 5 }
			AAA = { change_key = { lhs = MN_Curia_Cur value = 1 } }
		}
	}
}

#Province score for getting a Cardinal
CardinalChanceP = {
	#Base cardinal value is based on urban population
	#Effect of religious infrastructure
	if = {
		limit = { is_key_equal = { lhs = MN_S0 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S0TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S0INF }
	}
	else_if = {
		limit = { is_key_equal = { lhs = MN_S1 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S1TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S1INF }
	}
	else_if = {
		limit = { is_key_equal = { lhs = MN_S2 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S2TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S2INF }
	}
	else_if = {
		limit = { is_key_equal = { lhs = MN_S3 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S3TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S3INF }
	}
	else_if = {
		limit = { is_key_equal = { lhs = MN_S4 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S4TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S4INF }
	}
	else_if = {
		limit = { is_key_equal = { lhs = MN_S4 value = 1 } }
		set_key = { lhs = MN_Cardinal which = MN_S5TotN }
		multiply_key = { lhs = MN_Cardinal which = MN_S5INF }
	}
	else = {
		set_key = { lhs = MN_Cardinal value = 0 }
	}
	#Bonus if province has an archbisopric
	if = {
		limit = {
			OR = {
				has_province_flag = MN_Archbishopric
				has_province_flag = MN_Patriarchate
			}
		}
		change_key = { lhs = MN_Cardinal value = 1.5 }
	}
	#Effect of local clergy power
	if = {
		limit = {
			check_key = { lhs = Prov_CLPow value = 75 }
		}
		multiply_key = { lhs = MN_Cardinal value = 1.2 }
	}
	else_if = {
		limit = {
			check_key = { lhs = Prov_CLPow value = 50 }
		}
		multiply_key = { lhs = MN_Cardinal value = 1.1 }
	}
	else_if = {
		limit = {
			check_key = { lhs = Prov_CLPow value = 25 }
		}
		multiply_key = { lhs = MN_Cardinal value = 1.0 }
	}
	else = {
		multiply_key = { lhs = MN_Cardinal value = 0.8 }
	}
	#Miscellaneous factors
	if = {
		limit = { NOT = { continent = europe } }
		multiply_key = { lhs = MN_Cardinal value = 0.1 }
	}
	if = {
		limit = { has_owner_culture = yes }
		multiply_key = { lhs = MN_Cardinal value = 1.2 }
	}
	if = {
		limit = { culture_group = owner }
		multiply_key = { lhs = MN_Cardinal value = 1.2 }
	}
	if = {
		limit = { is_capital = yes }
		multiply_key = { lhs = MN_Cardinal value = 1.5 }
	}
}

#Cardinal score for countries
CardinalChanceC = { 
	if = {
		#Only Catholic non-excommunicated nations can get cardinals
		limit = {
			OR = {
				religion = catholic
				religion = avignonist
			}
			is_excommunicated = no
			NOT = { tag = PAP }
			NOT = { tag = AVI }
		}
		#Bonus for provinces in same superregion 
		if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = france_superregion }
				PAP = { capital_scope = { superregion = france_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = italy_superregion }
				PAP = { capital_scope = { superregion = italy_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = iberia_superregion }
				PAP = { capital_scope = { superregion = iberia_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = germany_superregion }
				PAP = { capital_scope = { superregion = germany_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = british_isles_superregion }
				PAP = { capital_scope = { superregion = british_isles_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = scandinavian_superregion }
				PAP = { capital_scope = { superregion = scandinavian_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = greater_austrian_circle_superregion }
				PAP = { capital_scope = { superregion = greater_austrian_circle_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = balkan_superregion }
				PAP = { capital_scope = { superregion = balkan_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = commonwealth_superregion }
				PAP = { capital_scope = { superregion = commonwealth_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else_if = {
			limit = {
				num_of_cities = 20
				capital_scope = { superregion = greater_russia_superregion }
				PAP = { capital_scope = { superregion = greater_russia_superregion } }
			}
			set_key = { lhs = MN_Cardinal value = 3 }
		}
		else = {
			set_key = { lhs = MN_Cardinal value = 1 }
		}
		multiply_key = { lhs = MN_Cardinal value = 30 }
		#The more clergy estate power, the higher the chance of a cardinal
		if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 50 } } # Clergy loyalty
			multiply_key = { lhs = MN_Cardinal value = 1.5 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 25 } }
			multiply_key = { lhs = MN_Cardinal value = 1.2 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 10 } }
			multiply_key = { lhs = MN_Cardinal value = 1.0 }
		}
		else = {
			multiply_key = { lhs = MN_Cardinal value = 0.8 }
		}
		#The more clergy estate influence, the higher the chance of a cardinal
		if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 50 } } # Clergy loyalty
			multiply_key = { lhs = MN_Cardinal value = 1.5 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 25 } }
			multiply_key = { lhs = MN_Cardinal value = 1.2 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 10 } }
			multiply_key = { lhs = MN_Cardinal value = 1.0 }
		}
		else = {
			multiply_key = { lhs = MN_Cardinal value = 0.8 }
		}
		#Piety impacts chance of getting a cardinal
		if = {
			limit = { piety = 0.60 }
			multiply_key = { lhs = MN_Cardinal value = 1.2 }
		}
		else_if = {
			limit = { piety = 0.20 }
			multiply_key = { lhs = MN_Cardinal value = 1.1 }
		}
		else_if = {
			limit = { piety = -0.20 }
			multiply_key = { lhs = MN_Cardinal value = 1.0 }
		}
		else_if = {
			limit = { piety = -0.60 }
			multiply_key = { lhs = MN_Cardinal value = 0.9 }
		}
		else = {
			multiply_key = { lhs = MN_Cardinal value = 0.8 }
		}
		#How the Pope like you impacts chance of getting a cardinal
		if = {
			limit = { PAP = { has_opinion = { who = ROOT value = 150 } } }
			multiply_key = { lhs = MN_Cardinal value = 1.4 }
		}
		else_if = {
			limit = { PAP = { has_opinion = { who = ROOT value = 50 } } }
			multiply_key = { lhs = MN_Cardinal value = 1.2 }
		}
		else_if = {
			limit = { PAP = { has_opinion = { who = ROOT value = -50 } } }
			multiply_key = { lhs = MN_Cardinal value = 1.0 }
		}
		else_if = {
			limit = { PAP = { has_opinion = { who = ROOT value = -150 } } }
			multiply_key = { lhs = MN_Cardinal value = 0.8 }
		}
		else = {
			multiply_key = { lhs = MN_Cardinal value = 0.6 }
		}
	}
}

#Papal Corruption Check
papal_corruption_se = {
	#Based on actual country corrupption
	export_to_key = {
		lhs = MN_Pap_Corruption
		value = corruption
	}
	#Down from 0 to 10
	multiply_key = { lhs = MN_Pap_Corruption value = 0.10 }
	#Some randomisation
	random_list = {
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 0.75 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 0.80 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 0.85 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 0.90 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 0.95 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.00 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.05 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.10 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.15 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.20 } }
		10 = { multiply_key = { lhs = MN_Pap_Corruption value = 1.25 } }
	}
	#Indulgences accepted
	if = {
		limit = { is_key_equal = { lhs = aspect_07 value = 1 } }
		change_key = { lhs = MN_Pap_Corruption value = 1 }
	}
	#Indulgences condemned
	else_if = {
		limit = { is_key_equal = { lhs = aspect_07 value = 3 } }
		change_key = { lhs = MN_Pap_Corruption value = -1 }
	}
	#Simony accepted
	if = {
		limit = { is_key_equal = { lhs = aspect_14 value = 3 } }
		change_key = { lhs = MN_Pap_Corruption value = 1 }
	}
	#Simony condemned
	else_if = {
		limit = { is_key_equal = { lhs = aspect_14 value = 1 } }
		change_key = { lhs = MN_Pap_Corruption value = -1 }
	}
	#Wealthy Clergy
	if = {
		limit = { is_key_equal = { lhs = aspect_17 value = 4 } }
		change_key = { lhs = MN_Pap_Corruption value = 1 }
	}
	#Clergy Poverty
	else_if = {
		limit = { is_key_equal = { lhs = aspect_17 value = 3 } }
		change_key = { lhs = MN_Pap_Corruption value = -1 }
	}
	#Graft during election
	if = {
		limit = { OR = { has_country_flag = accepted_graft babylonian_captivity = yes } }
		change_key = { lhs = MN_Pap_Corruption value = 2 }
	}
	else_if = {
		limit = { has_country_flag = refused_graft }
		change_key = { lhs = MN_Pap_Corruption value = -2 }
	}
	#Size of the Curia
	if = {
		limit = { has_country_flag = Restricted_Curia }
		change_key = { lhs = MN_Pap_Corruption value = 1 }
	}
	else_if = {
		limit = { has_country_flag = Enlarged_Curia }
		change_key = { lhs = MN_Pap_Corruption value = 0 }
	}
	else_if = {
		limit = { has_country_flag = Extended_Curia }
		change_key = { lhs = MN_Pap_Corruption value = -1 }
	}
	else_if = {
		limit = { has_country_flag = Unrestricted_Curia }
		change_key = { lhs = MN_Pap_Corruption value = -2 }
	}
}

#Deadlocked Conclave
conclave_deadlock = {
	random_list = {
		20 = { country_event = { id = DG_Papacy.113 days =  120 } }
		20 = { country_event = { id = DG_Papacy.113 days =  180 } }
		20 = { country_event = { id = DG_Papacy.113 days =  240 } }
		19 = { country_event = { id = DG_Papacy.113 days =  300 } }
		15 = { country_event = { id = DG_Papacy.113 days =  360 } }
		 5 = { country_event = { id = DG_Papacy.113 days =  730 } }
		 1 = { country_event = { id = DG_Papacy.113 days = 1825 } }
	}
}

#Calculate Papal Authority
Calc_Pap_Auth = {
	$scope$ = {
		set_key = { lhs = DG_Tmp1 value = 0 }
		set_key = { lhs = DG_Tmp2 value = 0 }
		set_key = { lhs = DG_Tmp3 value = 0 }
		set_key = { lhs = DG_Tmp4 value = 0 }
		set_key = { lhs = DG_Tmp5 value = 0 }
		set_key = { lhs = MN_Pap_Auth value = 0 }
	}
	save_event_target_as = CardinalProv
	every_known_country = {
		limit = { western_christian = yes }
		$scope$ = { change_key = { lhs = DG_Tmp1 value = 1 } }
		if = {
			limit = { religion = event_target:CardinalProv }
			$scope$ = { change_key = { lhs = DG_Tmp2 value = 1 } }
		}
		every_owned_province = {
			limit = { western_christian = yes }
			$scope$ = { change_key = { lhs = DG_Tmp3 value = 0.1 } }
			if = {
				limit = { owned_by = $scope$ }
				$scope$ = { change_key = { lhs = DG_Tmp4 value = 0.1 } }
			}
			if = {
				limit = { religion = event_target:CardinalProv }
				$scope$ = { change_key = { lhs = DG_Tmp5 value = 0.1 } }
				trigger_switch = {
					on_trigger = has_province_flag
					MN_Archbishopric  = {
						$scope$ = { change_key = { lhs = DG_Tmp5 value = 0.05 } }
					}
					MN_Patriarchate = {
						$scope$ = { change_key = { lhs = DG_Tmp5 value = 0.01 } }
					}
				}
			}
		}
	}
	$scope$ = {
		if = {
			limit = { NOT = { is_key_equal = { lhs = DG_Tmp1 value = 0 } } }
			divide_key = { lhs = DG_Tmp2 which = DG_Tmp1 }
			multiply_key = { lhs = DG_Tmp2 value = 200 }
			set_key = { lhs = MN_Pap_Auth which = DG_Tmp2 }
		}
		if = {
			limit = { NOT = { is_key_equal = { lhs = DG_Tmp3 value = 0 } } }
			divide_key = { lhs = DG_Tmp5 which = DG_Tmp3 }
		}
		multiply_key = { lhs = DG_Tmp5 value = 200 }
		change_key = { lhs = MN_Pap_Auth which = DG_Tmp5 }
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_04 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_05 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_13 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = {
				NOT=  { is_key_equal = { lhs = aspect_18 value = 1 } }
			}
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = waldensian }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = lollard }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = hussite }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = protestant }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		if = {
			limit = { is_religion_enabled = reformed }
			change_key = { lhs = MN_Pap_Auth value = -25 }
		}
		# if = {
		# 	limit = { is_religion_enabled = fraticelli }
		# 	change_key = { lhs = MN_Pap_Auth value = -25 }
		# }
		if = {
			limit = { babylonian_captivity = yes }
			multiply_key = { lhs = MN_Pap_Auth value = 0.50 }
		}
		else_if = {
			limit = { NOT = { has_global_flag = DG_Live_Pope_in_Rome } }
			multiply_key = { lhs = MN_Pap_Auth value = 0.50 }
		}
		else_if = {
			limit = { has_global_flag = DG_Live_Pope_in_Rome is_papal_controller = yes }
			change_key = { lhs = MN_Pap_Auth value = 100 }
		}
		if = {
			limit = { has_country_flag = Pious_Pope }
			multiply_key = { lhs = MN_Pap_Auth value = 1.10 }
		}
		else_if = {
			limit = { has_country_flag = Corrupt_Pope }
			multiply_key = { lhs = MN_Pap_Auth value = 0.90 }
		}
		if = {
			limit = { NOT = { check_key = { lhs = MN_Pap_Auth value = 1 } } }
			set_key = { lhs = MN_Pap_Auth value = 1 }
		}
		set_key = { lhs = DG_Tmp1 value = 0 }
		set_key = { lhs = DG_Tmp2 value = 0 }
		set_key = { lhs = DG_Tmp3 value = 0 }
		set_key = { lhs = DG_Tmp4 value = 0 }
		set_key = { lhs = DG_Tmp5 value = 0 }
	}
}

#Calculates how likely a nation is to have a Pope of his culture
DG_Papabile = {
	if = {
		#Only Catholic non-excommunicated nations can get cardinals
		limit = {
			OR = {
				religion = catholic
				religion = avignonist
			}
			num_of_cities = 5
			is_excommunicated = no
			NOT = { tag = PAP }
			NOT = { tag = AVI }
		}
		if = {
			limit = { num_of_cardinals = 1 }
			export_to_key = {
				lhs = DG_Papability
				value = trigger_value:num_of_cardinals
			}
			#Piety impacts chance of getting a cardinal
			if = {
				limit = { piety = 0.60 }
				change_key = { lhs = DG_Papability value = 2 }
			}
			else_if = {
				limit = { piety = 0.20 }
				change_key = { lhs = DG_Papability value = 1 }
			}
			else_if = {
				limit = { piety = -0.20 }
				change_key = { lhs = DG_Papability value = 0 }
			}
			else_if = {
				limit = { piety = -0.60 }
				change_key = { lhs = DG_Papability value = -1 }
			}
			else = {
				change_key = { lhs = DG_Papability value = -2 }
			}
			#How the Pope like you impacts chance of getting a cardinal
			if = {
				limit = { PAP = { has_opinion = { who = ROOT value = 150 } } }
				change_key = { lhs = DG_Papability value = 2 }
			}
			else_if = {
				limit = { PAP = { has_opinion = { who = ROOT value = 50 } } }
				change_key = { lhs = DG_Papability value = 1 }
			}
			else_if = {
				limit = { PAP = { has_opinion = { who = ROOT value = -50 } } }
				change_key = { lhs = DG_Papability value = 0 }
			}
			else_if = {
				limit = { PAP = { has_opinion = { who = ROOT value = -150 } } }
				change_key = { lhs = DG_Papability value = -1 }
			}
			else = {
				change_key = { lhs = DG_Papability value = -2 }
			}
			export_to_key = {
				lhs = DG_Tmp1
				value = prestige
			}
			divide_key = { lhs = DG_Tmp1 value = 10 }
			change_key = { lhs = DG_Papability which = DG_Tmp1 }
		}
		if = {
			limit = { has_country_flag = pap }
			multiply_key = { lhs = DG_Papability value = 1.5 }
		}
		if = {
			limit = { capital_scope = { superregion = france_superregion } }
			change_key = { lhs = DG_Papability value = 2.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = france_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = italy_superregion } }
			change_key = { lhs = DG_Papability value = 3.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = italy_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = iberia_superregion } }
			change_key = { lhs = DG_Papability value = 1.5 }
			if = {
				limit = { PAP = { capital_scope = { superregion = iberia_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = germany_superregion } }
			change_key = { lhs = DG_Papability value = 1.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = germany_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = british_isles_superregion } }
			change_key = { lhs = DG_Papability value = -0.5 }
			if = {
				limit = { PAP = { capital_scope = { superregion = british_isles_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = scandinavian_superregion } }
			change_key = { lhs = DG_Papability value = -1.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = scandinavian_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = greater_austrian_circle_superregion } }
			change_key = { lhs = DG_Papability value = 1.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = greater_austrian_circle_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = balkan_superregion } }
			change_key = { lhs = DG_Papability value = -1.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = balkan_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = commonwealth_superregion } }
			change_key = { lhs = DG_Papability value = -1.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = commonwealth_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		else_if = {
			limit = { capital_scope = { superregion = greater_russia_superregion } }
			change_key = { lhs = DG_Papability value = -2.0 }
			if = {
				limit = { PAP = { capital_scope = { superregion = greater_russia_superregion } } }
				multiply_key = { lhs = DG_Papability value = 1.5 }
			}
		}
		#The more clergy estate power, the higher the chance of a cardinal
		if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 50 } } # Clergy loyalty
			multiply_key = { lhs = DG_Papability value = 1.5 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 25 } }
			multiply_key = { lhs = DG_Papability value = 1.2 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 10 } }
			multiply_key = { lhs = DG_Papability value = 1.0 }
		}
		else = {
			multiply_key = { lhs = DG_Papability value = 0.8 }
		}
		#The more clergy estate influence, the higher the chance of a cardinal
		if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 50 } } # Clergy loyalty
			multiply_key = { lhs = DG_Papability value = 1.5 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 25 } }
			multiply_key = { lhs = DG_Papability value = 1.2 }
		}
		else_if = {
			limit = { check_key = { lhs = Prov_CLLoy value = 10 } }
			multiply_key = { lhs = DG_Papability value = 1.0 }
		}
		else = {
			multiply_key = { lhs = DG_Papability value = 0.8 }
		}
	}
}

add_curia_treasury_small_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = 25
	}
}

add_curia_treasury_medium_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = 50
	}
}

add_curia_treasury_big_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = 100
	}
}

add_curia_treasury_huge_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = 1000
	}
}

reduce_curia_treasury_medium_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = -50
	}
}

reduce_curia_treasury_big_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = -100
	}
}

reduce_curia_treasury_huge_effect = {
	if = {
		limit = {
			has_dlc = "Emperor"
		}
		add_curia_treasury = -1000
	}
}

support_rebels_effect = {
	if = {
		limit = { hre_heretic_religion = ROOT }
		if = {
			limit = { piety = 0.60 }
			add_prestige = 8
			add_legitimacy = 4
		}
		else_if = {
			limit = { piety = 0.20 }
			add_prestige = 6
			add_legitimacy = 3
		}
		else_if = {
			limit = { piety = -0.20 }
			add_prestige = 4
			add_legitimacy = 2
		}
		else_if = {
			limit = { piety = -0.60 }
			add_prestige = 2
			add_legitimacy = 1
		}
	}
	add_yearly_manpower = -0.10
	if = {
		limit = { monthly_income = 250 }
		add_treasury = -500
	}
	else_if = {
		limit = { monthly_income = 2 }
		add_years_of_income = -0.16
	}
	else = {
		add_treasury = -4
	}
	every_known_country = {
		limit = { in_league = protestant }
		if = {
			limit = { ROOT = { piety = 0.60 } }
			reverse_add_opinion = { who = ROOT modifier = holy_league_fanatical }
		}
		else_if = {
			limit = { ROOT = { piety = 0.20 } }
			reverse_add_opinion = { who = ROOT modifier = holy_league_pious }
		}
		else_if = {
			limit = { ROOT = { piety = -0.20 } }
			reverse_add_opinion = { who = ROOT modifier = holy_league_observant }
		}
		else_if = {
			limit = { ROOT = { piety = -0.60 } }
			reverse_add_opinion = { who = ROOT modifier = holy_league_decadent }
		}
	}
	hidden_effect = {
		if = {
			limit = { max_manpower = 128 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 12.8 }
			}
		}
		else_if = {
			limit = { max_manpower = 64 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 6.4 }
			}
		}
		else_if = {
			limit = { max_manpower = 32 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 3.2 }
			}
		}
		else_if = {
			limit = { max_manpower = 16 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 1.6 }
			}
		}
		else_if = {
			limit = { max_manpower = 8 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 0.8 }
			}
		}
		else_if = {
			limit = { max_manpower = 4 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 0.4 }
			}
		}
		else_if = {
			limit = { max_manpower = 2 }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 0.2 }
			}
		}
		else = {
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_manpower value = 0.1 }
			}
		}
		if = {
			limit = { NOT = { monthly_income = 5 } }
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 4 }
			}
		}
		if = {
			limit = {
				monthly_income = 5
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 10
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 15
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 20
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 30
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 40
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 50
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 60
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 80
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 100
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 120
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 140
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 160
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 180
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 200
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 225
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 50 }
			}
		}
		if = {
			limit = {
				monthly_income = 250
			}
			random_country = {
				limit = { is_league_leader = yes is_emperor = no }
				change_variable = { which = crusade_funding value = 50 }
			}
		}
	}
	random_country = {
		limit = { is_league_leader = yes is_emperor = no }
		country_event = { id = DG_Protestant.026 days = 90 random = 15 }
	}
}

support_emperor_effect = {
	if = {
		limit = {
			OR = {
				AND = {
					hre_religion = protestant
					religion = protestant
				}
				AND = {
					hre_religion = catholic
					religion = catholic
				}
				AND = {
					hre_religion = reformed
					religion = reformed
				}
			}
		}
		if = {
			limit = { piety = 0.60 }
			add_prestige = 8
			add_legitimacy = 4
		}
		else_if = {
			limit = { piety = 0.20 }
			add_prestige = 6
			add_legitimacy = 3
		}
		else_if = {
			limit = { piety = -0.20 }
			add_prestige = 4
			add_legitimacy = 2
		}
		else_if = {
			limit = { piety = -0.60 }
			add_prestige = 2
			add_legitimacy = 1
		}
	}
	add_yearly_manpower = -0.10
	if = {
		limit = { monthly_income = 250 }
		add_treasury = -500
	}
		if = {
			limit = { max_manpower = 128 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 12.8 }
			}
		}
		else_if = {
			limit = { max_manpower = 64 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 6.4 }
			}
		}
		else_if = {
			limit = { max_manpower = 32 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 3.2 }
			}
		}
		else_if = {
			limit = { max_manpower = 16 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 1.6 }
			}
		}
		else_if = {
			limit = { max_manpower = 8 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 0.8 }
			}
		}
		else_if = {
			limit = { max_manpower = 4 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 0.4 }
			}
		}
		else_if = {
			limit = { max_manpower = 2 }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 0.2 }
			}
		}
		else = {
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_manpower value = 0.1 }
			}
		}
		if = {
			limit = { NOT = { monthly_income = 5 } }
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 4 }
			}
		}
	else_if = {
		limit = { monthly_income = 2 }
		add_years_of_income = -0.16
	}
	else = {
		add_treasury = -4
	}
	hidden_effect = {
		if = {
			limit = {
				monthly_income = 5
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 10
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 15
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 20
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 10 }
			}
		}
		if = {
			limit = {
				monthly_income = 30
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 40
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 50
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 60
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 20 }
			}
		}
		if = {
			limit = {
				monthly_income = 80
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 100
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 120
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 140
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 160
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 180
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 200
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 40 }
			}
		}
		if = {
			limit = {
				monthly_income = 225
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 50 }
			}
		}
		if = {
			limit = {
				monthly_income = 250
			}
			random_country = {
				limit = { is_emperor = yes }
				change_variable = { which = crusade_funding value = 50 }
			}
		}
	}
	random_country = {
		limit = { is_emperor = yes }
		country_event = { id = DG_Protestant.026 days = 90 random = 15 }
	}
}
