Tax_EnableLand = {
	set_key = { lhs = Tax_Property value = 1 }
	set_key = { lhs = Tax_PropertyRate value = 10 }
}
Tax_DisableLand = {
	set_key = { lhs = Tax_Property value = 0 }
	set_key = { lhs = Tax_PropertyRate value = 0 }
}
Tax_EnableProperty = {
	set_key = { lhs = Tax_Property value = 2 }
	set_key = { lhs = Tax_PropertyRate value = 2 }
}
Tax_DisableProperty = {
	set_key = { lhs = Tax_Property value = 1 }
	set_key = { lhs = Tax_PropertyRate value = 10 }
}
Tax_EnablePoll = {
	set_key = { lhs = Tax_Poll value = 1 }
	set_key = { lhs = Tax_PollRate value = 10 }
}
Tax_DisablePoll = {
	set_key = { lhs = Tax_Poll value = 0 }
	set_key = { lhs = Tax_PollRate value = 0 }
}
Tax_EnableInheritance = {
	set_key = { lhs = Tax_Inheritance value = 1 }
	set_key = { lhs = Tax_InheritanceRate value = 10 }
}
Tax_DisableInheritance = {
	set_key = { lhs = Tax_Inheritance value = 0 }
	set_key = { lhs = Tax_InheritanceRate value = 0 }
}
Tax_EnableChattels = {
	set_key = { lhs = Tax_Chattels value = 1 }
	set_key = { lhs = Tax_ChattelsRate value = 5 }
}
Tax_DisableChattels = {
	set_key = { lhs = Tax_Chattels value = 0 }
	set_key = { lhs = Tax_ChattelsRate value = 0 }
}
Tax_EnableToll = {
	set_key = { lhs = Tax_Toll value = 1 }
	set_key = { lhs = Tax_TollRate value = 5 }
}
Tax_DisableToll = {
	set_key = { lhs = Tax_Toll value = 0 }
	set_key = { lhs = Tax_TollRate value = 0 }
}
Tax_EnableSalt = {
	set_key = { lhs = Tax_Salt value = 1 }
	set_key = { lhs = Tax_SaltRate value = 10 }
}
Tax_DisableSalt = {
	set_key = { lhs = Tax_Salt value = 0 }
	set_key = { lhs = Tax_SaltRate value = 0 }
}
Tax_EnableSubstances = {
	set_key = { lhs = Tax_Substances value = 1 }
	set_key = { lhs = Tax_SubstancesRate value = 5 }
}
Tax_DisableSubstances = {
	set_key = { lhs = Tax_Substances value = 0 }
	set_key = { lhs = Tax_SubstancesRate value = 0 }
}
Tax_EnableTimber = {
	set_key = { lhs = Tax_Timber value = 1 }
	set_key = { lhs = Tax_TimberRate value = 5 }
}
Tax_DisableTimber = {
	set_key = { lhs = Tax_Timber value = 0 }
	set_key = { lhs = Tax_TimberRate value = 0 }
}
Tax_EnableAlcohol = {
	set_key = { lhs = Tax_Alcohol value = 1 }
	set_key = { lhs = Tax_AlcoholRate value = 5 }
}
Tax_DisableAlcohol = {
	set_key = { lhs = Tax_Alcohol value = 0 }
	set_key = { lhs = Tax_AlcoholRate value = 0 }
}
Tax_EnableStateServiceRequirement = {
	set_key = { lhs = Mil_Bureau value = 2 }
}
Tax_DisableStateServiceRequirement = {
	set_key = { lhs = Mil_Bureau value = 1 }
}
Tax_EnableServiceVolunteer = {
	set_key = { lhs = Mil_Bureau value = 1 }
}
Tax_DisableServiceVolunteer = {
	set_key = { lhs = Mil_Bureau value = 0 }
}
Tax_EnableStateServiceDues = {
	set_key = { lhs = Mil_FeudalBU value = 1 }
}
Tax_DisableStateServiceDues = {
	set_key = { lhs = Mil_FeudalBU value = 0 }
}

Tax_Init = {
	every_owned_province = {
		add_building = levy_draft_no
		add_building = levy_volunt_no
		add_building = levy_feudal_no
		add_building = levy_noble_no
		add_building = levy_urban_no
		add_building = levy_horde_no

		add_building = tax_land_no
		add_building = tax_prop_no
		add_building = tax_poll_no
		add_building = tax_toll_no
		add_building = tax_inherit_no
		add_building = tax_chattels_no
		add_building = tax_salt_no
		add_building = tax_timber_no
		add_building = tax_subst_no
		add_building = tax_alcohol_no

		add_building = obli_feudal_no
		add_building = obli_noble_no
		add_building = obli_charter_no
		add_building = obli_tribute_no
	}
}

Tax_SetFlag = {
	trigger_switch = {
		on_trigger = has_building

		$name$_low = { set_province_flag = $name$_low }
		$name$_med = { set_province_flag = $name$_med }
		$name$_high = { set_province_flag = $name$_high }
	}
}
Tax_ClearFlag = {
	clr_province_flag = $name$_low
	clr_province_flag = $name$_med
	clr_province_flag = $name$_high
}
Tax_SetNone = {
	if = {
		limit = {
			NOT = {
				has_building = $name$_low
				has_building = $name$_med
				has_building = $name$_high
				has_building = $name$_no
			}
		}
		add_building = $name$_no
	}
}
Tax_CalcCosts = {
	set_key = { lhs = Tax_AdminEffic which = owner }
	export_to_key = { lhs = TaxMana_Tmp5 value = local_autonomy }
	subtract_key = { lhs = TaxMana_Tmp5 value = 100 }
	multiply_key = { lhs = TaxMana_Tmp5 value = -0.01 }
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp5 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp5 value = 0.01 }
	}

	Tax_CalcCostTax = { TaxName=LevyDraft Balance=2 }
	Tax_CalcCostTax = { TaxName=LevyVolunt Balance=2 }
	Tax_CalcCostTax = { TaxName=LevyFeudal Balance=2 }
	Tax_CalcCostTax = { TaxName=LevyNoble Balance=2 }
	Tax_CalcCostTax = { TaxName=LevyUrban Balance=2 }
	Tax_CalcCostTax = { TaxName=LevyHorde Balance=4 }	#Make Horde Levies twice as expensive to not have Hordes dominate so much
	
	Tax_CalcCostTax = { TaxName=TaxLand Balance=0.8 }
	Tax_CalcCostTax = { TaxName=TaxProp Balance=0.8 }
	Tax_CalcCostTax = { TaxName=TaxFeudal Balance=0.8  }
	Tax_CalcCostTax = { TaxName=TaxChattels Balance=0.8 }
	Tax_CalcCostTax = { TaxName=TaxInherit Balance=0.8 }
	Tax_CalcCostTax = { TaxName=TaxToll Balance=0.8 }
	Tax_CalcCostTax = { TaxName=TaxPoll Balance=0.8  }
	Tax_CalcCostTax = { TaxName=TaxNoble Balance=0.8  }
	Tax_CalcCostTax = { TaxName=TaxCharter Balance=0.8  }
	Tax_CalcCostTax = { TaxName=TaxTribute Balance=0.8  }

	
	Tax_CalcCostTax = { TaxName=TaxSalt Balance=0.8  }
	Tax_CalcCostTax = { TaxName=TaxTimber Balance=0.8  }
	Tax_CalcCostTax = { TaxName=TaxSubst Balance=0.8 }
	Tax_CalcCostTax = { TaxName=TaxAlcohol Balance=0.8 }
	
	Tax_CalcCostTax = { TaxName=PropAgriculture }
	Tax_CalcCostTax = { TaxName=PropExtraction }
	Tax_CalcCostTax = { TaxName=PropForestry }
	Tax_CalcCostTax = { TaxName=PropFishery }
	Tax_CalcCostTax = { TaxName=PropIndustrial }
	Tax_CalcCostTax = { TaxName=PropAcademic }
	Tax_CalcCostTax = { TaxName=PropCommercial }
}

Tax_GetPopScalar = {
	if = {
		limit = {
			check_key = { lhs = $TotalVar$ value = 1 }
		}
		set_key = { lhs = TaxMana_Tmp4 which = $TotalVar$ }
		if = {
			limit = {
				check_key = { lhs = $TotalVar$ value = $MaxPop$ }
			}
			set_key = { lhs = TaxMana_Tmp4 which = $TotalVar$ }
			multiply_key = { lhs = TaxMana_Tmp4 value = $ReductionPer$ }
		}
		else = {
			set_key = { lhs = TaxMana_Tmp4 which = $TotalVar$ }
			divide_key = { lhs = TaxMana_Tmp4 value = $MaxPop$ }
			multiply_key = { lhs = TaxMana_Tmp4 which = TaxMana_Tmp4 }
			multiply_key = { lhs = TaxMana_Tmp4 value = -1 }
			change_key = { lhs = TaxMana_Tmp4 value = 1 }
			set_key = { lhs = TaxMana_Tmp3 value = 1 }
			subtract_key = { lhs = TaxMana_Tmp3 value = $ReductionPer$ }
			multiply_key = { lhs = TaxMana_Tmp4 which = TaxMana_Tmp3 }
			change_key = { lhs = TaxMana_Tmp4 value = $ReductionPer$ }
			multiply_key = { lhs = TaxMana_Tmp4 which = $TotalVar$ }
		}
		multiply_key = { lhs = TaxMana_Tmp4 which = Modi_ManaCostFromPop }
		change_key = { lhs = $return$ which = TaxMana_Tmp4 }
	}
	else = {
		change_key = { lhs = $return$ value = 1 }
	}
}
Tax_GetLoyDivider = {
	if = {
		limit = {
			NOT = {
				check_key = { lhs = Prov_$Class$Loy value = 20 }
			}
		}
		set_key = { lhs = TaxMana_Tmp3 value = 1 }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp3 value = 100 }
		subtract_key = { lhs = TaxMana_Tmp3 which = Prov_$Class$Loy }
		divide_key = { lhs = TaxMana_Tmp3 value = 80 }
		#if = {
		#	limit = {
		#		check_key = { lhs = TaxMana_Tmp3 value = 1.001 }
		#	}
		#	set_key = { lhs = TaxMana_Tmp3 value = 1 }
		#}
		multiply_key = { lhs = TaxMana_Tmp3 which = TaxMana_Tmp3 }
		if = {
			limit = {
				NOT = { check_key = { lhs = TaxMana_Tmp3 value = 0.001 } }
			}
			set_key = { lhs = TaxMana_Tmp3 value = 0.001 }
		}
		#multiply_key = { lhs = TaxMana_Tmp3 value = -1 }
		#change_key = { lhs = TaxMana_Tmp3 value = 1 }
	}
	export_to_key = { lhs = TaxMana_Tmp2 value = local_autonomy }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp3 }
	multiply_key = { lhs = TaxMana_Tmp2 value = -0.01 }
	change_key = { lhs = TaxMana_Tmp2 value = 1 }
}

Tax_CalcCostTax = {
	if = {
		limit = {
			owner = { Tax_$TaxName$Can = yes }
		}
		Tax_Cost$TaxName$Calc = yes
		multiply_key = { lhs = Tax_Cost$TaxName$High value = 0.45 } ### GLOBAL TAX BALANCER HERE
		[[Balance] multiply_key = { lhs = Tax_Cost$TaxName$High value = $Balance$ } ] ### TAX BALANCER HERE
		if = {
			limit = {
				check_key = { lhs = Tax_Cost$TaxName$High value = 250 } ### Sanity check
			}
			set_key = { lhs = Tax_Cost$TaxName$High value = 250 }
		}
		else_if = {
			limit = {
				NOT = { check_key = { lhs = Tax_Cost$TaxName$High value = 0.05 } }
			}
			set_key = { lhs = Tax_Cost$TaxName$High value = 0.05 }
		}
	}
	else = {
		set_key = { lhs = Tax_Cost$TaxName$High value = 0 }
	}
}

Tax_Cost = {
	set_key = { lhs = Tax_CostAdm value = 0 }
	set_key = { lhs = Tax_CostDip value = 0 }
	set_key = { lhs = Tax_CostMil value = 0 }

	set_key = { lhs = Edict_Adm_Cost value = 0 }
	set_key = { lhs = Edict_Dip_Cost value = 0 }
	set_key = { lhs = Edict_Mil_Cost value = 0 }

	Tax_CostGet = { Tax=LevyDraft Type=Mil }
	Tax_CostGet = { Tax=LevyVolunt Type=Mil }
	Tax_CostGet = { Tax=LevyFeudal Type=Mil }
	Tax_CostGet = { Tax=LevyHorde Type=Mil }
	Tax_CostGet = { Tax=LevyNoble Type=Mil }
	Tax_CostGet = { Tax=LevyUrban Type=Mil }
	
	Tax_CostGet = { Tax=TaxChattels Type=Adm }
	Tax_CostGet = { Tax=TaxPoll Type=Adm }
	Tax_CostGet = { Tax=TaxInherit Type=Adm }
	Tax_CostGet = { Tax=TaxToll Type=Adm }
	Tax_CostGet = { Tax=TaxLand Type=Adm }
	Tax_CostGet = { Tax=TaxProp Type=Adm }
	Tax_CostGet = { Tax=TaxSalt Type=Adm }
	Tax_CostGet = { Tax=TaxSubst Type=Adm }
	
	Tax_CostGet = { Tax=TaxAlcohol Type=Dip }
	Tax_CostGet = { Tax=TaxTimber Type=Dip }
	
	Tax_CostGet = { Tax=TaxFeudal Type=Dip }
	Tax_CostGet = { Tax=TaxNoble Type=Dip }
	Tax_CostGet = { Tax=TaxCharter Type=Dip }
	Tax_CostGet = { Tax=TaxTribute Type=Dip }
	
	Tax_CostGet = { Tax=PropAgriculture Type=Dip }
	Tax_CostGet = { Tax=PropExtraction Type=Dip }
	Tax_CostGet = { Tax=PropForestry Type=Dip }
	Tax_CostGet = { Tax=PropFishery Type=Dip }
	Tax_CostGet = { Tax=PropIndustrial Type=Dip }
	Tax_CostGet = { Tax=PropAcademic Type=Dip }
	Tax_CostGet = { Tax=PropCommercial Type=Dip }

	if = {
		limit = {
			owner = { ai = no }
		}
		Edict_CostGet = { edict=adm_edict_centralization_effort  	 type=Adm   dev_multi=0.12 }
		Edict_CostGet = { edict=adm_edict_extract_taxes 		 	 type=Adm   dev_multi=0.12 }
		Edict_CostGet = { edict=adm_edict_attract_peasantry_act	 	 type=Adm   dev_multi=0.12 }
		Edict_CostGet = { edict=dip_edict_improve_elite_loyalty  	 type=Dip   dev_multi=0.12 }
		Edict_CostGet = { edict=dip_edict_promote_local_commerce 	 type=Dip   dev_multi=0.12 }
		Edict_CostGet = { edict=dip_edict_learning_and_education_act type=Dip   dev_multi=0.12 }
		Edict_CostGet = { edict=dip_encourage_city_growth_act	 	 type=Dip   dev_multi=0.12 }
		Edict_CostGet = { edict=mil_edict_recruitment_effort 		 type=Mil   dev_multi=0.12 }
		Edict_CostGet = { edict=mil_edict_police_communities		 type=Mil 	dev_multi=0.12 }
		Edict_CostGet = { edict=mil_edict_tribal_resettlement 		 type=Mil 	dev_multi=0.12 }
		Edict_CostGet = { edict=dip_edict_establish_missions		 type=Dip	dev_multi=0.12 }
	}
}
Edict_CostGet = {
	if = {
		limit = { has_state_edict=$edict$ }
		
		Edict_CostGet_Helper={ type=$type$ dev_multi=$dev_multi$ }
	}
}
Edict_CostGet_Helper = {
	set_key = { lhs = Tax_Tmp0 which = Dev_Total }
	multiply_key = { lhs = Tax_Tmp0 value = $dev_multi$ }
	change_key = { lhs = Edict_$type$_Cost which = Tax_Tmp0 }
	change_key = { lhs = Tax_Cost$type$ which = Tax_Tmp0 }
	set_key = { lhs = Tax_Tmp0 value = 0 }
}
Tax_CostGet = {
	set_key = { lhs = Tax_Cost$Tax$ which = Tax_Cost$Tax$High }
	multiply_key = { lhs = Tax_Cost$Tax$ which = Tax_Cost$Tax$Rate }
	multiply_key = { lhs = Tax_Cost$Tax$ value = 0.01 }
	[[Type] change_key = { lhs = Tax_Cost$Type$ which = Tax_Cost$Tax$ } ]
}

Tax_CostLevyDraftCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 1 }
	Tax_GetPopScalar = { return=TaxMana_Tmp0 TotalVar=Class_Total MaxPop=800 ReductionPer=0.5 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.3 }

	if = {
		limit = {
			owner = {
				Rights_NOSer4HasGreater = no
			}
		}
		multiply_key = { lhs = TaxMana_Tmp0 value = 2 }
	}
	else_if = {
		limit = {
			owner = {
				Rights_NOSer4Has = yes
			}
		}
		multiply_key = { lhs = TaxMana_Tmp0 value = 1.5 }
	}
	else_if = {
		limit = {
			owner = {
				Rights_NOSer5Has = yes
			}
		}
		multiply_key = { lhs = TaxMana_Tmp0 value = 1.25 }
	}

	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficDir }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.005 }
	change_key = { lhs = TaxMana_Tmp2 value = 0.5 }
	if = {
		limit = {
			owner = { has_country_modifier = Ottoman_Janissaries }
		}
		MN_GetReligion = { typeReligion = value religion = 15 return = TaxMana_Tmp1 } #Sunni=15
		if = {
			limit = {
				check_key = { lhs = TaxMana_Tmp1 value = 0.001 }
				NOT = { check_key = { lhs = TaxMana_Tmp1 which = Class_Total } }
			}
			set_key = { lhs = TaxMana_Tmp3 which = Class_Total }
			subtract_key = { lhs = TaxMana_Tmp3 which = TaxMana_Tmp1 }
			divide_key = { lhs = TaxMana_Tmp3 which = Class_Total }
			set_key = { lhs = TaxMana_Tmp1 which = TaxMana_Tmp3 }
			
			set_key = { lhs = TaxMana_Tmp3 value = 1 }
			subtract_key = { lhs = TaxMana_Tmp3 which = TaxMana_Tmp1 }
			
			multiply_key = { lhs = TaxMana_Tmp1 which = TaxMana_Tmp5 }
			change_key = { lhs = TaxMana_Tmp1 which = TaxMana_Tmp3 }
			multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp1 }
		}
		else = {
			multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
		}
		multiply_key = { lhs = TaxMana_Tmp2 value = 1.1 }
	}
	else = {
		multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	}
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_LevyDraftCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostLevyDraftHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostLevyDraftHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostLevyDraftHigh which = TaxMana_Tmp2 }
	multiply_key = { lhs = Tax_CostLevyDraftHigh which = Mil_StateSpendMulti }
	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostLevyVoluntCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.1 }
	Tax_GetPopScalar = { return=TaxMana_Tmp0 TotalVar=Class_Total MaxPop=800 ReductionPer=0.5 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 2.5 }

	set_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		multiply_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		multiply_key = { lhs = TaxMana_Tmp2 which = Admin_EfficDir }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.005 }
	change_key = { lhs = TaxMana_Tmp2 value = 0.5 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_LevyVoluntCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostLevyVoluntHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostLevyVoluntHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostLevyVoluntHigh which = TaxMana_Tmp2 }
	multiply_key = { lhs = Tax_CostLevyVoluntHigh which = Mil_StateSpendMulti }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostLevyFeudalCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.4 }
	Tax_GetPopScalar = { return=TaxMana_Tmp0 TotalVar=SF_Total MaxPop=600 ReductionPer=0.5 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 1.2 }
	multiply_key = { lhs = TaxMana_Tmp0 which = BU_PrpResources }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 2.6 } ### balancing
	
	set_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	change_key = { lhs = TaxMana_Tmp3 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp3 }
	
	set_key = { lhs = TaxMana_Tmp3 value = 100 }
	subtract_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.5 }

	set_key = { lhs = TaxMana_Tmp4 value = 1 }
	subtract_key = { lhs = TaxMana_Tmp4 which = TaxMana_Tmp3 }

	set_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp4 }
	change_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp3 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_LevyFeudalCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostLevyFeudalHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostLevyFeudalHigh value = 4 }
	multiply_key = { lhs = Tax_CostLevyFeudalHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostLevyFeudalHigh which = TaxMana_Tmp2 }
	multiply_key = { lhs = Tax_CostLevyFeudalHigh which = Mil_StateSpendMulti }
	
	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostLevyHordeCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.03 }
	change_key = { lhs = TaxMana_Tmp0 which = Tax_TRMP }
	set_key = { lhs = TaxMana_Tmp2 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.5 }
	change_key = { lhs = TaxMana_Tmp2 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }
	set_key = { lhs = TaxMana_Tmp2 value = 100 }
	subtract_key = { lhs = TaxMana_Tmp2 which = Prov_TRPow }
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.5 }
	change_key = { lhs = TaxMana_Tmp2 value = 0.5 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.6 }
	
	set_key = { lhs = TaxMana_Tmp2 which = NM_Ratio }
	multiply_key = { lhs = TaxMana_Tmp2 value = -0.005 }
	change_key = { lhs = TaxMana_Tmp2 value = 3 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 } ### balancing
	if = {
		limit = {
			Rights_BUTax3HasGreater = yes
		}
		multiply_key = { lhs = TaxMana_Tmp0 value = 2 }
	}
	
	if = {
		limit = {
			owner = { is_tribal = yes }
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.5 }
	}
	if = {
		limit = {
			is_capital = yes
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.666 }
	}
	else_if = {
		limit = {
			is_in_capital_area = yes
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.333 }
	}
	if = {
		limit = {
			owner = {
				has_country_flag = Modi_TribalMP
			}
		}
		if = {
			limit = {
				owner = {
					is_tribal = yes
				}
			}
			multiply_key = { lhs = TaxMana_Tmp0 value = 0.5 }
		}
		else = {
			multiply_key = { lhs = TaxMana_Tmp0 value = 0.75 }
		}
	}
	if = {
		limit = {
			owner = {
				has_country_flag = Modi_NomadMP
			}
		}
		if = {
			limit = {
				owner = {
					is_tribal = yes
				}
			}
			multiply_key = { lhs = TaxMana_Tmp0 value = 0.85 }
		}
		else = {
			multiply_key = { lhs = TaxMana_Tmp0 value = 0.9 }
		}
	}
	Tax_GetLoyDivider = { Class=TR }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_LevyHordeCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostLevyHordeHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostLevyHordeHigh value = 20 }
	multiply_key = { lhs = Tax_CostLevyHordeHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostLevyHordeHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostLevyNobleCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.03 }
	change_key = { lhs = TaxMana_Tmp0 which = Tax_NOMP }
	multiply_key = { lhs = TaxMana_Tmp0 value = 2.0 } ### balancing
	if = {
		limit = {
			owner = {
				government = monarchy
			}
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 2 }
	}
	if = {
		limit = {
			is_capital = yes
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.5 }
	}
	else_if = {
		limit = {
			is_in_capital_area = yes
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.25 }
	}
	Tax_GetLoyDivider = { Class=NO }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_LevyNobleCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostLevyNobleHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostLevyNobleHigh value = 25 }
	multiply_key = { lhs = Tax_CostLevyNobleHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostLevyNobleHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostLevyUrbanCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Tax_BGMP }
	multiply_key = { lhs = TaxMana_Tmp0 value = 4 } ### balancing
	if = {
		limit = {
			owner = {
				government = republic
			}
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 2 }
	}
	Tax_GetLoyDivider = { Class=BG }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_LevyUrbanCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostLevyUrbanHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostLevyUrbanHigh value = 30 }
	multiply_key = { lhs = Tax_CostLevyUrbanHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostLevyUrbanHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}

Tax_CostTaxChattelsCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	Tax_GetPopScalar = { return=TaxMana_Tmp0 TotalVar=Class_Total MaxPop=800 ReductionPer=0.5 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.25 } #divide_key = { lhs = TaxMana_Tmp0 value = 4 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 1.2 } ### balancing
	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficDir }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxChattelsCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxChattelsHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxChattelsHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxChattelsHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxPollCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	Tax_GetPopScalar = { return=TaxMana_Tmp0 TotalVar=Class_Total MaxPop=800 ReductionPer=0.5 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.25 } #divide_key = { lhs = TaxMana_Tmp0 value = 4 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 2 } ### balancing
	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficDir }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxPollCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxPollHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxPollHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxPollHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxInheritCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = NO_Total }
	change_key = { lhs = TaxMana_Tmp0 which = BG_Total }
	change_key = { lhs = TaxMana_Tmp0 which = CL_Total }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_ManaCostFromPop }
	multiply_key = { lhs = TaxMana_Tmp0 value = 15 }
	change_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.25 } #divide_key = { lhs = TaxMana_Tmp0 value = 4 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.9 } ### balancing
	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficDir }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxInheritCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxInheritHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxInheritHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxInheritHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxTollCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = TN_ProvSply51 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 10 }
	change_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.25 } #divide_key = { lhs = TaxMana_Tmp0 value = 4 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 1.0 } ### balancing
	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficInd }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxTollCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxTollHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxTollHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxTollHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxLandCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Building_Resources }
	multiply_key = { lhs = TaxMana_Tmp0 value = 2 }
	change_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.25 } #divide_key = { lhs = TaxMana_Tmp0 value = 4 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.9 } ### balancing
	if = {
		limit = {
			owner = {
				Rights_NOGov1Has = yes
			}
		}
		multiply_key = { lhs = TaxMana_Tmp0 value = 2.5 }
	}
	else_if = {
		limit = {
			owner = {
				Rights_NOGov2Has = yes
			}
		}
		multiply_key = { lhs = TaxMana_Tmp0 value = 2 }
	}
	else_if = {
		limit = {
			owner = {
				Rights_NOGov3Has = yes
			}
		}
		multiply_key = { lhs = TaxMana_Tmp0 value = 1.5 }
	}
	else_if = {
		limit = {
			owner = {
				Rights_NOGov4Has = yes
			}
		}
		multiply_key = { lhs = TaxMana_Tmp0 value = 1.25 }
	}
	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficDir }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxLandCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxLandHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxLandHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxLandHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxPropCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Building_Building }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.45 } ### balancing
	if = {
		limit = {
			owner = {
				Rights_NOGov1Has = yes
			}
		}
		multiply_key = { lhs = TaxMana_Tmp0 value = 2 }
	}
	else_if = {
		limit = {
			owner = {
				Rights_NOGov2Has = yes
			}
		}
		multiply_key = { lhs = TaxMana_Tmp0 value = 1.5 }
	}
	else_if = {
		limit = {
			owner = {
				Rights_NOGov3Has = yes
			}
		}
		multiply_key = { lhs = TaxMana_Tmp0 value = 1.25 }
	}
	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficDir }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxPropCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxPropHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxPropHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxPropHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxAlcoholCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.24 }
	change_key = { lhs = TaxMana_Tmp0 which = TN_ProvSply1 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 1.666 } ### balancing
	
	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficInd }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxAlcoholCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxAlcoholHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxAlcoholHigh value = 2 }
	multiply_key = { lhs = Tax_CostTaxAlcoholHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxAlcoholHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxSaltCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.1 }
	change_key = { lhs = TaxMana_Tmp0 which = TN_ProvSply2 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 1.0 } ### balancing
	
	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficInd }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxSaltCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxSaltHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxSaltHigh value = 4 }
	multiply_key = { lhs = Tax_CostTaxSaltHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxSaltHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxTimberCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	change_key = { lhs = TaxMana_Tmp0 which = Building_Forestry }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.1 }
	#multiply_key = { lhs = TaxMana_Tmp0 value = 1.1 } ### balancing
	
	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficInd }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxTimberCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxTimberHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxTimberHigh value = 2 }
	multiply_key = { lhs = Tax_CostTaxTimberHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxTimberHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxSubstCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.1 }
	change_key = { lhs = TaxMana_Tmp0 which = TN_ProvDmnd9 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.8 } ### balancing
	
	if = {
		limit = {
			Rights_HasUnifiedTax = yes
		}
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficUni }
	}
	else = {
		set_key = { lhs = TaxMana_Tmp2 which = Admin_EfficInd }
	}
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxSubstCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxSubstHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxSubstHigh value = 2 }
	multiply_key = { lhs = Tax_CostTaxSubstHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxSubstHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxFeudalCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	Tax_GetPopScalar = { return=TaxMana_Tmp0 TotalVar=SF_Total MaxPop=600 ReductionPer=0.5 }
	multiply_key = { lhs = TaxMana_Tmp0 which = BU_PrpResources }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 3 } ### balancing
	
	set_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	change_key = { lhs = TaxMana_Tmp3 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp3 }
	
	set_key = { lhs = TaxMana_Tmp3 value = 100 }
	subtract_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.5 }

	set_key = { lhs = TaxMana_Tmp4 value = 1 }
	subtract_key = { lhs = TaxMana_Tmp4 which = TaxMana_Tmp3 }

	set_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp4 }
	change_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp3 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxFeudalCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxFeudalHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxFeudalHigh value = 2 }
	multiply_key = { lhs = Tax_CostTaxFeudalHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxFeudalHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxNobleCalc = {
	set_key = { lhs = TaxMana_Tmp2 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.25 }
	set_key = { lhs = TaxMana_Tmp0 which = NO_Wealth }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.1 }
	change_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 4 } ### balancing

	if = {
		limit = {
			owner = {
				government = monarchy
			}
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 2 }
	}
	if = {
		limit = {
			is_capital = yes
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.666 }
	}
	else_if = {
		limit = {
			is_in_capital_area = yes
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.333 }
	}
	Tax_GetLoyDivider = { Class=NO }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxNobleCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxNobleHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxNobleHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxNobleHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxCharterCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = BG_Wealth }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.1 }
	Tax_GetPopScalar = { return=TaxMana_Tmp0 TotalVar=RE_Total MaxPop=400 ReductionPer=0.5 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 3 } ### balancing

	if = {
		limit = {
			owner = {
				government = republic
			}
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 2 }
	}
	if = {
		limit = {
			is_capital = yes
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.666 }
	}
	else_if = {
		limit = {
			is_in_capital_area = yes
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.333 }
	}
	Tax_GetLoyDivider = { Class=BG }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxCharterCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxCharterHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxCharterHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxCharterHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostTaxTributeCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = Land_PSize }
	multiply_key = { lhs = TaxMana_Tmp0 value = 0.03 }
	set_key = { lhs = TaxMana_Tmp2 which = NO_Wealth }
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.08 }
	change_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 } 
	Tax_GetPopScalar = { return=TaxMana_Tmp0 TotalVar=Class_Total MaxPop=1000 ReductionPer=0.5 }

	set_key = { lhs = TaxMana_Tmp2 value = 100 }
	subtract_key = { lhs = TaxMana_Tmp2 which = Prov_TRPow }
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.5 }
	change_key = { lhs = TaxMana_Tmp2 value = 0.5 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }
	multiply_key = { lhs = TaxMana_Tmp0 value = 3 }

	set_key = { lhs = TaxMana_Tmp2 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp2 value = 0.5 }
	change_key = { lhs = TaxMana_Tmp2 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }

	multiply_key = { lhs = TaxMana_Tmp0 value = 1.666 } ### balancing

	if = {
		limit = {
			owner = { is_tribal = yes }
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.5 }
	}
	if = {
		limit = {
			owner = {
				has_country_flag = Modi_TribalMP
			}
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 2 }
	}
	if = {
		limit = {
			is_capital = yes
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.666 }
	}
	else_if = {
		limit = {
			is_in_capital_area = yes
		}
		divide_key = { lhs = TaxMana_Tmp0 value = 1.333 }
	}
	Tax_GetLoyDivider = { Class=TR }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxTributeCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostTaxTributeHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostTaxTributeHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostTaxTributeHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostPropAgricultureCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = BU_Agriculture }
	multiply_key = { lhs = TaxMana_Tmp0 value = 2.5 } ### balancing
	change_key = { lhs = TaxMana_Tmp0 value = 0.01 }
	
	set_key = { lhs = TaxMana_Tmp2 which = Building_AgricultureShareBU }
	change_key = { lhs = TaxMana_Tmp2 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }
	
	set_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	change_key = { lhs = TaxMana_Tmp3 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp3 }
	
	set_key = { lhs = TaxMana_Tmp3 value = 100 }
	subtract_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.5 }

	set_key = { lhs = TaxMana_Tmp4 value = 1 }
	subtract_key = { lhs = TaxMana_Tmp4 which = TaxMana_Tmp3 }

	set_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp4 }
	change_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp3 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxPropAgricultureCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostPropAgricultureHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostPropAgricultureHigh value = 20 }
	multiply_key = { lhs = Tax_CostPropAgricultureHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostPropAgricultureHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostPropExtractionCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = BU_Extraction }
	multiply_key = { lhs = TaxMana_Tmp0 value = 1.5 } ### balancing
	change_key = { lhs = TaxMana_Tmp0 value = 0.01 }
	
	set_key = { lhs = TaxMana_Tmp2 which = Building_ExtractionShareBU }
	change_key = { lhs = TaxMana_Tmp2 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }
	
	set_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	change_key = { lhs = TaxMana_Tmp3 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp3 }
	
	set_key = { lhs = TaxMana_Tmp3 value = 100 }
	subtract_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.5 }

	set_key = { lhs = TaxMana_Tmp4 value = 1 }
	subtract_key = { lhs = TaxMana_Tmp4 which = TaxMana_Tmp3 }

	set_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp4 }
	change_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp3 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxPropExtractionCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostPropExtractionHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostPropExtractionHigh value = 20 }
	multiply_key = { lhs = Tax_CostPropExtractionHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostPropExtractionHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostPropForestryCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = BU_Forestry }
	multiply_key = { lhs = TaxMana_Tmp0 value = 1.5 } ### balancing
	change_key = { lhs = TaxMana_Tmp0 value = 0.01 }
	
	set_key = { lhs = TaxMana_Tmp2 which = Building_ForestryShareBU }
	change_key = { lhs = TaxMana_Tmp2 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }
	
	set_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	change_key = { lhs = TaxMana_Tmp3 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp3 }
	
	set_key = { lhs = TaxMana_Tmp3 value = 100 }
	subtract_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.5 }

	set_key = { lhs = TaxMana_Tmp4 value = 1 }
	subtract_key = { lhs = TaxMana_Tmp4 which = TaxMana_Tmp3 }

	set_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp4 }
	change_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp3 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxPropForestryCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }

	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostPropForestryHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostPropForestryHigh value = 20 }
	multiply_key = { lhs = Tax_CostPropForestryHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostPropForestryHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostPropFisheryCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = BU_Fishery }
	multiply_key = { lhs = TaxMana_Tmp0 value = 3 } ### balancing
	change_key = { lhs = TaxMana_Tmp0 value = 0.01 }
	
	set_key = { lhs = TaxMana_Tmp2 which = Building_FisheryShareBU }
	change_key = { lhs = TaxMana_Tmp2 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }
	
	set_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	change_key = { lhs = TaxMana_Tmp3 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp3 }
	
	set_key = { lhs = TaxMana_Tmp3 value = 100 }
	subtract_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.5 }

	set_key = { lhs = TaxMana_Tmp4 value = 1 }
	subtract_key = { lhs = TaxMana_Tmp4 which = TaxMana_Tmp3 }

	set_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp4 }
	change_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp3 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxPropFisheryCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostPropFisheryHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostPropFisheryHigh value = 20 }
	multiply_key = { lhs = Tax_CostPropFisheryHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostPropFisheryHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostPropIndustrialCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = BU_Industrial }
	multiply_key = { lhs = TaxMana_Tmp0 value = 2.5 } ### balancing
	change_key = { lhs = TaxMana_Tmp0 value = 0.01 }
	
	set_key = { lhs = TaxMana_Tmp2 which = Building_IndustrialShareBU }
	change_key = { lhs = TaxMana_Tmp2 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }
	
	set_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	change_key = { lhs = TaxMana_Tmp3 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp3 }
	
	set_key = { lhs = TaxMana_Tmp3 value = 100 }
	subtract_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.5 }

	set_key = { lhs = TaxMana_Tmp4 value = 1 }
	subtract_key = { lhs = TaxMana_Tmp4 which = TaxMana_Tmp3 }

	set_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp4 }
	change_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp3 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxPropIndustrialCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostPropIndustrialHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostPropIndustrialHigh value = 20 }
	multiply_key = { lhs = Tax_CostPropIndustrialHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostPropIndustrialHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostPropAcademicCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = BU_Academic }
	multiply_key = { lhs = TaxMana_Tmp0 value = 2.5 } ### balancing
	change_key = { lhs = TaxMana_Tmp0 value = 0.01 }
	
	set_key = { lhs = TaxMana_Tmp2 which = Building_AcademicShareBU }
	change_key = { lhs = TaxMana_Tmp2 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }
	
	set_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	change_key = { lhs = TaxMana_Tmp3 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp3 }
	
	set_key = { lhs = TaxMana_Tmp3 value = 100 }
	subtract_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.5 }

	set_key = { lhs = TaxMana_Tmp4 value = 1 }
	subtract_key = { lhs = TaxMana_Tmp4 which = TaxMana_Tmp3 }

	set_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp4 }
	change_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp3 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxPropAcademicCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostPropAcademicHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostPropAcademicHigh value = 20 }
	multiply_key = { lhs = Tax_CostPropAcademicHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostPropAcademicHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_CostPropCommercialCalc = {
	set_key = { lhs = TaxMana_Tmp0 which = BU_Commercial }
	multiply_key = { lhs = TaxMana_Tmp0 value = 5 } ### balancing
	change_key = { lhs = TaxMana_Tmp0 value = 0.01 }
	
	set_key = { lhs = TaxMana_Tmp2 which = Building_CommercialShareBU }
	change_key = { lhs = TaxMana_Tmp2 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp2 }
	
	set_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	change_key = { lhs = TaxMana_Tmp3 value = 1 }
	multiply_key = { lhs = TaxMana_Tmp0 which = TaxMana_Tmp3 }
	
	set_key = { lhs = TaxMana_Tmp3 value = 100 }
	subtract_key = { lhs = TaxMana_Tmp3 which = Prov_BUPow }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.01 }
	multiply_key = { lhs = TaxMana_Tmp3 value = 0.5 }

	set_key = { lhs = TaxMana_Tmp4 value = 1 }
	subtract_key = { lhs = TaxMana_Tmp4 which = TaxMana_Tmp3 }

	set_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp5 }
	multiply_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp4 }
	change_key = { lhs = TaxMana_Tmp2 which = TaxMana_Tmp3 }
	
	divide_key = { lhs = TaxMana_Tmp0 which = Tax_AdminEffic }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxPropCommercialCost }
	multiply_key = { lhs = TaxMana_Tmp0 which = Modi_TaxMana }
	
	if = {
		limit = {
			NOT = { check_key = { lhs = TaxMana_Tmp2 value = 0.01 } }
		}
		set_key = { lhs = TaxMana_Tmp2 value = 0.01 }
	}
	set_key = { lhs = Tax_CostPropCommercialHigh value = 0.006 }
	multiply_key = { lhs = Tax_CostPropCommercialHigh value = 20 }
	multiply_key = { lhs = Tax_CostPropCommercialHigh which = TaxMana_Tmp0 }
	divide_key = { lhs = Tax_CostPropCommercialHigh which = TaxMana_Tmp2 }

	set_key = { lhs = TaxMana_Tmp0 value = 0 }
	set_key = { lhs = TaxMana_Tmp1 value = 0 }
	set_key = { lhs = TaxMana_Tmp2 value = 0 }
	set_key = { lhs = TaxMana_Tmp3 value = 0 }
	set_key = { lhs = TaxMana_Tmp4 value = 0 }
}
Tax_SetLevel = {
	every_owned_province = {
		remove_building = $class$_$type$_no
		remove_building = $class$_$type$_low
		remove_building = $class$_$type$_med
		remove_building = $class$_$type$_high
		add_building = $class$_$type$_$level$
	}
}
Tax_Update = {
	hidden_effect = {		
		set_key = { lhs = Tax_CostAdm value = 0 }
		set_key = { lhs = Tax_CostDip value = 0 }
		set_key = { lhs = Tax_CostMil value = 0 }

		set_key = { lhs = Edict_Adm_Cost value = 0 }
		set_key = { lhs = Edict_Dip_Cost value = 0 }
		set_key = { lhs = Edict_Mil_Cost value = 0 }

		set_key = { lhs = Tax_CostLevyDraft value = 0 }
		set_key = { lhs = Tax_CostLevyVolunt value = 0 }
		set_key = { lhs = Tax_CostLevyFeudal value = 0 }
		set_key = { lhs = Tax_CostLevyNoble value = 0 }
		set_key = { lhs = Tax_CostLevyUrban value = 0 }
		set_key = { lhs = Tax_CostLevyHorde value = 0 }
		set_key = { lhs = Tax_CostTaxLand value = 0 }
		set_key = { lhs = Tax_CostTaxProp value = 0 }
		set_key = { lhs = Tax_CostTaxFeudal value = 0 }
		set_key = { lhs = Tax_CostTaxChattels value = 0 }
		set_key = { lhs = Tax_CostTaxInherit value = 0 }
		set_key = { lhs = Tax_CostTaxToll value = 0 }
		set_key = { lhs = Tax_CostTaxPoll value = 0 }
		set_key = { lhs = Tax_CostTaxNoble value = 0 }
		set_key = { lhs = Tax_CostTaxCharter value = 0 }
		set_key = { lhs = Tax_CostTaxTribute value = 0 }
		
		set_key = { lhs = Tax_CostTaxSalt value = 0 }
		set_key = { lhs = Tax_CostTaxTimber value = 0 }
		set_key = { lhs = Tax_CostTaxSubst value = 0 }
		set_key = { lhs = Tax_CostTaxAlcohol value = 0 }
		
		set_key = { lhs = Tax_CostPropAgriculture value = 0 }
		set_key = { lhs = Tax_CostPropExtraction value = 0 }
		set_key = { lhs = Tax_CostPropForestry value = 0 }
		set_key = { lhs = Tax_CostPropFishery value = 0 }
		set_key = { lhs = Tax_CostPropIndustrial value = 0 }
		set_key = { lhs = Tax_CostPropAcademic value = 0 }
		set_key = { lhs = Tax_CostPropCommercial value = 0 }
		
		set_key = { lhs = Tax_CostTaxProperty value = 0 }

		every_owned_province = {
			Tax_Cost = yes
			set_key = { lhs = Tax_CostTaxProperty value = 0 }
			change_key = { lhs = Tax_CostTaxProperty which = Tax_CostPropAgriculture }
			change_key = { lhs = Tax_CostTaxProperty which = Tax_CostPropExtraction }
			change_key = { lhs = Tax_CostTaxProperty which = Tax_CostPropForestry }
			change_key = { lhs = Tax_CostTaxProperty which = Tax_CostPropFishery }
			change_key = { lhs = Tax_CostTaxProperty which = Tax_CostPropIndustrial }
			change_key = { lhs = Tax_CostTaxProperty which = Tax_CostPropAcademic }
			change_key = { lhs = Tax_CostTaxProperty which = Tax_CostPropCommercial }
			PREV = {
				change_key = { lhs = Tax_CostAdm which = PREV }
				change_key = { lhs = Tax_CostDip which = PREV }
				change_key = { lhs = Tax_CostMil which = PREV }

				change_key = { lhs = Edict_Adm_Cost which = PREV }
				change_key = { lhs = Edict_Dip_Cost which = PREV }
				change_key = { lhs = Edict_Mil_Cost which = PREV }

				change_key = { lhs = Tax_CostLevyDraft which = PREV }
				change_key = { lhs = Tax_CostLevyVolunt which = PREV }
				change_key = { lhs = Tax_CostLevyFeudal which = PREV }
				change_key = { lhs = Tax_CostLevyNoble which = PREV }
				change_key = { lhs = Tax_CostLevyUrban which = PREV }
				change_key = { lhs = Tax_CostLevyHorde which = PREV }
				change_key = { lhs = Tax_CostTaxLand which = PREV }
				change_key = { lhs = Tax_CostTaxProp which = PREV }
				change_key = { lhs = Tax_CostTaxFeudal which = PREV }
				change_key = { lhs = Tax_CostTaxChattels which = PREV }
				change_key = { lhs = Tax_CostTaxInherit which = PREV }
				change_key = { lhs = Tax_CostTaxToll which = PREV }
				change_key = { lhs = Tax_CostTaxPoll which = PREV }
				change_key = { lhs = Tax_CostTaxNoble which = PREV }
				change_key = { lhs = Tax_CostTaxCharter which = PREV }
				change_key = { lhs = Tax_CostTaxTribute which = PREV }
				
				change_key = { lhs = Tax_CostTaxSalt which = PREV }
				change_key = { lhs = Tax_CostTaxTimber which = PREV }
				change_key = { lhs = Tax_CostTaxSubst which = PREV }
				change_key = { lhs = Tax_CostTaxAlcohol which = PREV }
		
				change_key = { lhs = Tax_CostPropAgriculture which = PREV }
				change_key = { lhs = Tax_CostPropExtraction which = PREV }
				change_key = { lhs = Tax_CostPropForestry which = PREV }
				change_key = { lhs = Tax_CostPropFishery which = PREV }
				change_key = { lhs = Tax_CostPropIndustrial which = PREV }
				change_key = { lhs = Tax_CostPropAcademic which = PREV }
				change_key = { lhs = Tax_CostPropCommercial which = PREV }
				
				change_key = { lhs = Tax_CostTaxProperty which = PREV }
			}
		}
	}
}

Tax_TakeMana = {
	set_key = { lhs = Scaling_ADM_a which = Tax_CostAdm }
	Scaling_ADM_a = yes

	set_key = { lhs = Scaling_DIP_a which = Tax_CostDip }
	Scaling_DIP_a = yes

	set_key = { lhs = Scaling_MIL_a which = Tax_CostMil }
	Scaling_MIL_a = yes

	set_key = { lhs = Scaling_ADM_a value = 0 }
	set_key = { lhs = Scaling_DIP_a value = 0 }
	set_key = { lhs = Scaling_MIL_a value = 0 }
}